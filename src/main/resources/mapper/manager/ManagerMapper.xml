<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.temp.manager.mapper.ManagerMapper">
	<select id="selectTransCodeByNNO" parameterType="String" resultType="String">
		SELECT TRANS_CODE FROM TB_ORDER_LIST WHERE NNO = #{nno}
	</select>
	
	<select id="getTest" resultType="com.example.temp.manager.vo.ManagerVO">
		SELECT * FROM TB_USER_TEST
	</select>
	
	<select id="getSelectInfo" resultType="com.example.temp.manager.vo.ManagerVO" parameterType="String">
		SELECT * FROM TB_CUSTOMER 
		<where>
			<if test='_parameter != null and _parameter != ""'>
				USER_ID LIKE '%'+#{value}+'%'
			</if>
		</where>
	</select>
	
	<select id="getSelectUserInfo" resultType="com.example.temp.manager.vo.ManagerVO" parameterType="String">
		SELECT * FROM TB_CUSTOMER 
		<where>
			<if test='_parameter != null and _parameter != ""'>
				USER_ID = #{value}
			</if>
		</where>
	</select>
	
	<select id="getSelectUserList" resultType="com.example.temp.manager.vo.ManagerVO" parameterType="hashMap">
		
		SELECT * FROM (
			SELECT ROW_NUMBER() OVER(ORDER BY USER_ID DESC) AS ROWNUM, A.* 
			FROM (
				SELECT * FROM TB_CUSTOMER
				WHERE
			 		USER_ID IN (SELECT USER_ID FROM TB_USER_TRANS_COM WHERE ORG_NATION = 
			 					(SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = #{orgStation}))
			 	<if test="userId != null and userId != ''">
					AND USER_ID LIKE '%'+#{userId}+'%'
				</if>
				<if test='chk != null and chk != "" and chk == "Y"'>
					AND ISNULL(APRV_YN,'N') = 'N'
				</if>
			) A 
		) B
		WHERE
			B.ROWNUM BETWEEN #{paging.boardStart} and #{paging.boardEnd}
		<!-- 
		SELECT * FROM (
		SELECT ROW_NUMBER() OVER(ORDER BY USER_ID DESC) AS ROWNUM, A.* FROM (
		SELECT * FROM TB_CUSTOMER
		<where>
		 USER_ID IN (SELECT USER_ID FROM TB_USER_TRANS_COM WHERE ORG_NATION = 
		 				(SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = #{orgStation})) and
			<if test='"N".equals(etprYn)'>
				ETPR_YN = 'N'
			</if>
			<if test='"Y".equals(etprYn)'>
				ETPR_YN = 'Y'
			</if>
			<if test='userId != null and userId != ""'>
				AND
				USER_ID LIKE '%'+#{userId}+'%'
			</if>
		</where>
		) A ) B
		<where>
			<if test='paging.boardStart !=null and paging.boardStart !="" and paging.boardEnd != null and paging.boardEnd !=""'>
				B.ROWNUM BETWEEN #{paging.boardStart} and #{paging.boardEnd}
			</if>
		</where> -->
	</select>
	
	
	<select id="getTotalCountInfo" resultType="Integer" parameterType="hashMap">
		SELECT COUNT(*) FROM TB_CUSTOMER
		WHERE
		 	USER_ID IN (SELECT USER_ID FROM TB_USER_TRANS_COM WHERE ORG_NATION = 
		 				(SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = #{orgStation}))
		 	<if test="userId != null and userId != ''">
				AND USER_ID LIKE '%'+#{userId}+'%'
			</if>
			<if test='chk != null and chk != "" and chk == "Y"'>
				AND ISNULL(APRV_YN,'N') = 'N'
			</if>
		<!-- SELECT COUNT(*) FROM TB_CUSTOMER 
		<where>
		 USER_ID IN (SELECT USER_ID FROM TB_USER_TRANS_COM WHERE ORG_NATION = 
		 				(SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = #{orgStation}))
			<if test='"N".equals(etprYn)'>
				and
				ETPR_YN = 'N'
			</if>
			<if test='"Y".equals(etprYn)'>
				and
				ETPR_YN = 'Y'
			</if>
			<if test='userId != null and userId != ""'>
				AND
				USER_ID LIKE '%'+#{userId}+'%'
			</if>
			<if test='type == "deposit"'>
				AND
				DEPOSIT_YN = 'Y'
			</if>
		</where> -->
	</select>
	
	<insert id="insertMemberInfos" parameterType="com.example.temp.manager.vo.ManagerVO">
	INSERT INTO
    TB_CUSTOMER (
    <![CDATA[
        [USER_ID],
        USER_PW,
        [USER_NAME],
        USER_TEL,
        USER_HP,
        USER_ADDR,
        USER_ADDR_DETAIL,
        USER_EMAIL,
        USER_ZIP,
        [ROLE],
        ETPR_YN,
        APRV_YN,
        DEPOSIT_YN,
        INSP_PRICE,
        USER_GRADE,
        INSP_YN,
        TAKE_YN,
        W_USER_ID,
        W_USER_IP,
        W_DATE,
        USER_E_ADDR,
        USER_E_ADDR_DETAIL,
        COM_NAME,
        COM_E_NAME,
        STOCK_WEIGHT_YN,
        STORE_NAME,
        STORE_URL
    ]]>
    )
	VALUES(
	LOWER(#{userId}),
	#{userPw},
	#{userName},
	#{userTel},
	#{userHp},
	#{userAddr},
	#{userAddrDetail},
	#{userEmail},
	#{userZip},
	#{role},
	#{etprYn},
	#{aprvYn},
	#{depositYn},
	#{inspPrice},
	#{userGrade},
	#{inspYn},
	#{takeYn},
	#{wUserId},
	#{wUserIp},
	#{wDate},
	#{userEAddr},
	#{userEAddrDetail},
	#{comName},
	#{comEName},
	#{stockWeightYn},
	#{storeName},
	#{storeUrl}
	);
	</insert>
	
	<update id="resetUserPw" parameterType="com.example.temp.manager.vo.ManagerVO">
		UPDATE TB_CUSTOMER SET USER_PW = #{userPw} WHERE USER_ID = #{userId}
	</update>
	
	<delete id="deleteUserInfo" parameterType="String">
		DELETE FROM TB_CUSTOMER WHERE USER_ID = #{value};
		DELETE FROM TB_CUSTOMER_INV_INFO WHERE INV_USER_ID = #{value};
		DELETE FROM TB_USER_TRANS_COM WHERE USER_ID = #{value};
	</delete>
	
	<update id="updateUserInfo" parameterType="com.example.temp.manager.vo.ManagerVO">
		UPDATE TB_CUSTOMER SET
		W_USER_ID = #{wUserId},
		W_USER_IP = #{wUserIp},
		W_DATE = #{wDate}
		<if test='userName != null and userName != ""'>
		,USER_NAME = #{userName}
		</if>
		<if test='userTel != null and userTel != ""'>
		,USER_TEL = #{userTel}
		</if>
		<if test='userHp != null and userHp != ""'>
		,USER_HP = #{userHp}
		</if>
		<if test='userAddr != null and userAddr != ""'>
		,USER_ADDR = #{userAddr}
		</if>
		<if test='userAddrDetail != null and userAddrDetail != ""'>
		,USER_ADDR_DETAIL = #{userAddrDetail}
		</if>
		<if test='etprYn != null and etprYn != ""'>
		,ETPR_YN = #{etprYn}
		</if>
		<if test='userEmail != null and userEmail != ""'>
		,USER_EMAIL = #{userEmail}
		</if>
		<if test='aprvYn != null and aprvYn != ""'>
		,APRV_YN = #{aprvYn}
		</if>
		<if test='depositYn != null and depositYn != ""'>
		,DEPOSIT_YN = #{depositYn}
		</if>
		<if test='inspPrice != null and inspPrice != ""'>
		,INSP_PRICE = #{inspPrice}
		</if>
		<if test='userGrade != null and userGrade != ""'>
		,USER_GRADE = #{userGrade}
		</if>
		<if test='inspYn != null and inspYn != ""'>
		,INSP_YN = #{inspYn}
		</if>		
		<if test='takeYn != null and takeYn != ""'>
		,TAKE_YN = #{takeYn}
		</if>
		<if test='wtErrRange != null and wtErrRange != ""'>
		,WT_ERR_RANGE = #{wtErrRange}
		</if>	
		<if test='userZip != null and userZip != ""'>
		,USER_ZIP= #{userZip}
		</if>	
		<if test='userEAddr != null and userEAddr != ""'>
		,USER_E_ADDR = #{userEAddr}
		</if>
		<if test='userEAddrDetail != null and userEAddrDetail != ""'>
		,USER_E_ADDR_DETAIL = #{userEAddrDetail}
		</if>
		<if test='comName != null and comName != ""'>
		,COM_NAME = #{comName}
		</if>	
		<if test='comEName != null and comEName != ""'>
		,COM_E_NAME = #{comEName}
		</if>
		<if test='stockWeightYn != null and stockWeightYn != ""'>
		,STOCK_WEIGHT_YN = #{stockWeightYn}
		</if>
		<if test='storeName != null and storeName != ""'>
		,STORE_NAME = #{storeName}
		</if>		
		<if test='storeUrl != null and storeUrl != ""'>
		,STORE_URL = #{storeUrl}
		</if>
		<if test='depositPrice != null and depositPrice != ""'>
		,DEPOSIT_PRICE = #{depositPrice}
		</if>				
		<if test='returnYn != null and returnYn != ""'>
		,RETURN_YN = #{returnYn}
		</if>
		<if test='userEState != null and userEState != ""'>
		,USER_E_STATE = #{userEState}
		</if>
		<if test='userECity != null and userECity != ""'>
		,USER_E_CITY = #{userECity}
		</if>
		WHERE
       		USER_ID = #{userId}
	</update>
	
	<insert id="insertDepositPrice" parameterType="com.example.temp.manager.vo.ManagerVO">
		INSERT INTO TB_DEPOSIT_HIS (
			[USER_ID], [COST], [CALCULATION], [CODE], [W_DATE], [W_USER_ID], [W_USER_IP]
		) VALUES (
			#{userId}, #{depositPrice}, #{calculation}, #{code}, #{wDate}, #{wUserId}, #{wUserIp}
		)
			
	</insert>
	
	<select id="selectOrderInspcList" resultType="com.example.temp.manager.vo.OrderInspListVO" parameterType="hashmap" >
		SELECT A.* FROM (
			SELECT F1.order_no,
				 F1.user_id,
	      		 <!-- ISNULL((SELECT TOP 1 HAWB_NO FROM TB_HAWB WHERE NNO IN (
				 SELECT OUT_NNO FROM TB_STOCK WHERE NNO = F1.NNO) ORDER BY W_DATE DESC),F1.HAWB_NO) AS HAWB_NO, -->
				 ISNULL(F1.HAWB_NO,'') AS HAWB_NO,
				 ISNULL(F1.nno,'') AS NNO,
	     		 ISNULL(F1.cnee_Name,'') AS CNEE_NAME,
	             ISNULL(F1.cnee_Hp,'') AS CNEE_HP,
	             ISNULL(F1.cnee_TEL,'') AS CNEE_TEL,
	             ISNULL(F1.cnee_Addr,'') AS CNEE_ADDR,
	             ISNULL(F1.cnee_Addr_Detail,'') AS CNEE_ADDR_DETAIL,
	             ISNULL(F1.order_Date,'') AS ORDER_DATE,
	             ISNULL(F1.cnee_Zip,'') AS CNEE_ZIP,
	             ISNULL((SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE =F1.ORG_STATION),'') AS ORG_STATION_NAME,
	             ISNULL((SELECT NATION_NAME FROM TB_NATION_CODE WHERE NATION_CODE = F1.DSTN_NATION),'') AS DSTN_NATION_NAME,
				ISNULL(STUFF((SELECT '|'+ITEM_DETAIL FROM TB_ORDER_ITEM WHERE NNO = F1.NNO FOR XML PATH('')), 1, 1, ''),'') AS ITEM_DETAIL,
				ISNULL(STUFF((SELECT '|'+CONVERT(NVARCHAR(50),UNIT_VALUE) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO FOR XML PATH('')), 1, 1, ''),'') AS UNIT_VALUE, 
				ISNULL(STUFF((SELECT '|'+TRK_NO FROM TB_ORDER_ITEM WHERE NNO = F1.NNO FOR XML PATH('')), 1, 1, ''),'') AS TRK_NO, 
				ISNULL(STUFF((SELECT '|'+CONVERT(NVARCHAR(10),ITEM_CNT) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO FOR XML PATH('')), 1, 1, ''),'') AS ITEM_CNT,
				ISNULL(STUFF((SELECT '|'+ITEM_IMG_URL FROM TB_ORDER_ITEM WHERE NNO = F1.NNO FOR XML PATH('')), 1, 1, ''),'') AS ITEM_IMG_URL, 
				ROW_NUMBER() OVER (ORDER BY F1.W_DATE DESC) AS ROWNUM
			FROM TB_ORDER_LIST F1
			WHERE F1.ORDER_TYPE = 'INSP' 
					AND F1.ORG_STATION = #{orgStation}
					AND ((SELECT COUNT(*) FROM TB_STOCK WHERE NNO = F1.NNO) != (SELECT SUM(ITEM_CNT) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO))
				<if test='searchType != null and searchType != "" and searchType == "0"'>
					AND  (CNEE_NAME LIKE '%'+#{searchKeywords}+'%' 
						OR NNO IN (SELECT NNO FROM TB_ORDER_ITEM WHERE ITEM_DETAIL LIKE '%'+#{searchKeywords}+'%')
						OR NNO IN (SELECT NNO FROM TB_ORDER_ITEM WHERE TRK_NO LIKE '%'+#{searchKeywords}+'%')
						OR HAWB_NO LIKE '%'+#{searchKeywords}+'%' 
						OR ORDER_NO LIKE '%'+#{searchKeywords}+'%' 
						OR USER_ID LIKE '%'+#{searchKeywords}+'%')
				</if>
				<if test='searchType != null and searchType != "" and searchType == "1"'>
					AND CNEE_NAME LIKE '%'+#{searchKeywords}+'%'
				</if>
				<if test='searchType != null and searchType != "" and searchType == "2"'>
					AND NNO IN (SELECT NNO FROM TB_ORDER_ITEM WHERE ITEM_DETAIL LIKE '%'+#{searchKeywords}+'%')
				</if>
				<if test='searchType != null and searchType != "" and searchType == "3"'>
				 	AND NNO IN (SELECT NNO FROM TB_ORDER_ITEM WHERE TRK_NO LIKE '%'+#{searchKeywords}+'%')
				</if>
				<if test='searchType != null and searchType != "" and searchType == "4"'>
					AND HAWB_NO LIKE '%'+#{searchKeywords}+'%' 
				</if>
				<if test='searchType != null and searchType != "" and searchType == "5"'>
					AND ORDER_NO LIKE '%'+#{searchKeywords}+'%' 
				</if>
				<if test='searchType != null and searchType != "" and searchType == "6"'>
					AND USER_ID LIKE '%'+#{searchKeywords}+'%'
				</if>
			) A
	</select>
	<select id="selectOrderInspc" resultType="com.example.temp.manager.vo.OrderInspListOneVO" parameterType="hashmap" >
	SELECT ISNULL((SELECT TOP 1 NNO FROM TB_STOCK WHERE OUT_NNO = F1.NNO),F1.NNO) AS NNO, ORG_STATION, DSTN_NATION, DSTN_STATION, [USER_ID],
		ORDER_TYPE, ORDER_NO, ORDER_DATE, HAWB_NO, BOX_CNT, USER_WTA, USER_WTC,
		SHIPPER_NAME, SHIPPER_ZIP, SHIPPER_TEL, SHIPPER_HP, SHIPPER_CNTRY,
		SHIPPER_CITY, SHIPPER_STATE, SHIPPER_ADDR, SHIPPER_ADDR_DETAIL,
		CNEE_NAME, CNEE_ADDR, CNEE_ZIP, CNEE_TEL, CNEE_HP, CNEE_CNTRY,
		CNEE_CITY, CNEE_STATE, CNEE_DISTRICT, CNEE_ADDR_DETAIL, USER_LENGTH, USER_WIDTH,
		USER_HEIGHT, USER_EMAIL, TRANS_CODE, CNEE_EMAIL, CUSTOMS_NO,
		WH_REQ_MSG,NATIVE_CNEE_NAME, NATIVE_CNEE_ADDR, NATIVE_CNEE_ADDR_DETAIL, DIM_UNIT,
		WT_UNIT, BUY_SITE, W_USER_ID, W_USER_IP, W_DATE
	FROM TB_ORDER_LIST F1
	WHERE F1.ORDER_TYPE = 'INSP' 
			AND F1.ORG_STATION = #{orgStation}
			AND ((SELECT COUNT(*) FROM TB_STOCK WHERE NNO = F1.NNO) != (SELECT SUM(ITEM_CNT) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO))
		<if test='searchType != null and searchType != "" and searchType == "0"'>
			AND  (CNEE_NAME LIKE '%'+#{searchKeywords}+'%' 
				OR NNO IN (SELECT NNO FROM TB_ORDER_ITEM WHERE ITEM_DETAIL LIKE '%'+#{searchKeywords}+'%')
				OR NNO IN (SELECT NNO FROM TB_ORDER_ITEM WHERE TRK_NO LIKE '%'+#{searchKeywords}+'%')
				OR HAWB_NO LIKE '%'+#{searchKeywords}+'%' 
				OR ORDER_NO LIKE '%'+#{searchKeywords}+'%' 
				OR USER_ID LIKE '%'+#{searchKeywords}+'%')
		</if>
		<if test='searchType != null and searchType != "" and searchType == "1"'>
			AND CNEE_NAME LIKE '%'+#{searchKeywords}+'%'
		</if>
		<if test='searchType != null and searchType != "" and searchType == "2"'>
			AND NNO IN (SELECT NNO FROM TB_ORDER_ITEM WHERE ITEM_DETAIL LIKE '%'+#{searchKeywords}+'%')
		</if>
		<if test='searchType != null and searchType != "" and searchType == "3"'>
		 	AND NNO IN (SELECT NNO FROM TB_ORDER_ITEM WHERE TRK_NO LIKE '%'+#{searchKeywords}+'%')
		</if>
		<if test='searchType != null and searchType != "" and searchType == "4"'>
			AND HAWB_NO LIKE '%'+#{searchKeywords}+'%' 
		</if>
		<if test='searchType != null and searchType != "" and searchType == "5"'>
			AND ORDER_NO LIKE '%'+#{searchKeywords}+'%' 
		</if>
		<if test='searchType != null and searchType != "" and searchType == "6"'>
			AND USER_ID LIKE '%'+#{searchKeywords}+'%'
		</if>
	</select>
	
	<select id="selectOrderInspcItem" resultType="com.example.temp.manager.vo.OrderInspVO" parameterType="String">
		SELECT F1.*,
		(SELECT COUNT(STOCK_NO) FROM TB_STOCK WHERE STOCK_TYEP = 'INSP_ADD_IN' AND STOCK_NO = 
			F1.CUS_ITEM_CODE
		) AS STOCK_YN 
		FROM TB_ORDER_ITEM F1
		<where>
			1=1
			<if test='value != null and value != ""'>
				AND NNO = #{value}
			</if>
		</where>
		ORDER BY SUB_NO ASC
	</select>
	
	<select id="selectOrderInspcCnt" resultType="Integer" parameterType="hashmap">
		SELECT	COUNT(*)
		FROM TB_ORDER_LIST F1
		WHERE F1.ORDER_TYPE = 'INSP' 
			AND F1.ORG_STATION = #{orgStation}
			AND ((SELECT COUNT(*) FROM TB_STOCK WHERE NNO = F1.NNO) != (SELECT SUM(ITEM_CNT) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO))
		<if test='searchType != null and searchType != "" and searchType == "0"'>
			AND  (CNEE_NAME LIKE '%'+#{searchKeywords}+'%' 
				OR NNO IN (SELECT NNO FROM TB_ORDER_ITEM WHERE ITEM_DETAIL LIKE '%'+#{searchKeywords}+'%')
				OR NNO IN (SELECT NNO FROM TB_ORDER_ITEM WHERE TRK_NO LIKE '%'+#{searchKeywords}+'%')
				OR HAWB_NO LIKE '%'+#{searchKeywords}+'%' 
				OR ORDER_NO LIKE '%'+#{searchKeywords}+'%' 
				OR USER_ID LIKE '%'+#{searchKeywords}+'%')
		</if>
		<if test='searchType != null and searchType != "" and searchType == "1"'>
			AND CNEE_NAME LIKE '%'+#{searchKeywords}+'%'
		</if>
		<if test='searchType != null and searchType != "" and searchType == "2"'>
			AND NNO IN (SELECT NNO FROM TB_ORDER_ITEM WHERE ITEM_DETAIL LIKE '%'+#{searchKeywords}+'%')
		</if>
		<if test='searchType != null and searchType != "" and searchType == "3"'>
		 	AND NNO IN (SELECT NNO FROM TB_ORDER_ITEM WHERE TRK_NO LIKE '%'+#{searchKeywords}+'%')
		</if>
		<if test='searchType != null and searchType != "" and searchType == "4"'>
			AND HAWB_NO LIKE '%'+#{searchKeywords}+'%' 
		</if>
		<if test='searchType != null and searchType != "" and searchType == "5"'>
			AND ORDER_NO LIKE '%'+#{searchKeywords}+'%' 
		</if>
		<if test='searchType != null and searchType != "" and searchType == "6"'>
			AND USER_ID LIKE '%'+#{searchKeywords}+'%'
		</if>
	</select>
	
	<select id="selectMawbList" parameterType="String" resultType="com.example.temp.manager.vo.MawbVO" >
		SELECT 
			MAWB_NO,
			MAWB_NO AS LEGACY_MAWB_NO,
			ISNULL(DSTN_STATION,'') AS DSTN_STATION,
			ISNULL(ORG_STATION,'') AS ORG_STATION,
			DEP_DATE,
			DEP_TIME,
			ARR_DATE,
			ARR_TIME,
			FLT_NO,
			ISNULL(TRANS_CODE,'') AS TRANS_CODE,
						ISNULL((SELECT STUFF((SELECT ',' + VALUE
                FROM (SELECT VALUE FROM FN_REPLACE_TRANSNAME(TTM.TRANS_CODE,',')) AS A
                 FOR XML PATH('')
		   ), 1, 1, '')),'') AS TRANS_NAME,
			(SELECT COUNT(TTH.MAWB_NO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND ORG_STATION = #{orgStation}) AS HAWB_CNT
		FROM TB_MAWB TTM WHERE DEP_DATE > =  Convert(varchar(10),Getdate()-1,112)
				AND ISNULL(ORG_STATION ,'') = #{orgStation}
		ORDER BY DEP_DATE DESC;
	</select>
	
	<select id="selectMawbList2" resultType="com.example.temp.manager.vo.MawbVO" parameterType="com.example.temp.manager.vo.MawbVO">
		SELECT 
			MAWB_NO,
			MAWB_NO AS LEGACY_MAWB_NO,
			ISNULL(DSTN_STATION,'') AS DSTN_STATION,
			ISNULL(ORG_STATION,'') AS ORG_STATION,
			DEP_DATE,
			DEP_TIME,
			ARR_DATE,
			ARR_TIME,
			FLT_NO,
			ISNULL((SELECT CONVERT(DECIMAL(38,2),ROUND(SUM(TTH.WTA),2)) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND ORG_STATION = #{orgStation}),'0') AS TOTAL_WTA,
			ISNULL((SELECT CONVERT(DECIMAL(38,2),ROUND(SUM(TTH.WTC),2)) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND ORG_STATION = #{orgStation}),'0') AS TOTAL_WTC,
			ISNULL(TRANS_CODE,'') AS TRANS_CODE,
			ISNULL((SELECT STUFF((SELECT ',' + VALUE
                FROM (SELECT VALUE FROM FN_REPLACE_TRANSNAME(TTM.TRANS_CODE,',')) AS A
                 FOR XML PATH('')
		   ), 1, 1, '')),'') AS TRANS_NAME,
			(SELECT COUNT(TTH.MAWB_NO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND ORG_STATION = #{orgStation}) AS HAWB_CNT
		FROM TB_MAWB TTM
		where 1=1 
		AND ISNULL(ORG_STATION ,'') = #{orgStation}
		<if test='mawbNo != null and mawbNo != ""'>
			AND TTM.MAWB_NO LIKE '%'+#{mawbNo}+'%'
		</if>
		<if test='fltNo != null and fltNo != ""'>
			AND TTM.FLT_NO LIKE '%'+#{fltNo}+'%'
		</if>
		<if test='(depDate != null and depDate != "") and (arrDate != null and arrDate != "")'>
		 <![CDATA[
			AND TTM.DEP_DATE >= #{depDate} and TTM.ARR_DATE <= #{arrDate}
		]]> 
		</if>
		ORDER BY DEP_DATE DESC
	</select>
	
	<select id="selectMawbList3" resultType="com.example.temp.manager.vo.MawbVO" parameterType="com.example.temp.manager.vo.MawbVO">
		SELECT 
			MAWB_NO,
			MAWB_NO AS LEGACY_MAWB_NO,
			ISNULL(DSTN_STATION,'') AS DSTN_STATION,
			ISNULL(ORG_STATION,'') AS ORG_STATION,
			DEP_DATE,
			DEP_TIME,
			ARR_DATE,
			ARR_TIME,
			FLT_NO,
			ISNULL(TRANS_CODE,'') AS TRANS_CODE,
			ISNULL((SELECT STUFF((SELECT ',' + VALUE
                FROM (SELECT VALUE FROM FN_REPLACE_TRANSNAME(TTM.TRANS_CODE,',')) AS A
                 FOR XML PATH('')
		   ), 1, 1, '')),'') AS TRANS_NAME,
			(SELECT COUNT(TTH.MAWB_NO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO) AS HAWB_CNT
		FROM TB_MAWB TTM
		where 1=1 
		AND ISNULL(DSTN_STATION ,'') = (SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE =#{orgStation})
		<if test='mawbNo != null and mawbNo != ""'>
			AND TTM.MAWB_NO LIKE '%'+#{mawbNo}+'%'
		</if>
		<if test='fltNo != null and fltNo != ""'>
			AND TTM.FLT_NO LIKE '%'+#{fltNo}+'%'
		</if>
		<if test='(depDate != null and depDate != "") and (arrDate != null and arrDate != "")'>
		 <![CDATA[
			AND TTM.DEP_DATE > #{depDate} and TTM.ARR_DATE < #{arrDate}
		]]> 
		</if>
		ORDER BY DEP_DATE DESC
	</select>
	
	<select id="selectLicenceList" resultType="com.example.temp.manager.vo.ExpLicenceListVO" parameterType="com.example.temp.manager.vo.ExpLicenceListVO">
		SELECT 
			MAWB_NO,
			MAWB_NO AS LEGACY_MAWB_NO,
			ISNULL(DSTN_STATION,'') AS DSTN_STATION,
			ISNULL(ORG_STATION,'') AS ORG_STATION,
			DEP_DATE,
			DEP_TIME,
			ARR_DATE,
			ARR_TIME,
			FLT_NO,
			ISNULL(TRANS_CODE,'') AS TRANS_CODE,
			ISNULL((SELECT STUFF((SELECT ',' + VALUE
                FROM (SELECT VALUE FROM FN_REPLACE_TRANSNAME(TTM.TRANS_CODE,',')) AS A
                 FOR XML PATH('')
		    ), 1, 1, '')),'') AS TRANS_NAME,
			(SELECT COUNT(TTH.MAWB_NO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND ORG_STATION = #{orgStation}) AS HAWB_CNT,
			CONVERT(NVARCHAR(10),(SELECT COUNT(TTH.NNO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND NNO IN (SELECT NNO FROM TB_EXP_DCL WHERE SEND_YN = 'S')))+ ' / '+CONVERT(NVARCHAR(10),(SELECT COUNT(TTH.NNO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND NNO IN (SELECT NNO FROM TB_EXP_DCL))) AS LICENCE_HAWB_CNT,
			<!-- (SELECT COUNT(TTH.NNO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND NNO IN (SELECT NNO FROM TB_EXPLICENCE WHERE EXP_VALUE = 'registExplicence1')) AS LICENCE_CNT,
			CONVERT(NVARCHAR(10),(SELECT COUNT(TTH.NNO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND NNO IN (SELECT NNO FROM TB_EXPLICENCE WHERE EXP_VALUE = 'registExplicence1' AND SEND_YN = 'Y')))+ ' / '+CONVERT(NVARCHAR(10),(SELECT COUNT(TTH.NNO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND NNO IN (SELECT NNO FROM TB_EXPLICENCE WHERE EXP_VALUE = 'registExplicence1'))) AS LICENCE_HAWB_CNT,
			CASE WHEN 
			(SELECT COUNT(TTH.NNO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND NNO IN (SELECT NNO FROM TB_EXPLICENCE WHERE EXP_VALUE = 'registExplicence1')) =
			(SELECT COUNT(TTH.NNO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND NNO IN (SELECT NNO FROM TB_EXPLICENCE WHERE EXP_VALUE = 'registExplicence1' AND SEND_YN = 'Y'))  
			THEN '0' ELSE '1' END AS SEND_YN -->
			CASE 
				WHEN 
				(SELECT COUNT(TTH.NNO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND NNO IN (SELECT NNO FROM TB_EXP_DCL)) =
				(SELECT COUNT(TTH.NNO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND NNO IN (SELECT NNO FROM TB_EXP_DCL WHERE SEND_YN = 'S'))  
				THEN '0' 
				ELSE '1' 
			END AS SEND_YN
		FROM TB_MAWB TTM
		where 1=1 
		AND ISNULL(ORG_STATION ,'') = #{orgStation}
		<if test='mawbNo != null and mawbNo != ""'>
			AND TTM.MAWB_NO LIKE '%'+#{mawbNo}+'%'
		</if>
		<if test='fltNo != null and fltNo != ""'>
			AND TTM.FLT_NO LIKE '%'+#{fltNo}+'%'
		</if>
		<if test='(depDate != null and depDate != "") and (arrDate != null and arrDate != "")'>
		 <![CDATA[
			AND TTM.DEP_DATE > #{depDate} and TTM.ARR_DATE < #{arrDate}
		]]> 
		</if>
		AND (SELECT COUNT(TTH.NNO) FROM TB_HAWB TTH WHERE TTH.MAWB_NO =TTM.MAWB_NO AND NNO IN (SELECT NNO FROM TB_EXP_DCL)) != 0
		ORDER BY DEP_DATE DESC
	</select>
	
	<select id="insertMawb" parameterType="com.example.temp.manager.vo.MawbVO" resultType="com.example.temp.manager.vo.ProcedureVO" statementType="CALLABLE">
		 DECLARE
			 @MAWB_NO NVARCHAR(50),
			 @ORG_STATION NVARCHAR(3),
			 @DSTN_STATION NVARCHAR(3),
			 @DEP_DATE NVARCHAR(8),
			 @DEP_TIME NVARCHAR(4),
			 @ARR_DATE NVARCHAR(8),
			 @ARR_TIME NVARCHAR(4) ,
			 @FLT_NO NVARCHAR(50),
			 @TRANS_NAME NVARCHAR(50),
			 @W_USER_ID NVARCHAR(50),
			 @W_USER_IP NVARCHAR(50),
			 @RST_STATUS NVARCHAR(10),
			 @RST_CODE NVARCHAR(10) ,
			 @RST_MSG NVARCHAR(100) ,
			 @RST_MAWB_NO NVARCHAR(50)
			 
			 SET @MAWB_NO  =  #{mawbNo}
			 SET @ORG_STATION = #{orgStation}
			 SET @DSTN_STATION = #{dstnStation}
			 SET @DEP_DATE  = #{depDate}
			 SET @DEP_TIME = #{depTime}
			 SET @ARR_DATE = #{arrDate}
			 SET @ARR_TIME = #{arrTime}
			 SET @FLT_NO = #{fltNo}
			 SET @TRANS_NAME = #{transCode}
			 SET @W_USER_ID = #{wUserId}
			 SET @W_USER_IP = #{wUserIp}     
			 
			 
		 EXEC SP_MAWB_MERGER
			 @MAWB_NO ,
			 @ORG_STATION ,
			 @DSTN_STATION,
			 @DEP_DATE,
			 @DEP_TIME,
			 @ARR_DATE,
			 @ARR_TIME,
			 @FLT_NO,
			 @TRANS_NAME,
			 @W_USER_ID,
			 @W_USER_IP,
			 @RST_STATUS OUTPUT,
			 @RST_CODE OUTPUT,
			 @RST_MSG  OUTPUT,
			 @RST_MAWB_NO OUTPUT
			 
			 
		 SELECT
			 @RST_STATUS AS RST_STATUS,
			 @RST_CODE AS RST_CODE,
			 @RST_MSG  AS RST_MSG,
			 @RST_MAWB_NO AS RST_MAWB_NO ;
	</select>
	
	<select id="existMawb" resultType="Integer" parameterType="String">
		SELECT 
			COUNT(MAWB_NO)
		FROM TB_MAWB WHERE MAWB_NO = #{mawbNo}
	</select>
	
	<update id="updateMawb" parameterType="com.example.temp.manager.vo.MawbVO">
		DECLARE
			 @MAWB_NO NVARCHAR(50),
			 @ORG_STATION NVARCHAR(3),
			 @DSTN_STATION NVARCHAR(3),
			 @DEP_DATE NVARCHAR(8),
			 @DEP_TIME NVARCHAR(4),
			 @ARR_DATE NVARCHAR(8),
			 @ARR_TIME NVARCHAR(4) ,
			 @FLT_NO NVARCHAR(50),
			 @TRANS_NAME NVARCHAR(50),
			 @W_USER_ID NVARCHAR(50),
			 @W_USER_IP NVARCHAR(50),
			 @RST_STATUS NVARCHAR(10),
			 @RST_CODE NVARCHAR(10) ,
			 @RST_MSG NVARCHAR(100) ,
			 @RST_MAWB_NO NVARCHAR(50)
			 
			 SET @MAWB_NO  =  #{mawbNo}
			 SET @ORG_STATION = #{orgStation}
			 SET @DSTN_STATION = #{dstnStation}
			 SET @DEP_DATE  = #{depDate}
			 SET @DEP_TIME = #{depTime}
			 SET @ARR_DATE = #{arrDate}
			 SET @ARR_TIME = #{arrTime}
			 SET @FLT_NO = #{fltNo}
			 SET @TRANS_NAME = #{transCode}
			 SET @W_USER_ID = #{wUserId}
			 SET @W_USER_IP = #{wUserIp}     
			 
			 
		 EXEC SP_MAWB_MERGER
			 @MAWB_NO ,
			 @ORG_STATION ,
			 @DSTN_STATION,
			 @DEP_DATE,
			 @DEP_TIME,
			 @ARR_DATE,
			 @ARR_TIME,
			 @FLT_NO,
			 @TRANS_NAME,
			 @W_USER_ID,
			 @W_USER_IP,
			 @RST_STATUS OUTPUT,
			 @RST_CODE OUTPUT,
			 @RST_MSG  OUTPUT,
			 @RST_MAWB_NO OUTPUT
			 
			 
		 SELECT
			 @RST_STATUS AS RST_STATUS,
			 @RST_CODE AS RST_CODE,
			 @RST_MSG  AS RST_MSG,
			 @RST_MAWB_NO AS RST_MAWB_NO ;
	</update>
	
	<insert id="insertHawbItem" parameterType="com.example.temp.manager.vo.OrderInspVO">
		INSERT INTO
			TB_HAWB_ITEM (
		        DSTN_STATION,
		        [USER_ID],
		        HAWB_NO,
		        ITEM_CNT,
		        NNO,
		        SUB_NO,
		        ORG_STATION
		    )
		VALUES
		    (
			    #{dstnStation},
			    #{userId},
			    (SELECT HAWB_NO FROM TB_ORDER_LIST WHERE NNO = #{nno}),
		        #{itemCnt},
		        #{nno},
		        #{subno},
		        #{orgStation}
		    )
	</insert>
	
	<select id="selectBagNoList" resultType="hashMap" parameterType="String">
		SELECT ISNULL(BAG_NO,'') AS BAG_NO
		FROM TB_HAWB
		WHERE MAWB_NO = #{mawbNo}
		GROUP BY BAG_NO
	</select>
	
	<select id ="selectHawbList" resultType="com.example.temp.manager.vo.HawbVO" parameterType="String">
		select 
			ISNULL(F1.nno,'') AS NNO,
			ISNULL(F1.ORG_STATION,'') AS ORG_STATION,
			ISNULL(F1.DSTN_NATION,'') AS DSTN_NATION,
			ISNULL(F1.DSTN_STATION,'') AS DSTN_STATION,
			ISNULL(F1.USER_ID,'') AS USER_ID,
			ISNULL(F1.ORDER_NO,'') AS ORDER_NO,
			ISNULL(F1.TRANS_CODE,'') AS TRANS_CODE,
			ISNULL(F1.BAG_NO, '') AS BAG_NO,
			ISNULL(F1.HAWB_NO,'') AS HAWB_NO,
			ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE NNO = F1.NNO AND KEY_HAWB_NO = F1.HAWB_NO),'') AS AGENCY_BL,
			ISNULL(F1.MAWB_NO,'') AS MAWB_NO,
			ISNULL(F1.WTA,'') AS WTA,
			ISNULL(F1.WTC,'') AS WTC,
			ISNULL(F1.BOX_CNT,'') AS BOX_CNT,
			ISNULL(F1.WT_UNIT,'') AS WT_UNIT,
			ISNULL(F1.W_USER_ID,'') AS W_USER_ID,
			ISNULL(F1.W_USER_IP,'') AS W_USER_IP,
			ISNULL((SELECT CNEE_NAME FROM TB_ORDER_LIST WHERE NNO = F1.NNO),'') AS CNEE_NAME,
			ISNULL((SELECT COM_NAME FROM TB_CUSTOMER WHERE USER_ID = F1.[USER_ID]),'') AS COM_NAME,
			ISNULL((SELECT USER_NAME FROM TB_CUSTOMER WHERE USER_ID = F1.[USER_ID]),'') AS USER_NAME,
			(SELECT W_DATE FROM TB_CARRY_IN WHERE NNO = F1.NNO AND SEND_YN = 'Y')AS FTP_IN_DATE,
			ISNULL((SELECT STUFF((SELECT ',' + VALUE
                FROM (SELECT VALUE FROM FN_REPLACE_TRANSNAME(F1.TRANS_CODE,',')) AS A
                 FOR XML PATH('')
		   ), 1, 1, '')),'') AS TRANS_NAME,
  			ISNULL((SELECT CASE WHEN SEND_YN = 'Y' THEN '성공' WHEN SEND_YN = 'F' THEN CONCAT('실패 : ',RST_MSG) END FROM TB_FB_SEND WHERE NNO = F1.NNO AND HAWB_NO = F1.HAWB_NO),'미전송') AS FB_SEND_YN
		FROM TB_HAWB F1 WHERE 1=1 AND MAWB_NO = #{mawbNo}
	</select>
	
	<select id="selectHawbListByBagNo" resultType="hashMap" parameterType="hashMap">
		select 
			ISNULL(F1.nno,'') AS NNO,
			ISNULL(F1.ORG_STATION,'') AS ORG_STATION,
			ISNULL(F1.DSTN_NATION,'') AS DSTN_NATION,
			ISNULL(F1.DSTN_STATION,'') AS DSTN_STATION,
			ISNULL(F1.USER_ID,'') AS USER_ID,
			ISNULL(F1.ORDER_NO,'') AS ORDER_NO,
			ISNULL(F1.TRANS_CODE,'') AS TRANS_CODE,
			ISNULL(F1.BAG_NO, '') AS BAG_NO,
			ISNULL(F1.HAWB_NO,'') AS HAWB_NO,
			ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE NNO = F1.NNO AND KEY_HAWB_NO = F1.HAWB_NO),'') AS AGENCY_BL,
			ISNULL(F1.MAWB_NO,'') AS MAWB_NO,
			ISNULL(F1.WTA,'') AS WTA,
			ISNULL(F1.WTC,'') AS WTC,
			ISNULL(F1.BOX_CNT,'') AS BOX_CNT,
			ISNULL(F1.WT_UNIT,'') AS WT_UNIT,
			ISNULL(F1.W_USER_ID,'') AS W_USER_ID,
			ISNULL(F1.W_USER_IP,'') AS W_USER_IP,
			ISNULL((SELECT CNEE_NAME FROM TB_ORDER_LIST WHERE NNO = F1.NNO),'') AS CNEE_NAME,
			ISNULL((SELECT COM_NAME FROM TB_CUSTOMER WHERE USER_ID = F1.[USER_ID]),'') AS COM_NAME,
			ISNULL((SELECT USER_NAME FROM TB_CUSTOMER WHERE USER_ID = F1.[USER_ID]),'') AS USER_NAME,
			(SELECT W_DATE FROM TB_CARRY_IN WHERE NNO = F1.NNO AND SEND_YN = 'Y') AS FTP_IN_DATE,
			ISNULL((SELECT STUFF((SELECT ',' + VALUE
                FROM (SELECT VALUE FROM FN_REPLACE_TRANSNAME(F1.TRANS_CODE,',')) AS A
                 FOR XML PATH('')
		   ), 1, 1, '')),'') AS TRANS_NAME
		FROM TB_HAWB F1 WHERE 1=1 AND MAWB_NO = #{mawbNo} 
		<choose>
			<when test="bagNo != 'all'">
				AND BAG_NO = #{bagNo}
			</when>
			<otherwise>
				
			</otherwise>
		</choose>
	</select>

	<select id ="selectHawbListArr" resultType="com.example.temp.manager.vo.HawbVO" parameterType="String">
		select 
			ISNULL(F1.nno,'') AS NNO,
			ISNULL(F1.ORG_STATION,'') AS ORG_STATION,
			ISNULL(F1.DSTN_NATION,'') AS DSTN_NATION,
			ISNULL(F1.DSTN_STATION,'') AS DSTN_STATION,
			ISNULL(F1.USER_ID,'') AS USER_ID,
			ISNULL(F1.ORDER_NO,'') AS ORDER_NO,
			ISNULL(F1.TRANS_CODE,'') AS TRANS_CODE,
			ISNULL(F1.BAG_NO, '') AS BAG_NO,
			ISNULL(F1.HAWB_NO,'') AS HAWB_NO,
			ISNULL(F1.MAWB_NO,'') AS MAWB_NO,
			ISNULL(F1.WTA,'') AS WTA,
			ISNULL(F1.WTC,'') AS WTC,
			ISNULL(F1.BOX_CNT,'') AS BOX_CNT,
			ISNULL(F1.WT_UNIT,'') AS WT_UNIT,
			ISNULL(F1.W_USER_ID,'') AS W_USER_ID,
			ISNULL(F1.W_USER_IP,'') AS W_USER_IP,
			ISNULL((SELECT CNEE_NAME FROM TB_ORDER_LIST WHERE NNO = F1.NNO),'') AS CNEE_NAME,
			ISNULL((SELECT COM_NAME FROM TB_CUSTOMER WHERE USER_ID = F1.[USER_ID]),'') AS COM_NAME,
			ISNULL((SELECT USER_NAME FROM TB_CUSTOMER WHERE USER_ID = F1.[USER_ID]),'') AS USER_NAME,
			(SELECT W_DATE FROM TB_CARRY_IN WHERE NNO = F1.NNO AND SEND_YN = 'Y')AS FTP_IN_DATE,
			ISNULL((SELECT 'IN' FROM TB_MAWB_ARR F2 WHERE F2.NNO = F1.NNO),'') AS ARR_IN,
			ISNULL((SELECT STUFF((SELECT ',' + VALUE
                FROM (SELECT VALUE FROM FN_REPLACE_TRANSNAME(F1.TRANS_CODE,',')) AS A
                 FOR XML PATH('')
		   ), 1, 1, '')),'') AS TRANS_NAME
		FROM TB_HAWB F1 WHERE 1=1 AND MAWB_NO = #{mawbNo}
	</select>
	
	
	<delete id="deleteMawbOne" parameterType="String">
		DELETE FROM TB_MAWB WHERE 1=1 AND MAWB_NO = #{value}
	</delete>
	
	<select id="deleteHawb" parameterType="hashMap" resultType="com.example.temp.manager.vo.ProcedureVO" statementType="CALLABLE">
		DECLARE 
			@HAWB_NO NVARCHAR(50),
			@W_USER_ID NVARCHAR(50),
			@W_USER_IP NVARCHAR(50),
			@RST_STATUS NVARCHAR(50),
			@RST_CODE NVARCHAR(50),
			@RST_MSG NVARCHAR(100),
			@RST_HAWB_NO NVARCHAR(100) 
			
			SET @HAWB_NO = ''
			SET @W_USER_ID = ''
			SET @W_USER_IP = ''
			SET @RST_STATUS = ''
			SET @RST_CODE = ''
			SET @RST_MSG = ''
			SET @RST_HAWB_NO = ''
			
		EXEC SP_MAWB_CANCLE
			@HAWB_NO ,
			@W_USER_ID ,
			@W_USER_IP ,
			@RST_STATUS OUTPUT,
			@RST_CODE OUTPUT,
			@RST_MSG OUTPUT,
			@RST_HAWB_NO OUTPUT
			
		SELECT 
			@RST_STATUS AS RST_STATUS ,
			@RST_CODE AS RST_CODE,
			@RST_MSG AS RST_MSG,
			@RST_HAWB_NO AS RST_HAWB_NO;
	</select>
	
	<insert id="insertHawb" parameterType="com.example.temp.manager.vo.HawbVO">
		INSERT INTO
			TB_HAWB (
			        NNO,
			        ORDER_NO,
			        [USER_ID],
			        DSTN_STATION,
			        TRK_COM,
			        HAWB_NO,
			        BOX_CNT,
			        WTA,
			        WTC,
			        WT_UNIT,
			        ORG_STATION
				    )
				VALUES
	    (
	    	#{nno},
	        #{orderNo},
	        #{userId},
	        #{dstnStation},
	        #{trkCom},
	        #{hawbNo},
	        #{boxCnt},
	        #{wta},
	        #{wtc},
	        #{wtUnit},
	        #{orgStation}
	    );		


	</insert>
	
	<select id="hawbCount" resultType="String" parameterType="String">
		SELECT COUNT(MAWB_NO) FROM TB_HAWB WHERE MAWB_NO = #{mawbNo}
	</select>
	
	<update id="updateHawbMawb" parameterType="com.example.temp.manager.vo.MawbVO">
		UPDATE TB_HAWB SET
		MAWB_NO=#{mawbNo}
		WHERE MAWB_NO = #{legacyMawbNo}
	</update>
	
	<update id="updateHawbMawb2" parameterType="String">
		UPDATE TB_HAWB SET
		MAWB_NO=''
		WHERE HAWB_NO = #{hawbNo};
		
		delete FROM TB_HAWB_ITEM WHERE NNO = (SELECT NNO FROM TB_HAWB WHERE HAWB_NO = #{hawbNo});
		delete FROM TB_HAWB WHERE HAWB_NO = #{hawbNo}; 
	</update>
	
	<insert id="insertTestSS" parameterType="String">
		INSERT TEST_TOAST VALUES (#{value})
	
	</insert>
	
	<insert id="insertNotice" parameterType="com.example.temp.common.vo.NoticeVO">
		INSERT INTO TB_NOTICE (
			TITLE, 
			CONTENTS, 
			W_DATE, 
			W_USER_ID, 
			W_USER_IP,
			DSTN_STATION, 
			ORG_STATION
		)
		VALUES ( #{title}, #{contents}, #{wDate}, #{wUserId}, #{wUserIp}, 'LAX', 'SEL');
	
	</insert>
	
	<select id ="selectTestSS" resultType="com.example.temp.manager.vo.StockResultVO" statementType="CALLABLE">
		DECLARE
			@RST_STATUS NVARCHAR(50) ,
			@RST_CODE NVARCHAR(50) ,
			@RST_MSG NVARCHAR(100),
			@RST_NNO NVARCHAR(50),
			@RST_SUB_NO INT ,
			@RST_IDX NVARCHAR(50)
			
			EXEC SP_INSP_STOCK_IN_NEW '202006161430521535FGC',
			3,
			'TEST',
			'RACK_COM',
			'TRK_NO',
			'20200501',
			'WO',
			5,
			'TEST자료',
			'PIU89',
			'121.1.1.1',
			@RST_STATUS  OUTPUT,
			@RST_CODE  OUTPUT,
			@RST_MSG  OUTPUT,
			@RST_NNO  OUTPUT,
			@RST_SUB_NO  OUTPUT,
			@RST_IDX   OUTPUT
			
		SELECT @RST_STATUS AS STATUS , @RST_NNO AS  NNO , @RST_SUB_NO AS SUB_NO, @RST_CODE AS RST_CODE , @RST_MSG AS RST_MSG ,  @RST_IDX AS GROUP_IDX;
			
	</select>
	
	<select id="makeTransMap" parameterType="hashMap" resultType="com.example.temp.common.vo.ZoneVO" >
		SELECT 
			(select TRANS_NAME FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE) AS TRANS_NAME,
			TRANS_CODE,
			ZONE_CODE,
			ORG_NATION,
			DSTN_NATION,
			W_USER_ID,
			W_USER_IP,
			W_DATE,
			IDX,
			ORG_NATION+'_'+DSTN_NATION+'_'+TRANS_CODE AS TARGET_CODE
		FROM TB_TRANS_ZONE F1 WHERE ORG_NATION IN 
		<foreach collection="orgs" item="value" open="(" close=")" separator=",">
			#{value}
		</foreach>
		AND
		DSTN_NATION IN 
		<foreach collection="dstns" item="value" open="(" close=")" separator=",">
			#{value}
		</foreach>
		 ORDER BY DSTN_NATION DESC;
	</select>
	
	<select id="selectTransCom" resultType="com.example.temp.manager.vo.TransComVO" >
		SELECT 
			F1.TRANS_CODE, 
			F1.TRANS_CODE AS legacyTransCode, 
			F1.TRANS_NAME, 
			F1.ATTEN_NAME, 
			F1.ATTEN_TEL, 
			F1.ATTEN_HP, 
			F1.ATTEN_EMAIL, 
			F1.REMARK, 
			F1.MULTI_YN,
			ISNULL(F2.CHG_TYPE,'') AS CHG_TYPE,
			ISNULL(F2.CHG_FEE,'') AS CHG_FEE
		FROM TB_TRANS_COM F1 LEFT OUTER JOIN (SELECT * FROM TB_FSC_CHG WHERE DLV_CODE = 'DEFAULT' ) F2 ON F1.TRANS_CODE = F2.TRANS_CODE
	</select>
	<delete id="deleteTransCom" parameterType="String">
		DELETE FROM TB_TRANS_COM WHERE TRANS_CODE=#{value}
	</delete>
	<update id='updateTransCom' parameterType="com.example.temp.manager.vo.TransComVO">
		UPDATE TB_TRANS_COM SET
			TRANS_CODE = #{transCode},
			TRANS_NAME = #{transName}, 
			ATTEN_NAME = #{attenName}, 
			ATTEN_TEL = #{attenTel}, 
			ATTEN_HP = #{attenHp}, 
			ATTEN_EMAIL = #{attenEmail}, 
			REMARK = #{remark}, 
			MULTI_YN = #{multiYn} 
		WHERE TRANS_CODE = #{legacyTransCode};
		
		DELETE FROM TB_FSC_CHG WHERE TRANS_CODE = #{transCode} AND DLV_CODE ='DEFAULT';
		
		INSERT TB_FSC_CHG (DLV_CODE, ORG_STATION, TRANS_CODE, DSTN_NATION, CHG_TYPE, CHG_FEE, W_USER_ID, W_USER_IP, W_DATE, USE_YN)
		VALUES ('DEFAULT', #{orgStation}, #{transCode}, '',#{chgType},#{chgFee},#{wUserId},#{wUserIp},GETDATE(),'Y');
	</update>
	
	<select id="selectTotalCountNation" resultType="Integer" parameterType="hashMap">
		SELECT COUNT(*) FROM TB_TRANS_ZONE
		<where>
			1=1
			<if test ='transName != null and transName != ""'>
				AND TRANS_CODE in (SELECT TRANS_CODE FROM TB_TRANS_COM WHERE TRANS_NAME like '%'+#{transName}+'%')
			</if>
			<if test ='transCode != null and transCode != ""'>
				AND TRANS_CODE =#{transCode}
			</if>
			<if test ='zoneCode != null and zoneCode != ""'>
				AND ZONE_CODE = #{zoneCode}
			</if>
			<if test ='orgNation != null and orgNation != ""'>
				AND ORG_NATION = #{orgNation}
			</if>
			<if test ='dstnNation != null and dstnNation != ""'>
				AND DSTN_NATION = #{dstnNation}
			</if>
		</where>
	</select>
	
	<select id="selectTotalCountZone" resultType="Integer" parameterType="hashMap">
		SELECT COUNT(*) FROM TB_TRANS_PRICE
		<where>
		 1=1
		 	<if test ='transName != null and transName != ""'>
				AND TRANS_CODE in (SELECT TRANS_CODE FROM TB_TRANS_COM WHERE TRANS_NAME like '%'+#{transName}+'%')
			</if>
			<if test = 'transCode != null and transCode != ""'>
				AND TRANS_CODE = #{transCode}
			</if>
			<if test = 'zoneCode != null and zoneCode != ""'>
				AND ZONE_CODE = #{zoneCode}
			</if>
		</where>
	</select>
	
	
	<select id="selectRgstNationList" parameterType="hashMap" resultType="com.example.temp.common.vo.ZoneVO">
		SELECT * FROM (
		SELECT ROW_NUMBER() OVER(ORDER BY TRANS_NAME, ZONE_CODE ASC) AS ROWNUM, C.* FROM (
		SELECT 
		IDX,
		TRANS_CODE,
		ZONE_CODE,
		ORG_NATION,
		DSTN_NATION,
		W_USER_ID,
		W_USER_IP,
		W_DATE,
		(SELECT B.TRANS_NAME FROM TB_TRANS_COM B WHERE B.TRANS_CODE = A.TRANS_CODE) AS TRANS_NAME
		FROM TB_TRANS_ZONE A
		<where>
			1=1
			<if test ='transName != null and transName != ""'>
				AND A.TRANS_CODE in (SELECT TRANS_CODE FROM TB_TRANS_COM WHERE TRANS_NAME like '%'+#{transName}+'%')
			</if>
			<if test ='transCode != null and transCode != ""'>
				AND A.TRANS_CODE =#{transCode}
			</if>
			<if test ='zoneCode != null and zoneCode != ""'>
				AND A.ZONE_CODE = #{zoneCode}
			</if>
			<if test ='orgNation != null and orgNation != ""'>
				AND A.ORG_NATION = #{orgNation}
			</if>
			<if test ='dstnNation != null and dstnNation != ""'>
				AND A.DSTN_NATION = #{dstnNation}
			</if>
		</where>
		) C ) D 
		<where>
			<if test='paging.boardStart !=null and paging.boardStart !="" and paging.boardEnd != null and paging.boardEnd !=""'>
				D.ROWNUM BETWEEN #{paging.boardStart} and #{paging.boardEnd}
			</if>
		</where>
	</select>
	
	<select id="selectRgstZoneList" parameterType="hashMap" resultType="com.example.temp.manager.vo.PriceVO">
		SELECT * FROM (
		SELECT ROW_NUMBER() OVER(ORDER BY TRANS_NAME, ZONE_CODE ASC) AS ROWNUM, C.* FROM (
		SELECT 
		TRANS_CODE,
		ZONE_CODE,
		APPLY_DATE,
		FROM_WT,
		TO_WT,
		WT_UNIT,
		MIN_CHARGE,
		PER_WT,
		ADD_CHARGE,
		W_USER_ID,
		W_USER_IP,
		W_DATE,
		(SELECT B.TRANS_NAME FROM TB_TRANS_COM B WHERE B.TRANS_CODE = A.TRANS_CODE) AS TRANS_NAME
		FROM TB_TRANS_PRICE A
		<where>
			1=1
			<if test ='transName != null and transName != ""'>
				AND A.TRANS_CODE in (SELECT TRANS_CODE FROM TB_TRANS_COM WHERE TRANS_NAME like '%'+#{transName}+'%')
			</if>
			<if test ='zoneCode != null and zoneCode != ""'>
				AND A.ZONE_CODE = #{zoneCode}
			</if>
			<if test ='transCode != null and transCode != ""'>
				AND A.TRANS_CODE = #{transCode}
			</if>
		</where>
		) C ) D 
		<where>
			<if test='paging.boardStart !=null and paging.boardStart !="" and paging.boardEnd != null and paging.boardEnd !=""'>
				D.ROWNUM BETWEEN #{paging.boardStart} and #{paging.boardEnd}
			</if>
		</where>
	</select>
	
	<select id ="selectZoneOne" parameterType="com.example.temp.manager.vo.PriceVO" resultType="com.example.temp.manager.vo.PriceVO">
		SELECT * FROM TB_TRANS_PRICE WHERE TRANS_CODE = #{transCode} AND ZONE_CODE = #{zoneCode}
	</select>
	
	<update id="updatePrice" parameterType="com.example.temp.manager.vo.PriceVO">
		UPDATE TB_TRANS_PRICE SET 
			APPLY_DATE = #{applyDate},
			FROM_WT = #{fromWt},
			TO_WT = #{toWt},
			WT_UNIT = #{wtUnit},
			MIN_CHARGE = #{minCharge},
			PER_WT = #{perWt},
			ADD_CHARGE = #{addCharge},
			W_USER_ID = #{wUserId},
			W_USER_IP = #{wUserIp},
			W_DATE = #{wDate}
		WHERE TRANS_CODE = #{transCode} AND ZONE_CODE = #{zoneCode}
		
	</update>
	
	<insert id="transComInsert" parameterType="com.example.temp.manager.vo.TransComVO">
		INSERT INTO TB_TRANS_COM (
			TRANS_CODE, 
			TRANS_NAME, 
			ATTEN_NAME,
			ATTEN_TEL, 
			ATTEN_HP, 
			ATTEN_EMAIL, 
			REMARK, 
			MULTI_YN
		)
		VALUES ( 
			#{transCode}, 
			#{transName}, 
			#{attenName}, 
			#{attenTel},
			#{attenHp},
			#{attenEmail}, 
			#{remark}, 
			#{multiYn}
		);
		
		DELETE FROM TB_FSC_CHG WHERE TRANS_CODE = #{transCode} AND DLV_CODE ='DEFAULT';
		
		INSERT TB_FSC_CHG (DLV_CODE, ORG_STATION, TRANS_CODE, DSTN_NATION, CHG_TYPE, CHG_FEE, W_USER_ID, W_USER_IP, W_DATE, USE_YN)
		VALUES ('DEFAULT', #{orgStation}, #{transCode}, '',#{chgType},#{chgFee},#{wUserId},#{wUserIp},GETDATE(),'Y');
	</insert>
	
	<insert id="insertTransZone" parameterType="com.example.temp.common.vo.ZoneVO">
		INSERT INTO TB_TRANS_ZONE (
			TRANS_CODE,
			ZONE_CODE,
			ORG_NATION,
			DSTN_NATION,
			W_USER_ID,
			W_USER_IP,
			W_DATE
		) VALUES (
			#{transCode},
			#{zoneCode},
			#{orgNation},
			#{dstnNation},
			#{wUserId},
			#{wUserIp},
			getDate()
		)
		
	</insert>
	<update id="updateTransZone" parameterType="com.example.temp.common.vo.ZoneVO">
		UPDATE TB_TRANS_ZONE SET 
			TRANS_CODE = #{transCode}, 
			ZONE_CODE = #{zoneCode},  
			ORG_NATION = #{orgNation}, 
			DSTN_NATION = #{dstnNation},
			W_USER_ID = #{wUserId},   
			W_USER_IP = #{wUserIp},   
			W_DATE = getDate()
		WHERE IDX = ${idx}
		
	</update>
	
	<insert id="insertPrice" parameterType="com.example.temp.manager.vo.PriceVO" statementType="CALLABLE">
		EXEC SP_TRANS_PRICE_IN 
			#{transCode},
			#{zoneCode},
			#{applyDate},
			#{fromWt},
			#{toWt},
			#{wtUnit},
			#{minCharge},
			#{perWt},
			#{addCharge},
			#{wUserId},
			#{wUserIp};
	</insert>
	
	<insert id="insertUserTransCom" parameterType="hashMap">
	INSERT INTO TB_USER_TRANS_COM (
	<![CDATA[
		TRANS_CODE,
		ORG_NATION,
		DSTN_NATION,
		USER_ID,
		NATION_CODE,
		W_USER_ID,
		W_USER_IP,
		W_DATE,
		PRIORITY,
		BL_TYPE
	]]>
	) VALUES (
		#{transCode},
		#{orgNation},
		#{dstnNation},
		#{userId},
		(SELECT REMARK FROM TB_TRANS_COM WHERE TRANS_CODE = #{transCode}),
		#{wUserId},
		#{wUserIp},
		#{wDate},
		(select COUNT(*)+1 FROM TB_USER_TRANS_COM WHERE USER_ID = #{userId} and ORG_NATION = #{orgNation} AND DSTN_NATION=#{dstnNation}),
		#{blType}
	);
	</insert>
	
	<delete id="deleteUserTrkCom" parameterType="String">
		delete FROM TB_USER_TRANS_COM WHERE USER_ID = #{value}
	</delete>
	
	<select id ="selectUserTrkCom" resultType="String" parameterType="String">
		SELECT ISNULL(ORG_NATION+'_'+DSTN_NATION+'_'+TRANS_CODE,'') FROM TB_USER_TRANS_COM WHERE USER_ID =#{value}
	</select>
	
	<select id="selectUserTrkNation" resultType="String" parameterType="String">
		SELECT ORG_NATION+DSTN_NATION+TRANS_CODE
			FROM TB_USER_TRANS_COM WHERE USER_ID = #{value};
	</select>
	
	<select id="selectUserOrgNation" resultType="String" parameterType="String">
		SELECT DISTINCT(ORG_NATION)
			FROM TB_USER_TRANS_COM WHERE USER_ID = #{value};
	</select>
	
	<select id="selectUserDstnNation" resultType="String" parameterType="String">
		select DISTINCT(DSTN_NATION) AS DSTN_NATION, 
			   ISNULL((SELECT NATION_NAME FROM TB_NATION_CODE WHERE NATION_CODE = DSTN_NATION),'') AS nation_Name 
		FROM TB_USER_TRANS_COM WHERE USER_ID = #{userId};
	</select>
	
	<select id="selectHawbInfo" resultType="com.example.temp.manager.vo.HawbVO" parameterType="com.example.temp.manager.vo.HawbVO">
		SELECT
			NNO,
			ORDER_NO,
			[USER_ID],
			#{hawbNo} AS HAWB_NO,
			DSTN_STATION,
			ORG_STATION,
			USER_WTA AS wta,
			TRANS_CODE,
			USER_WTC AS wtc
			<if test='mawbNo != null and mawbNo != ""'>
			,
			#{mawbNo} AS MAWB_NO
			</if>
			
		FROM
		TB_ORDER_LIST WHERE HAWB_NO = #{hawbNo} OR HAWB_NO = (select KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO = #{hawbNo})
	</select>
	
	<select id="selectShpngList" resultType="com.example.temp.member.vo.ShpngListVO" parameterType="hashMap">
		SELECT  A.* FROM (
			SELECT
					DENSE_RANK() OVER(ORDER BY F1.W_DATE DESC) AS ROWNUM,
					ISNULL((SELECT [USER_NAME] FROM TB_CUSTOMER WHERE [USER_ID] = F1.[USER_ID]),'') AS COMPANY_NAME,
					F1.*,
					ISNULL((SELECT TRANS_NAME FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE),'') AS TRANS_NAME,
					F2.SUB_NO ,
					F2.HS_CODE ,
					F2.ITEM_DETAIL ,
					F2.UNIT_VALUE ,
					F2.ITEM_CNT ,
					ISNULL(F2.ITEM_METERIAL,'') AS ITEM_METERIAL,
					(CASE WHEN EXISTS (select * FROM TB_HAWB WHERE NNO = F1.NNO) THEN 'A' ELSE 'B' END) AS STATUS,
					(SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE = F1.ORG_STATION) AS ORG_STATION_NAME,
					(SELECT NATION_NAME FROM TB_NATION_CODE WHERE NATION_CODE = F1.DSTN_NATION) AS DSTN_NATION_NAME,
					ROUND(F2.UNIT_VALUE * F2.ITEM_CNT,2) ITEM_VALUE,
					CASE
						<!-- WHEN F1.TRANS_CODE = 'YSL' THEN ISNULL((SELECT MATCH_NO FROM TB_DELIVERY_INFO WHERE HAWB_NO = F1.HAWB_NO),'') -->
						WHEN F1.TRANS_CODE = 'YSL' THEN ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = F1.HAWB_NO),'')
						ELSE ISNULL((SELECT TRK_NO FROM TB_DELIVERY_INFO WHERE HAWB_NO = F1.HAWB_NO),'')
					END HAWB_NO2
					<!-- (SELECT TRK_NO FROM TB_DELIVERY_INFO WHERE HAWB_NO = F1.HAWB_NO) AS HAWB_NO2 -->
				FROM TB_ORDER_LIST F1 ,
					 TB_ORDER_ITEM F2
				WHERE F1.NNO = F2.NNO
					<if test='transCode != null and transCode != ""'>
					  AND F1.TRANS_CODE = #{transCode}
				    </if>
					<if test='orderType != null and orderType != ""'>
						AND F1.ORDER_TYPE = #{orderType}
				  	</if>
				  		AND
				  	  	F1.ORG_STATION  = (
							SELECT ORG_STATION FROM TB_ADMIN WHERE ADMIN_ID = #{wUserId}
						)
					<if test='searchType == "0"'>
						AND (
							F1.USER_ID like '%'+#{userId}+'%' OR
							F1.TRANS_CODE IN (select TRANS_CODE FROM TB_TRANS_COM WHERE TRANS_NAME like '%' + #{transName} + '%') OR 
							F1.ORDER_NO like '%'+#{orderNo}+'%' OR
							F1.HAWB_NO like '%'+#{hawbNo}+'%' OR
							F1.HAWB_NO IN (SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO like '%'+#{hawbNo}+'%')OR
							F1.CNEE_ZIP like '%'+#{cneeZip}+'%'
						)
					</if>
					<if test='searchType == "1"'>
						AND F1.USER_ID like '%'+#{userId}+'%'
					</if>
					<if test='searchType == "2"'>
						AND F1.TRANS_CODE IN (select TRANS_CODE FROM TB_TRANS_COM WHERE TRANS_NAME like '%' + #{transName} + '%')
					</if>
					<if test='searchType == "3"'>
						AND F1.ORDER_NO like '%'+#{orderNo}+'%'
					</if>
					<if test='searchType == "4"'>
						AND (F1.HAWB_NO like '%'+#{hawbNo}+'%' OR
						F1.HAWB_NO IN (SELECT HAWB_NO FROM TB_DELIVERY_INFO WHERE MATCH_NO like '%'+#{hawbNo}+'%'))
					</if>
					<if test='searchType == "5"'>
						AND F1.CNEE_ZIP like '%'+#{cneeZip}+'%'
					</if>
					<if test='fromDate != null and fromDate != ""'>
						AND SUBSTRING(F1.W_DATE,1,8) BETWEEN #{fromDate} AND #{toDate}
					</if>
				  	)A 
				  	<if test='paging.boardStart !=null and paging.boardStart !="" and paging.boardEnd != null and paging.boardEnd !=""'>
						<where>
							A.ROWNUM BETWEEN #{paging.boardStart} and #{paging.boardEnd}
						</where>
					</if>
				ORDER BY A.W_DATE DESC, A.NNO , A.SUB_NO
	</select>
	
	<select id="selectShpngListCount" resultType="Integer" parameterType="hashMap">
		SELECT
			Count(*)
		FROM TB_ORDER_LIST F1 ,
			 TB_ORDER_ITEM F2
		WHERE F1.NNO = F2.NNO
			<if test='transCode != null and transCode != ""'>
			  AND F1.TRANS_CODE = #{transCode}
		    </if>
			<if test='orderType != null and orderType != ""'>
				AND F1.ORDER_TYPE = #{orderType}
		  	</if>
		  		AND
		  	  	F1.ORG_STATION  = (
					SELECT ORG_STATION FROM TB_ADMIN WHERE ADMIN_ID = #{wUserId}
				)
				<if test='searchType == "0"'>
					AND (
						F1.USER_ID like '%'+#{userId}+'%' OR
						F1.TRANS_CODE IN (select TRANS_CODE FROM TB_TRANS_COM WHERE TRANS_NAME like '%' + #{transName} + '%') OR 
						F1.ORDER_NO like '%'+#{orderNo}+'%' OR
						F1.HAWB_NO like '%'+#{hawbNo}+'%' OR
						F1.HAWB_NO IN (SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO like '%'+#{hawbNo}+'%')OR
						F1.CNEE_ZIP like '%'+#{cneeZip}+'%'
					)
				</if>
				<if test='searchType == "1"'>
					AND F1.USER_ID like '%'+#{userId}+'%'
				</if>
				<if test='searchType == "2"'>
					AND F1.TRANS_CODE IN (select TRANS_CODE FROM TB_TRANS_COM WHERE TRANS_NAME like '%' + #{transName} + '%')
				</if>
				<if test='searchType == "3"'>
					AND F1.ORDER_NO like '%'+#{orderNo}+'%'
				</if>
				<if test='searchType == "4"'>
					AND (F1.HAWB_NO like '%'+#{hawbNo}+'%' OR
					F1.HAWB_NO IN (SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO like '%'+#{hawbNo}+'%'))
				</if>
				<if test='searchType == "5"'>
					AND F1.CNEE_ZIP like '%'+#{cneeZip}+'%'
				</if>
				<if test='fromDate != null and fromDate != ""'>
					AND SUBSTRING(F1.W_DATE,1,8) BETWEEN #{fromDate} AND #{toDate}
				</if>
	</select>
	
	<delete id="deleteOrderList" parameterType="hashMap" statementType="CALLABLE">
		EXEC SP_ORDER_DEL2
			#{nno},
			#{userId},
			#{userIp};
		delete from TB_ORDER_ITEM WHERE NNO = #{nno} AND NNO NOT IN (SELECT NNO FROM TB_STOCK) AND NNO NOT IN (SELECT NNO FROM TB_HAWB);
		delete from TB_ORDER_LIST WHERE NNO = #{nno} AND NNO NOT IN (SELECT NNO FROM TB_STOCK) AND NNO NOT IN (SELECT NNO FROM TB_HAWB);
	</delete>
	
	<select id="selectRecoveryListCnt" resultType="Integer" parameterType="hashMap">
		SELECT COUNT(*)
		FROM (SELECT
				F1.[USER_ID],
				(SELECT [USER_NAME] FROM TB_CUSTOMER WHERE [USER_ID] = F1.[USER_ID]) AS COMPANY_NAME,
				F1.NNO,
				F1.CNEE_NAME,
				F1.CNEE_ZIP,
				F1.CNEE_ADDR,
				F1.CNEE_ADDR_DETAIL,
				F1.CNEE_TEL,
				F1.CNEE_HP,
				F1.ORDER_NO,
				F1.D_DATE AS DEL_DATE,
				F1.ORDER_DATE,
				F1.DNO,
				F2.SUB_NO AS SUB_NO,
				F2.HS_CODE AS HS_CODE,
				F2.ITEM_DETAIL AS ITEM_DETAIL,
				F2.UNIT_VALUE AS UNIT_VALUE,
				F2.ITEM_CNT AS ITEM_CNT,
				ROUND(F2.UNIT_VALUE * F2.ITEM_CNT,2) AS ITEM_VALUE,
				F1.R_DATE AS REC_DATE,
				CASE WHEN F1.R_DATE IS NOT NULL THEN 'A' ELSE '' END AS RESULT_CODE
			FROM DEL_ORDER_LIST F1 LEFT OUTER JOIN DEL_ORDER_ITEM F2 ON F1.NNO = F2.NNO
			WHERE F1.ORG_STATION = #{orgStation}
		) M1
	</select>
	
	<select id="selectDeleteList" resultType="com.example.temp.member.vo.ShpngListVO" parameterType="hashMap">
		SELECT *
		FROM (SELECT
				ROW_NUMBER() OVER(ORDER BY F1.W_DATE DESC, F1.NNO, F2.SUB_NO) AS ROWNUM,
				F1.[USER_ID],
				(SELECT [USER_NAME] FROM TB_CUSTOMER WHERE [USER_ID] = F1.[USER_ID]) AS COMPANY_NAME,
				F1.NNO,
				F1.CNEE_NAME,
				F1.CNEE_ZIP,
				F1.CNEE_ADDR,
				F1.CNEE_ADDR_DETAIL,
				F1.CNEE_TEL,
				F1.CNEE_HP,
				F1.ORDER_NO,
				F1.D_DATE AS DEL_DATE,
				F1.ORDER_DATE,
				F1.DNO,
				F2.SUB_NO AS SUB_NO,
				F2.HS_CODE AS HS_CODE,
				F2.ITEM_DETAIL AS ITEM_DETAIL,
				F2.UNIT_VALUE AS UNIT_VALUE,
				F2.ITEM_CNT AS ITEM_CNT,
				ROUND(F2.UNIT_VALUE * F2.ITEM_CNT,2) AS ITEM_VALUE,
				F1.R_DATE AS REC_DATE,
				CASE WHEN F1.R_DATE IS NOT NULL THEN 'A' ELSE '' END AS RESULT_CODE
			FROM DEL_ORDER_LIST F1 LEFT OUTER JOIN DEL_ORDER_ITEM F2 ON F1.NNO = F2.NNO
			WHERE F1.ORG_STATION = #{orgStation}
		) M1
		WHERE M1.ROWNUM BETWEEN #{paging.boardStart} AND #{paging.boardEnd}
	</select>
	
	<select id="recoveryOrderList" parameterType="hashMap" statementType="CALLABLE">
		EXEC SP_ORDER_REC2
			#{dno},
			#{userId},
			#{userIp};
	</select>
	
	<select id="selectStockAllCol" parameterType="hashMap" resultType="com.example.temp.manager.vo.StockAllVO">
		select 
			F1.STOCK_NO,
			F1.STOCK_TYEP AS STOCK_TYPE,
			F1.ORG_STATION,
			F1.[USER_ID],
			F1.RACK_CODE,
			F1.NNO,
			F1.SUB_NO,
			F1.TAKE_IN_CODE,
			F1.WH_IN_DATE,
			F1.WH_STATUS,
			F1.WTA,
			F1.WTC,
			F1.WT_UNIT,
			F1.OUT_NNO,
			F1.TRK_COM,
			F1.TRK_NO,
			F1.GROUP_IDX,
			F2.IDX,
			F2.DSTN_STATION,
			F2.FILE_DIR,
			F3.UID,
			F3.WH_MEMO,
			F3.ADMIN_YN,
			F1.W_USER_ID,
			F1.W_USER_IP,
			F1.W_DATE
			FROM TB_STOCK F1
			LEFT OUTER JOIN TB_STOCK_FILE F2 ON F1.NNO = F2.NNO AND F1.SUB_NO = F2.SUB_NO
			LEFT OUTER JOIN TB_STOCK_MSG F3 ON F1.NNO = F3.NNO AND F1.SUB_NO = F3.SUB_NO
			WHERE F1.NNO = #{nno} AND F1.SUB_NO = #{subNo}
			ORDER BY SUB_NO ASC
	</select>
	
	<select id="selectWhMemo" parameterType="hashMap" resultType="com.example.temp.manager.vo.StockAllVO">
		SELECT 
			F1.NNO ,
			F1.SUB_NO , 
			RACK_CODE , 
			F1.TRK_COM,
			F1.TRK_NO,
			(SELECT NAME FROM TB_CODE WHERE CODE_DIV = 'WH_STATUS' AND CODE = F1.WH_STATUS) WH_STATUS_NAME,
			(SELECT COUNT(*) FROM TB_STOCK WHERE NNO = F1.NNO AND ORG_STATION = F1.ORG_STATION AND USER_ID = F1.USER_ID AND SUB_NO = F1.SUB_NO AND F1.GROUP_IDX = GROUP_IDX) WH_CNT ,
			(SELECT COUNT(*) FROM TB_STOCK WHERE NNO = F1.NNO AND ORG_STATION = F1.ORG_STATION AND USER_ID = F1.USER_ID AND SUB_NO = F1.SUB_NO) WH_TOTAL_CNT ,
			(SELECT TOP 1 WH_MEMO FROM TB_STOCK_MSG WHERE NNO = F1.NNO  AND SUB_NO = F1.SUB_NO AND ADMIN_YN = 'Y' AND F1.GROUP_IDX = GROUP_IDX ORDER BY W_DATE DESC) WH_MEMO,
			WH_STATUS,
			(SELECT TOP 1 WH_IN_DATE FROM TB_STOCK WHERE NNO = F1.NNO  AND SUB_NO = F1.SUB_NO AND F1.GROUP_IDX = GROUP_IDX ORDER BY WH_IN_DATE DESC) WH_IN_DATE,
			ISNULL(F1.WTA,F2.WTA) WTA,
			ISNULL(F1.WTC,F2.WTC) WTC,
			ISNULL(F1.WIDTH,F2.WIDTH) WIDTH,
			ISNULL(F1.HEIGHT,F2.HEIGHT) HEIGHT,
			ISNULL(F1.LENGTH,F2.LENGTH) LENGTH,
			ISNULL(F1.PER,F2.PER) PER,
			ISNULL(F1.DIM_UNIT,F2.DIM_UNIT) DIM_UNIT,
			ISNULL(F1.WT_UNIT,F2.WT_UNIT) WT_UNIT
	      FROM TB_STOCK F1
	       LEFT OUTER JOIN TB_CUS_ITEM_WEIGHT F2 
            ON F1.CUS_ITEM_CODE = F2.CUS_ITEM_CODE 
           AND F1.USER_ID = F2.USER_ID 
           AND F1.ORG_STATION =F2.ORG_STATION
	      WHERE 
	        F1.NNO = ISNULL((SELECT TOP 1 NNO FROM TB_STOCK WHERE OUT_NNO =#{nno}),#{nno}) AND 
			F1.SUB_NO = #{subNo}
	      <!-- GROUP BY 
	         F1.NNO, 
	         F1.SUB_NO, 
	         F1.RACK_CODE, 
	         F1.TRK_COM,
	         F1.TRK_NO,
	         F1.WH_STATUS ,
	         F1.ORG_STATION,
	         F1.USER_ID,
	         F1.WTA,
	         F2.WTA,
	         F1.WTC,
	         F1.WIDTH,
	         F1.HEIGHT,
	         F1.LENGTH,
	         F1.PER,
	         F1.DIM_UNIT,
	         F1.WT_UNIT,
	         F2.WTC,
	         F2.WIDTH,
	         F2.HEIGHT,
	         F2.LENGTH,
	         F2.PER,
	         F2.WT_UNIT,
	         F1.GROUP_IDX,
	         F2.DIM_UNIT
	      ORDER BY WH_IN_DATE, RACK_CODE , WH_STATUS -->;
	</select>
	
	<select id="selectDefaultInfo" parameterType ="String" resultType="com.example.temp.manager.vo.CusItemVO">
		SELECT TOP 1 * FROM TB_CUS_ITEM_WEIGHT WHERE CUS_ITEM_CODE = #{cusItemCode}  ORDER BY IDX DESC
	</select>
	
	<insert id="insertStockFile" parameterType="com.example.temp.manager.vo.StockAllVO">
		INSERT INTO TB_STOCK_FILE (
			NNO, 
			ORG_STATION,
			SUB_NO, 
			[USER_ID], 
			FILE_DIR, 
			W_USER_ID, 
			W_USER_IP, 
			W_DATE,
			GROUP_IDX,
			FILE_IDX
		)
		VALUES (  
			#{nno}, 
			#{orgStation},
			#{subNo},  
			#{userId}, 
			#{fileDir}, 
			#{wUserId}, 
			#{wUserIp},
			getDate(),
			#{groupIdx},
			#{fileIdx}
		)
	</insert>
	<insert id="insertStockMsg" parameterType="com.example.temp.manager.vo.StockAllVO">
		INSERT INTO TB_STOCK_MSG (
			ORG_STATION,
			MSG_DIV,
			NNO, 
			SUB_NO, 
			WH_MEMO, 
			[USER_ID], 
			ADMIN_YN, 
			W_DATE,
			GROUP_IDX
		)
		VALUES ( 
			#{orgStation},
			'WH',
			#{nno}, 
			#{subNo}, 
			#{whMemo}, 
			#{userId}, 
			'Y', 
			getDate(),
			#{groupIdx}
		);
	</insert>
	<insert id="insertUnRgtStockFile" parameterType="hashMap">
		INSERT INTO TB_STOCK_FILE (
			ORG_STATION,
			SUB_NO, 
			FILE_IDX,
			<if test='userId != null and userId !=""'>
				[USER_ID],
			</if> 
			FILE_DIR, 
			W_USER_ID, 
			W_USER_IP, 
			W_DATE,
			GROUP_IDX
		)
		VALUES (
			#{orgStation},  
			#{subNo},  
			#{fileIdx},
			<if test='userId != null and userId !=""'>
				#{userId},
			</if> 
			#{fileDir}, 
			#{wUserId},  
			#{wUserIp},
			getDate(),
			#{groupIdx}
		)
	</insert>
	<insert id="insertUnStockMsg" parameterType="hashMap">
		INSERT INTO TB_STOCK_MSG (
			ORG_STATION,
			SUB_NO, 
			MSG_DIV, 
			WH_MEMO, 
			<if test='userId != null and userId !=""'>
				[USER_ID],
			</if> 
			ADMIN_YN, 
			W_DATE, 
			GROUP_IDX, 
			W_USER_ID
		) VALUES ( 
			#{orgStation},
			'1', 
			'WHIN', 
			#{whMemo},
			<if test='userId != null and userId !=""'> 
				#{userId},
			</if> 
			'Y', 
			getDate(), 
			#{groupIdx},
			#{wUserId} 
		);
		
	</insert>
	<insert id="insertStockVolumn" parameterType="com.example.temp.manager.vo.StockAllVO">
	INSERT INTO
		TB_STOCK_VOLUME (
			NNO, 
			SUB_NO, 
			ORG_STATION, 
			[USER_ID], 
			WTA,
			WTC,
			WIDTH, 
			HEIGHT, 
			[LENGTH], 
			PER,
			DIM_UNIT, 
			W_USER_ID, 
			W_USER_IP, 
			W_DATE
		) VALUES ( 
			#{nno}, 
			#{subNo},
			#{orgStation},
			#{userId}, 
			#{wta},
			#{wtc},
			#{width}, 
			#{height}, 
			#{length}, 
			#{per},
			#{dimUnit}, 
			#{wUserId}, 
			#{wUserIp}, 
			getDate()
		)
	</insert>
	
	<select id="insertStock" parameterType="com.example.temp.manager.vo.StockAllVO" resultType="com.example.temp.manager.vo.StockResultVO" statementType="CALLABLE">
		DECLARE
			@GROUP_IDX NVARCHAR(50),
			@NNO NVARCHAR(50),
			@SUB_NO INT,
			@RACK_CODE NVARCHAR(50),
			@TRK_COM NVARCHAR(50),
			@TRK_NO NVARCHAR(50),
			@WH_IN_DATE NVARCHAR(10),
			@WH_STATUS NVARCHAR(50),
			@WH_IN_CTN INT,
			@REMARK NVARCHAR(500),
			@WTA FLOAT, 
			@WIDTH  FLOAT ,
			@HEIGHT FLOAT,
			@LENGTH FLOAT,
			@PER INT,
			@WT_UNIT NVARCHAR(2),
			@DIM_UNIT NVARCHAR(2), 
			@W_USER_ID NVARCHAR(50),
			@W_USER_IP NVARCHAR(50),
			@RST_STATUS NVARCHAR(50) ,
			@RST_CODE NVARCHAR(50) ,
			@RST_MSG NVARCHAR(100) ,
			@RST_NNO NVARCHAR(50) ,
			@RST_SUB_NO INT ,
			@RST_IDX NVARCHAR(50)
			
		SET @GROUP_IDX = #{groupIdx}
		SET @NNO = #{nno}
		SET @SUB_NO = #{subNo}
		SET @RACK_CODE = #{rackCode}
		SET @TRK_COM = #{trkCom}
		SET @TRK_NO = #{trkNo}
		SET @WH_IN_DATE = #{whInDate}
		SET @WH_STATUS = #{whStatus}
		SET @WH_IN_CTN = #{whInCnt}
		SET @REMARK = #{whMemo}
		SET @WTA = #{wta}
		SET @WIDTH = #{width}
		SET @HEIGHT = #{height}
		SET @LENGTH = #{length}
		SET @PER = #{per}
		SET @WT_UNIT = #{wtUnit}
		SET @DIM_UNIT = #{dimUnit}
		SET @W_USER_ID = #{wUserId}
		SET @W_USER_IP =  #{wUserIp}
		
		EXEC SP_INSP_STOCK_IN
			@GROUP_IDX,  
			@NNO ,
			@SUB_NO,
			@RACK_CODE,
			@TRK_COM,
			@TRK_NO,
			@WH_IN_DATE,
			@WH_STATUS,
			@WH_IN_CTN,
			@REMARK,
			@WTA,
			@WIDTH,
			@HEIGHT,
			@LENGTH ,
			@PER,
			@WT_UNIT,
			@DIM_UNIT,
			@W_USER_ID,
			@W_USER_IP,
			@RST_STATUS OUTPUT ,
			@RST_CODE OUTPUT ,
			@RST_MSG OUTPUT ,
			@RST_NNO OUTPUT,
			@RST_SUB_NO OUTPUT ,
			@RST_IDX OUTPUT
			
			
		SELECT
		@RST_STATUS AS STATUS,
		@RST_CODE AS RST_CODE,
		@RST_MSG AS RST_MSG,
		@RST_NNO AS NNO,
		@RST_SUB_NO AS RST_SUB_NO,
		@RST_IDX AS GROUP_IDX
	</select>
	<select id="selectStockByGrpIdx" parameterType="String" resultType="com.example.temp.manager.vo.StockVO">
		SELECT
			ISNULL(A.STOCK_NO,'') AS STOCK_NO,
			ISNULL(A.STOCK_TYEP,'') AS STOCK_TYEP,
			ISNULL(A.ORG_STATION,'') AS ORG_STATION,
			ISNULL(A.USER_ID,'') AS USER_ID,
			ISNULL(A.RACK_CODE,'') AS RACK_CODE,
			ISNULL(A.NNO,'') AS NNO,
			ISNULL(A.SUB_NO,'') AS SUB_NO,
			ISNULL(A.TAKE_IN_CODE,'') AS TAKE_IN_CODE,
			ISNULL(A.WH_IN_DATE,'') AS WH_IN_DATE,
			ISNULL(A.WH_STATUS,'') AS WH_STATUS,
			ISNULL(A.WTA,'') AS WTA,
			ISNULL(A.WIDTH,'') AS WIDTH,
			ISNULL(A.HEIGHT,'') AS HEIGHT,
			ISNULL(A.LENGTH,'') AS LENGTH,
			ISNULL(A.PER,'') AS PER,
			ISNULL(A.WTC,'') AS WTC,
			ISNULL(A.WT_UNIT,'') AS WT_UNIT,
			ISNULL(A.DIM_UNIT,'') AS DIM_UNIT,
			ISNULL(A.OUT_NNO,'') AS OUT_NNO,
			ISNULL(A.TRK_COM,'') AS TRK_COM,
			ISNULL(A.TRK_NO,'') AS TRK_NO,
			ISNULL(A.W_USER_ID,'') AS W_USER_ID,
			ISNULL(A.W_USER_IP,'') AS W_USER_IP,
			ISNULL(A.W_DATE,'') AS W_DATE,
			ISNULL(A.GROUP_IDX,'') AS GROUP_IDX,
			ISNULL(A.CUS_ITEM_CODE,'') AS CUS_ITEM_CODE,
			ISNULL((SELECT HAWB_NO FROM TB_ORDER_LIST WHERE NNO = A.NNO),'') AS HAWB_NO,
			(SELECT NAME FROM TB_CODE WHERE CODE = A.WH_STATUS AND CODE_DIV ='WH_STATUS') AS WH_STATUS_NAME FROM TB_STOCK A WHERE GROUP_IDX = #{groupIdx}
	</select>
	
	<select id="selectStockByStockNo" parameterType="String" resultType="com.example.temp.manager.vo.StockVO">
		SELECT
			ISNULL(A.STOCK_NO,'') AS STOCK_NO,
			ISNULL(A.STOCK_TYEP,'') AS STOCK_TYEP,
			ISNULL(A.ORG_STATION,'') AS ORG_STATION,
			ISNULL(A.USER_ID,'') AS USER_ID,
			ISNULL(A.RACK_CODE,'') AS RACK_CODE,
			ISNULL(A.NNO,'') AS NNO,
			ISNULL(A.SUB_NO,'') AS SUB_NO,
			ISNULL(A.TAKE_IN_CODE,'') AS TAKE_IN_CODE,
			ISNULL(A.WH_IN_DATE,'') AS WH_IN_DATE,
			ISNULL(A.WH_STATUS,'') AS WH_STATUS,
			ISNULL(A.WTA,'') AS WTA,
			ISNULL(A.WIDTH,'') AS WIDTH,
			ISNULL(A.HEIGHT,'') AS HEIGHT,
			ISNULL(A.LENGTH,'') AS LENGTH,
			ISNULL(A.PER,'') AS PER,
			ISNULL(A.WTC,'') AS WTC,
			ISNULL(A.WT_UNIT,'') AS WT_UNIT,
			ISNULL(A.DIM_UNIT,'') AS DIM_UNIT,
			ISNULL(A.OUT_NNO,'') AS OUT_NNO,
			ISNULL(A.TRK_COM,'') AS TRK_COM,
			ISNULL(A.TRK_NO,'') AS TRK_NO,
			ISNULL(A.W_USER_ID,'') AS W_USER_ID,
			ISNULL(A.W_USER_IP,'') AS W_USER_IP,
			ISNULL(A.W_DATE,'') AS W_DATE,
			ISNULL(A.GROUP_IDX,'') AS GROUP_IDX,
			ISNULL(A.CUS_ITEM_CODE,'') AS CUS_ITEM_CODE,
			ISNULL((SELECT HAWB_NO FROM TB_ORDER_LIST WHERE NNO = A.NNO),'') AS HAWB_NO,
			(SELECT NAME FROM TB_CODE WHERE CODE = A.WH_STATUS AND CODE_DIV ='WH_STATUS') AS WH_STATUS_NAME FROM TB_STOCK A WHERE STOCK_NO= #{stockNo}
	</select>
	
	<select id="selectUserRegistOrderItemOne" parameterType="com.example.temp.member.vo.UserOrderListVO" resultType="com.example.temp.member.vo.UserOrderItemVO">
		SELECT *, format(trk_date,'yyyyMMdd') AS trk_date  FROM 
		TB_ORDER_ITEM F1 LEFT OUTER JOIN TB_RUS_ORDER_ITEM_INFO F2 ON F1.NNO = F2.NNO AND F1.SUB_NO = F2.SUB_NO WHERE F1.NNO =  #{nno}
	</select>
	
	<select id="selectInspStockList" parameterType="hashMap" resultType="com.example.temp.manager.vo.insp.InspStockListVO">
		WITH TEST AS (SELECT COUNT(*) AS TOTAL_WH_CNT, SUB_NO, NNO FROM TB_STOCK WHERE ORG_STATION = #{orgStation} AND NNO IN (SELECT NNO FROM TB_ORDER_LIST) GROUP BY SUB_NO, NNO)
		SELECT  
				F1.ORDER_NO, 
				F1.ORG_STATION, 
				F1.CNEE_TEL, 
				F1.CNEE_HP, 
				F1.CNEE_ADDR, 
				F1.CNEE_NAME, 
				F1.CNEE_ZIP,
				F1.CNEE_ADDR_DETAIL,
				F2.GROUP_IDX , 
		        F2.NNO, 
		        F2.SUB_NO , 
		        F2.STOCK_NO,
				F3.ITEM_DETAIL , 
		        F3.ITEM_CNT AS REQ_CNT,
		        F3.ITEM_IMG_URL,
				F5.TOTAL_WH_CNT,
		        (SELECT NAME FROM TB_CODE WHERE CODE_DIV='WH_STATUS' AND CODE=F2.WH_STATUS) AS WH_STATUS_NAME,
		        (SELECT WH_MEMO FROM TB_STOCK_MSG WHERE MSG_DIV = 'WH' AND NNO = F2.NNO AND SUB_NO = F2.SUB_NO AND GROUP_IDX = F2.GROUP_IDX) AS WH_MEMO,
				ISNULL((SELECT WH_MEMO FROM TB_STOCK_MSG WHERE IDX = (SELECT MAX(IDX) FROM TB_STOCK_MSG WHERE MSG_DIV = 'MSG' AND NNO = F2.NNO AND SUB_NO = F2.SUB_NO AND GROUP_IDX = F2.GROUP_IDX AND ADMIN_YN = 'Y')),'') AS ADMIN_MSG,
				ISNULL((SELECT WH_MEMO FROM TB_STOCK_MSG WHERE IDX = (SELECT MAX(IDX) FROM TB_STOCK_MSG WHERE MSG_DIV = 'MSG' AND NNO = F2.NNO AND SUB_NO = F2.SUB_NO AND GROUP_IDX = F2.GROUP_IDX AND ADMIN_YN = 'N')),'') AS USER_MSG,
				F2.TRK_COM,
				F2.TRK_NO,
				COUNT(*) AS WH_CNT, 
		      	F2.USER_ID , 
		     	F2.RACK_CODE,
   				F2.W_DATE
				FROM 
				(SELECT A.* FROM (SELECT *, DENSE_RANK() OVER(ORDER BY NNO,SUB_NO ASC) AS ROWNUM FROM
				TB_STOCK WHERE ORG_STATION = #{orgStation} AND NNO IN (SELECT NNO FROM TB_ORDER_LIST)
							) A
							
							<if test='paging.boardStart !=null and paging.boardStart !="" and paging.boardEnd != null and paging.boardEnd !=""'>
								<where>
									A.ROWNUM BETWEEN #{paging.boardStart} and #{paging.boardEnd}
								</where> 
							</if>
				) F2
				LEFT OUTER JOIN TB_ORDER_LIST F1 ON F2.NNO = F1.NNO
				LEFT OUTER JOIN TB_ORDER_ITEM F3 ON F2.NNO = F3.NNO AND F2.SUB_NO = F3.SUB_NO
				LEFT OUTER JOIN TEST AS F5 ON F2.NNO = F5.NNO AND F2.SUB_NO = F5.SUB_NO
				<where>
					1=1
					AND F3.SUB_NO NOT IN (SELECT ORG_SUB_NO FROM TB_HAWB_ITEM WHERE ORG_NNO = F1.NNO)
					<if test='itemDetail != null and itemDetail != ""'>
						AND F3.ITEM_DETAIL like '%'+ #{itemDetail} + '%'
					</if>
					<if test='cneeZip != null and cneeZip != ""'>
						AND F1.CNEE_ZIP = #{cneeZip}
					</if>
					<if test='trkNo != null and trkNo != ""'>
						AND F1.NNO = ISNULL((SELECT ORG_NNO FROM TB_HAWB_ITEM WHERE HAWB_NO = #{trkNo}),(SELECT NNO FROM TB_ORDER_LIST WHERE HAWB_NO =#{trkNo}))
						<!--
						AND F1.HAWB_NO = #{trkNo} 
						AND F1.NNO = (select NNO FROM TB_STOCK WHERE OUT_NNO = (SELECT NNO FROM TB_HAWB WHERE HAWB_NO = #{trkNo})) -->
					</if>
				
				</where>
				GROUP BY 
					F1.ORDER_NO,
					F1.ORG_STATION, 
					F1.CNEE_TEL, 
					F1.CNEE_HP, 
					F1.CNEE_ADDR, 
					F1.CNEE_ZIP,
					F1.CNEE_NAME, 
					F1.CNEE_ADDR_DETAIL,
					F3.ITEM_DETAIL , 
					F3.ITEM_CNT,
			        F3.ITEM_IMG_URL,
					F2.GROUP_IDX , 
		            F2.NNO , 
		            F2.SUB_NO,
		            F2.WH_STATUS,
		          	F2.STOCK_NO,
		            F2.USER_ID,
		            F5.TOTAL_WH_CNT,
					F2.RACK_CODE,
					F2.TRK_COM,
					F2.W_DATE,
					F2.TRK_NO ORDER BY F2.NNO DESC, F2.SUB_NO ASC
	</select>
	
	<select id="selectAdminStation" parameterType="String" resultType="String">
			SELECT ORG_STATION FROM TB_ADMIN WHERE ADMIN_ID = #{userId}
	</select>
	
	<select id="selectInspStockOrderInfo" parameterType="String" resultType="com.example.temp.manager.vo.insp.InspStockListVO">
		SELECT ORDER_NO, TRANS_CODE, USER_ID, ORG_STATION, CNEE_TEL, CNEE_HP, CNEE_ADDR, CNEE_NAME, CNEE_ADDR_DETAIL FROM TB_ORDER_LIST WHERE NNO = #{parameter}
	</select>
	
	<select id="selectNnoList" parameterType="hashMap" resultType="String">
		SELECT NNO FROM (
			SELECT ROW_NUMBER() OVER(ORDER BY W_DATE DESC) AS ROWNUM, A.* FROM (
				select DISTINCT(nno) AS NNO, W_DATE FROM TB_STOCK WHERE ORG_STATION = 
					(SELECT ORG_STATION FROM TB_ADMIN WHERE ADMIN_ID = #{wUserId}) AND NNO IN (SELECT NNO FROM TB_ORDER_LIST)
			) A
		) B 
		<if test='paging.boardStart !=null and paging.boardStart !="" and paging.boardEnd != null and paging.boardEnd !=""'>
			<where>
				B.ROWNUM BETWEEN #{paging.boardStart} and #{paging.boardEnd}
			</where>
		</if>
	</select>
	
	<select id="selectFilePath" parameterType="hashMap" resultType="String">
		SELECT FILE_DIR FROM TB_STOCK_FILE WHERE NNO = #{nno} AND SUB_NO = #{subNo} AND GROUP_IDX = #{groupIdx} AND FILE_DIR != ''
	</select>
	
	<delete id="execStockDel" parameterType="hashMap" statementType="CALLABLE">
		EXEC SP_STOCK_DEL  #{groupIdx} , #{stockNo}, #{userId} , #{userIp}
	</delete>
	
	<select id="selectStationDefaultCond" parameterType="String" resultType="com.example.temp.manager.vo.StationDefaultVO">
		SELECT  
			WT_UNIT ,
			DIM_UNIT ,
			CASE WHEN WT_UNIT = 'LB' 
				THEN CASE WHEN DIM_UNIT = 'IN'
					THEN 166 
				END
				WHEN WT_UNIT = 'KG' 
					THEN CASE
				WHEN DIM_UNIT = 'IN'
					THEN 366
				WHEN DIM_UNIT = 'CM'
					THEN 6000 END
				END AS PER
		FROM TB_STATION_COND
		WHERE STATION = (SELECT ORG_STATION FROM TB_ADMIN WHERE ADMIN_ID = #{userId});
	</select>
	
	<select id="execNomalHawbChk" parameterType="com.example.temp.manager.vo.HawbVO" resultType="com.example.temp.manager.vo.HawbChkVO" statementType="CALLABLE">
		DECLARE 
		@RST_STATUS NVARCHAR(10),
		@RST_CODE NVARCHAR(10),
		@RST_MSG NVARCHAR(100),
		@RST_NNO NVARCHAR(50),
		@RST_HAWB_NO NVARCHAR(50)
		
		EXEC SP_NOMAL_HAWB_CHK
		   #{hawbNo} ,
		   #{orgStation},
		   #{wUserId},
		   #{wUserIp},
		   @RST_STATUS OUTPUT ,
		   @RST_CODE OUTPUT ,
		   @RST_MSG  OUTPUT ,
		   @RST_NNO  OUTPUT ,
		   @RST_HAWB_NO OUTPUT 
		   
		
		
		SELECT @RST_STATUS AS STATUS,
		       @RST_CODE  AS CODE,
		       @RST_MSG  AS RST_MSG ,
		      @RST_NNO  AS RST_NNO , 
		      @RST_HAWB_NO  AS HAWB_NO;
	</select>
	<select id="execNomalHawbIn" parameterType="com.example.temp.manager.vo.OrderRcptVO" resultType="com.example.temp.manager.vo.ProcedureVO" statementType="CALLABLE">
		DECLARE 
		@RST_STATUS NVARCHAR(10),
		@RST_CODE NVARCHAR(10),
		@RST_MSG NVARCHAR(100),
		@RST_NNO NVARCHAR(50),
		@RST_HAWB_NO NVARCHAR(50)
		
		EXEC SP_NOMAL_HAWB_IN
		   #{hawbNo},
		   #{orgStation},
		   #{boxCnt},
		   #{wta},
		   #{wtc},
		   #{wtUnit}  ,
		   #{wUserId},
		   #{wUserIp},
		   @RST_STATUS  OUTPUT ,
		   @RST_CODE OUTPUT ,
		   @RST_MSG  OUTPUT ,
		   @RST_NNO OUTPUT ,
		   @RST_HAWB_NO  OUTPUT 
		   
		   
		SELECT @RST_STATUS AS RST_STATUS,
		      @RST_CODE AS RST_CODE,
		      @RST_MSG AS RST_MSG,
		      @RST_NNO AS RST_NNO,
		      @RST_HAWB_NO AS RST_HAWB_NO;
	</select>
	
	<select id="execNomalHawbVolume" parameterType="com.example.temp.manager.vo.VolumeVO" resultType="com.example.temp.manager.vo.ProcedureVO" statementType="CALLABLE">
		 DECLARE
			 @NNO NVARCHAR(50),
			 @WIDTH FLOAT,
			 @HEIGHT FLOAT,
			 @LENGTH FLOAT,
			 @PER INT,
			 @WT_UNIT NVARCHAR(2),
			 @DIM_UNIT NVARCHAR(2),
			 @W_USER_ID  NVARCHAR(50),
			 @W_USER_IP  NVARCHAR(50),
			 @RST_STATUS NVARCHAR(10)  ,
			 @RST_CODE NVARCHAR(10)  ,
			 @RST_MSG NVARCHAR(100)  ,
			 @RST_NNO NVARCHAR(50)  ,
			 @RST_HAWB_NO NVARCHAR(50)  
			 
		SET @NNO = #{nno}
		SET @WIDTH = #{width}
		SET @HEIGHT  = #{height}
		SET @LENGTH = #{length}
		SET @PER = #{per}
		SET @WT_UNIT  = #{wtUnit}
		SET @DIM_UNIT = #{dimUnit}
		SET @W_USER_ID  = #{wUserId}
		SET @W_USER_IP = #{wUserIp}
			 
			 
		
		EXEC SP_HAWB_VOLUME_IN
			 @NNO ,
			 @WIDTH ,
			 @HEIGHT,
			 @LENGTH,
			 @PER ,
			 @WT_UNIT,
			 @DIM_UNIT,
			 @W_USER_ID ,
			 @W_USER_IP,
			 @RST_STATUS OUTPUT ,
			 @RST_CODE OUTPUT ,
			 @RST_MSG  OUTPUT ,
			 @RST_NNO  OUTPUT ,
			 @RST_HAWB_NO OUTPUT 
		
		
		SELECT 
			 @RST_STATUS AS RST_STATUS,
			 @RST_CODE AS RST_CODE,
			 @RST_MSG  AS RST_MSG,
			 @RST_NNO AS RST_NNO,
			 @RST_HAWB_NO AS RST_HAWB_NO
	</select>
	
	<delete id = "deleteVolume" parameterType="String">
		DELETE FROM TB_VOLUME WHERE NNO =#{parameter}
	</delete>
	<select id="selectMsgHist" parameterType="hashMap" resultType="com.example.temp.manager.vo.StockMsgVO">
		SELECT * FROM TB_STOCK_MSG WHERE MSG_DIV = 'MSG' AND NNO =#{nno} AND GROUP_IDX = #{groupIdx}
	</select>
	<insert id="insertMsgInfo" parameterType="com.example.temp.manager.vo.StockMsgVO">
		INSERT INTO TB_STOCK_MSG (
			ORG_STATION,
			NNO, 
			SUB_NO, 
			MSG_DIV, 
			WH_MEMO, 
			[USER_ID], 
			ADMIN_YN, 
			W_DATE, 
			GROUP_IDX, 
			W_USER_ID,
			W_USER_IP
		) VALUES ( 
			(SELECT ORG_STATION FROM TB_ORDER_LIST WHERE NNO = #{nno}),
			#{nno}, 
			#{subNo}, 
			#{msgDiv}, 
			#{whMemo}, 
			(SELECT MAX(USER_ID) FROM TB_STOCK WHERE NNO = #{nno}), 
			#{adminYn}, 
			getDate(), 
			#{groupIdx},
			#{wUserId} ,
			#{wUserIp}
		);
		
	</insert>
	
	
	
	<select id="selectRegistHawbList" parameterType="String" resultType="com.example.temp.manager.vo.HawbListVO">
		SELECT
		   F1.NNO,
		   F1.USER_ID ,
	       F3.USER_NAME,
	       (SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE = F2.ORG_STATION) ORG_STATION,
	       F1.TRANS_CODE,
	       (SELECT TRANS_NAME FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE) AS TRANS_NAME,
	       F1.HAWB_NO,
	       ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = F1.HAWB_NO AND NNO = F1.NNO),'') AS AGENCY_BL,
	       F1.DSTN_NATION,
	       F1.BOX_CNT,
	       F2.ORDER_NO,
	       F2.SHIPPER_NAME,
	       F2.CNEE_NAME,
	       ISNULL(F2.CUSTOMS_NO,'') AS CUSTOMS_NO,
	       F2.CNEE_TEL,
	       F2.CNEE_HP,
	       ISNULL(F2.CNEE_CNTRY,'') AS CNEE_CNTRY,
	       ISNULL(F2.CNEE_STATE,'') AS CNEE_STATE,
	       ISNULL(F2.CNEE_DISTRICT,'') AS CNEE_DISTRICT,
	       F2.CNEE_ADDR,
	       F2.CNEE_ADDR_DETAIL,
	       ISNULL(F1.WTA,'') AS WTA,
	       ISNULL(F1.WTC,'') AS WTC,
	       F3.COM_E_NAME,
	       F3.COM_NAME,
	       ISNULL((SELECT COUNT(*) FROM TB_DELIVERY_INFO WHERE HAWB_NO = F1.HAWB_NO), 0) AS CHECK_CNT
	  FROM TB_HAWB F1  ,
	       TB_ORDER_LIST F2 ,
	       TB_CUSTOMER F3
	 WHERE F1.NNO = F2.NNO
	   AND F1.USER_ID =F2.USER_ID
	   AND F1.USER_ID = F3.USER_ID
	   AND F1.ORG_STATION = (SELECT ORG_STATION FROM TB_ADMIN WHERE [ADMIN_ID] = #{wUserId})
	   <if test ='transCode != null and transCode != ""'>
			AND F1.TRANS_CODE like '%'+#{transCode}+'%'
	   </if>
	   AND F1.MAWB_NO = '';
	</select>
	
	<select id="insertHawbMawb" parameterType="hashMap" resultType="com.example.temp.manager.vo.ProcedureVO" statementType="CALLABLE">	
		DECLARE 
			@MAWB_NO NVARCHAR(50),
			@HAWB_NO NVARCHAR(50),
			@W_USER_ID NVARCHAR(50),
			@W_USER_IP NVARCHAR(50),
			@BAG_NO NVARCHAR(50),
			@RST_STATUS NVARCHAR(50),
			@RST_CODE NVARCHAR(50),
			@RST_MSG NVARCHAR(100),
			@RST_MAWB_NO NVARCHAR(100),
			@RST_HAWB_NO NVARCHAR(100)
			
			SET @MAWB_NO = #{mawbNo}
			SET @HAWB_NO = #{hawbNo}
			SET @W_USER_ID = #{wUserId}
			SET @W_USER_IP = #{wUserIp}
			SET @BAG_NO = #{bagNo}
			SET @RST_STATUS = ''
			SET @RST_CODE = ''
			SET @RST_MSG = ''
			SET @RST_MAWB_NO = ''
			SET @RST_HAWB_NO = ''
			
		EXEC SP_MAWB_APPLY_BK
			@MAWB_NO ,
			@HAWB_NO ,
			@W_USER_ID ,
			@W_USER_IP ,
			@BAG_NO,
			@RST_STATUS OUTPUT,
			@RST_CODE OUTPUT,
			@RST_MSG OUTPUT,
			@RST_MAWB_NO OUTPUT,
			@RST_HAWB_NO OUTPUT
			
		SELECT 
			@RST_STATUS AS RST_STATUS ,
			@RST_CODE AS RST_CODE,
			@RST_MSG AS RST_MSG,
			@RST_MAWB_NO AS RST_MAWB_NO,
			@RST_HAWB_NO AS RST_HAWB_NO;
	</select>
	
	<select id="execMawbCancle" parameterType="hashMap" resultType="com.example.temp.manager.vo.ProcedureVO" statementType="CALLABLE">	
		DECLARE 
			@HAWB_NO NVARCHAR(50),
			@W_USER_ID NVARCHAR(50),
			@W_USER_IP NVARCHAR(50),
			@RST_STATUS NVARCHAR(50),
			@RST_CODE NVARCHAR(50),
			@RST_MSG NVARCHAR(100),
			@RST_HAWB_NO NVARCHAR(100) 
			
			SET @HAWB_NO = #{hawbNo}
			SET @W_USER_ID = #{wUserId}
			SET @W_USER_IP = #{wUserIp}
			SET @RST_STATUS = ''
			SET @RST_CODE = ''
			SET @RST_MSG = ''
			SET @RST_HAWB_NO = ''
			
		EXEC SP_MAWB_CANCLE_BK
			@HAWB_NO ,
			@W_USER_ID ,
			@W_USER_IP ,
			@RST_STATUS OUTPUT,
			@RST_CODE OUTPUT,
			@RST_MSG OUTPUT,
			@RST_HAWB_NO OUTPUT
			
		SELECT 
			@RST_STATUS AS RST_STATUS ,
			@RST_CODE AS RST_CODE,
			@RST_MSG AS RST_MSG,
			@RST_HAWB_NO AS RST_HAWB_NO;
	</select>
	
	<select id="selectOrderRcptList" parameterType="com.example.temp.manager.vo.OrderListVO" resultType="com.example.temp.manager.vo.OrderListVO">
		SELECT NNO , -- PK
       ORG_STATION ,
       DSTN_STATION ,
       DSTN_NATION ,
       USER_ID ,
       HAWB_NO ,
       BOX_CNT ,
       CNEE_NAME ,
       NATIVE_CNEE_NAME,
       CNEE_TEL,
       CNEE_HP,
       CNEE_ZIP,
       CNEE_CITY,
       CNEE_STATE,
       CNEE_DISTRICT,
       CNEE_ADDR ,
       CNEE_ADDR_DETAIL ,
       NATIVE_CNEE_ADDR,
       NATIVE_CNEE_ADDR_DETAIL,
       F1.USER_WTA,
       F1.TRANS_CODE,
       CASE WHEN USER_WIDTH * USER_LENGTH * USER_HEIGHT > 0  THEN 
	   CAST(       
		(USER_WIDTH * USER_LENGTH * USER_HEIGHT  /
		(SELECT PER_DIM FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE)) AS numeric(20,8))
       ELSE CAST(0 AS FLOAT) END USER_WTC,
       --CASE WHEN USER_WIDTH * USER_LENGTH * USER_HEIGHT > 0  THEN USER_WIDTH * USER_LENGTH * USER_HEIGHT  /
       --(SELECT PER_DIM FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE)  ELSE 0 END USER_WTC,
       (SELECT TOP 1 ITEM_DETAIL FROM TB_ORDER_ITEM WHERE NNO = F1.NNO ORDER BY UNIT_VALUE * ITEM_CNT DESC) MAIN_ITEM,
       (SELECT SUM(UNIT_VALUE*ITEM_CNT) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO ) TOTAL_VALUE
  FROM TB_ORDER_LIST F1
  WHERE
  	HAWB_NO NOT IN (SELECT HAWB_NO FROM TB_HAWB) AND
  	ORG_STATION = #{orgStation}
    AND DSTN_NATION LIKE '%'+#{dstnNation}+'%'
    AND ORDER_TYPE LIKE '%'+#{orderType}+'%'
    AND HAWB_NO LIKE '%'+#{hawbNo}+'%'
    AND USER_ID LIKE '%'+#{userId}+'%'
    AND CNEE_NAME LIKE '%'+#{cneeName}+'%'
    <if test ='startDate != null and startDate != "" and endDate != null and endDate != ""'>
    	 AND SUBSTRING(NNO,1,8) BETWEEN #{startDate} AND #{endDate}
    </if>
	</select>
	<select id="execOrderRcptList" parameterType="HashMap" resultType="com.example.temp.manager.vo.ProcedureVO" statementType="CALLABLE">	
		DECLARE 
			@NNO NVARCHAR(50) ,
			@ORG_STATION NVARCHAR(3),   
			@W_USER_ID NVARCHAr(50) ,
			@W_USER_IP NVARCHAr(50) ,
			@RST_STATUS NVARCHAR(10)  ,
			@RST_CODE NVARCHAR(10)  ,
			@RST_MSG NVARCHAR(100)  ,
			@RST_NNO NVARCHAR(50)  ,
			@RST_HAWB_NO NVARCHAR(50)  
			
			SET @NNO = #{nno}
			SET @ORG_STATION  = #{orgStation}
			SET @W_USER_ID = #{wUserId}
			SET @W_USER_IP = #{wUserIp}
			
			
		EXEC SP_NOMAL_HAWB_PASS
			@NNO  ,
			@ORG_STATION,   
			@W_USER_ID ,
			@W_USER_IP ,
			@RST_STATUS OUTPUT ,
			@RST_CODE OUTPUT,
			@RST_MSG OUTPUT ,
			@RST_NNO OUTPUT,
			@RST_HAWB_NO OUTPUT
			
		SELECT 
			@RST_STATUS AS RST_STATUS,
			@RST_CODE AS RST_CODE,
			@RST_MSG AS RST_MSG,
			@RST_NNO AS RST_NNO,
			@RST_HAWB_NO AS RST_HAWB_NO;
	</select>
	
	<select id="selectManifastMawb" parameterType="String" resultType="com.example.temp.manager.vo.ManifastVO">
		SELECT MAX(ORDER_NO) CSID , 
             HAWB_NO AS HAWB_NO ,
             MAX(BOX_CNT) AS  BOX_CNT ,
             MAX(SHIPPER_NAME) AS  SHIPPER_NAME ,
             MAX(SHIPPER_TEL) AS  SHIPPER_TEL ,
             MAX(SHIPPER_ADDR) AS SHIPPER_ADDR,
             MAX(CNEE_TEL) AS CNEE_TEL ,
             MAX(NATIVE_CNEE_NAME) AS NATIVE_CNEE_NAME ,
             MAX(CNEE_NAME) AS CNEE_NAME ,
             MAX(CNEE_ZIP) AS CNEE_ZIP ,
             MAX(NATIVE_CNEE_ADDR) AS  NATIVE_CNEE_ADDR ,
             MAX(NATIVE_CNEE_ADDR_DETAIL) AS  NATIVE_CNEE_ADDR_DETAIL , 
             MAX(WTA) AS  USER_WTA,
             MAX(USER_LENGTH) AS USER_LENGTH,
             MAX(USER_WIDTH) AS USER_WIDTH,
             MAX(USER_HEIGHT) AS USER_HEIGHT,
             SUM(ITEM_CNT) AS Declare_Quantity ,
             MAX(CHG_CURRENCY) AS CHG_CURRENCY,
             MAX(CASE WHEN ROW_NUM = 1 THEN CUS_ITEM_CODE  ELSE '' END) CUS_ITEM_CODE1,
             MAX(CASE WHEN ROW_NUM = 1 THEN ITEM_DETAIL  ELSE '' END) ITEM_DETAIL1, 
             MAX(CASE WHEN ROW_NUM = 1 THEN ITEM_METERIAL  ELSE '' END) ITEM_METERIAL1, 
             MAX(CASE WHEN ROW_NUM = 1 THEN ITEM_CNT  ELSE '' END) ITEM_CNT1,
             MAX(CASE WHEN ROW_NUM = 1 THEN UNIT_VALUE  ELSE '' END) UNIT_VALUE1,
             MAX(CASE WHEN ROW_NUM = 2 THEN CUS_ITEM_CODE  ELSE '' END) CUS_ITEM_CODE2,
             MAX(CASE WHEN ROW_NUM = 2 THEN ITEM_DETAIL  ELSE '' END) ITEM_DETAIL2, 
             MAX(CASE WHEN ROW_NUM = 2 THEN ITEM_METERIAL  ELSE '' END) ITEM_METERIAL2, 
             MAX(CASE WHEN ROW_NUM = 2 THEN ITEM_CNT  ELSE '' END) ITEM_CNT2,
             MAX(CASE WHEN ROW_NUM = 2 THEN UNIT_VALUE  ELSE '' END) UNIT_VALUE2,
             MAX(CASE WHEN ROW_NUM = 3 THEN CUS_ITEM_CODE  ELSE '' END) CUS_ITEM_CODE3,
             MAX(CASE WHEN ROW_NUM = 3 THEN ITEM_DETAIL  ELSE '' END) ITEM_DETAIL3, 
             MAX(CASE WHEN ROW_NUM = 3 THEN ITEM_METERIAL  ELSE '' END) ITEM_METERIAL3, 
             MAX(CASE WHEN ROW_NUM = 3 THEN ITEM_CNT  ELSE '' END) ITEM_CNT3,
             MAX(CASE WHEN ROW_NUM = 3 THEN UNIT_VALUE  ELSE '' END) UNIT_VALUE3,
             MAX(CASE WHEN ROW_NUM = 4 THEN CUS_ITEM_CODE  ELSE '' END) CUS_ITEM_CODE4,
             MAX(CASE WHEN ROW_NUM = 4 THEN ITEM_DETAIL  ELSE '' END) ITEM_DETAIL4, 
             MAX(CASE WHEN ROW_NUM = 4 THEN ITEM_METERIAL  ELSE '' END) ITEM_METERIAL4, 
             MAX(CASE WHEN ROW_NUM = 4 THEN ITEM_CNT  ELSE '' END) ITEM_CNT4,
             MAX(CASE WHEN ROW_NUM = 4 THEN UNIT_VALUE  ELSE '' END) UNIT_VALUE4,
             MAX(CASE WHEN ROW_NUM = 5 THEN CUS_ITEM_CODE  ELSE '' END) CUS_ITEM_CODE5,
             MAX(CASE WHEN ROW_NUM = 5 THEN ITEM_DETAIL  ELSE '' END) ITEM_DETAIL5, 
             MAX(CASE WHEN ROW_NUM = 5 THEN ITEM_METERIAL  ELSE '' END) ITEM_METERIAL5, 
             MAX(CASE WHEN ROW_NUM = 5 THEN ITEM_CNT  ELSE '' END) ITEM_CNT5,
             MAX(CASE WHEN ROW_NUM = 5 THEN UNIT_VALUE  ELSE '' END) UNIT_VALUE5,
             MAX(MAKE_CNTRY)  AS MAKE_CNTRY
      FROM ( SELECT RANK() OVER ( PARTITION BY F1.NNO ORDER BY F2.NNO,F2.SUB_NO) ROW_NUM,  
                    F1.ORDER_NO ,
                    F3.HAWB_NO , 
                    F3.BOX_CNT,
                    F1.SHIPPER_NAME,
                    F1.SHIPPER_TEL ,
                    F1.SHIPPER_ADDR,
                    F1.CNEE_TEL , 
                    F1.NATIVE_CNEE_NAME,
                    F1.CNEE_NAME,
                    F1.CNEE_ZIP,
                    F1.NATIVE_CNEE_ADDR,
                    F1.NATIVE_CNEE_ADDR_DETAIL,
                    F3.WTA WTA,
                    CASE WHEN ISNULL((SELECT WIDTH*HEIGHT*LENGTH/PER  FROM TB_VOLUME WHERE HAWB_NO = F1.HAWB_NO),0) = 0  THEN USER_LENGTH ELSE ISNULL((SELECT LENGTH FROM TB_VOLUME WHERE HAWB_NO = F1.HAWB_NO),'') END AS USER_LENGTH,
                    CASE WHEN ISNULL((SELECT WIDTH*HEIGHT*LENGTH/PER  FROM TB_VOLUME WHERE HAWB_NO = F1.HAWB_NO),0) = 0  THEN USER_HEIGHT ELSE ISNULL((SELECT HEIGHT FROM TB_VOLUME WHERE HAWB_NO = F1.HAWB_NO),'') END AS USER_HEIGHT, 
                    CASE WHEN ISNULL((SELECT WIDTH*HEIGHT*LENGTH/PER  FROM TB_VOLUME WHERE HAWB_NO = F1.HAWB_NO),0) = 0  THEN USER_WIDTH ELSE  ISNULL((SELECT WIDTH FROM TB_VOLUME WHERE HAWB_NO = F1.HAWB_NO),'') END USER_WIDTH,
                    F2.UNIT_VALUE,
                    CASE WHEN ISNULL(F2.BRAND,'') != '' THEN CONCAT('[',F2.BRAND,']' , ' ',F2.ITEM_DETAIL)
                    ELSE  F2.ITEM_DETAIL END AS ITEM_DETAIL  ,
                    F2.CUS_ITEM_CODE,
                    F2.ITEM_METERIAL ,
                    F4.ITEM_CNT ,
                    F2.CHG_CURRENCY ,
                    F2.MAKE_CNTRY
               FROM TB_ORDER_LIST AS F1 , 
                    TB_ORDER_ITEM AS F2 ,
                    TB_HAWB AS F3,
                    TB_HAWB_ITEM AS F4
      WHERE F1.NNO = F2.NNO
        AND F1.NNO = F3.NNO
        AND F1.NNO = F4.NNO
        AND F2.SUB_NO = F4.SUB_NO
        AND F3.MAWB_NO = #{mawbNo}
        )  M1
       GROUP BY HAWB_NO
	</select>
	
	<select id ="selectSendList" parameterType="com.example.temp.manager.vo.SendVO" resultType="com.example.temp.manager.vo.SendVO">
		SELECT *
		FROM (
			SELECT
				ROW_NUMBER() OVER(ORDER BY F3.DEP_DATE DESC, F1.W_DATE DESC) ROWNUM,
				F2.NNO,
				F1.HAWB_NO,
				F1.USER_ID,
				ISNULL((SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = F1.ORG_STATION),'') AS NATION_CODE,
				F2.DSTN_NATION,
				F2.TRANS_CODE,
				ISNULL(F3.MAWB_NO,'') AS MAWB_NO,
				ISNULL(F2.ORDER_NO,'') AS ORDER_NO,
				ISNULL(F2.CNEE_NAME,'') AS CNEE_NAME,
				ISNULL(F2.NATIVE_CNEE_NAME,'') AS NATIVE_CNEE_NAME,
				ISNULL(F2.CNEE_TEL,'') AS CNEE_TEL,
				ISNULL(F2.CNEE_ZIP,'') AS CNEE_ZIP,
				ISNULL((SELECT TOP 1 ITEM_DETAIL FROM TB_ORDER_ITEM WHERE NNO = F2.NNO),'') AS MAIN_ITEM,
				ROUND((SELECT SUM(ITEM_CNT*UNIT_VALUE) FROM TB_ORDER_ITEM WHERE NNO = F2.NNO),2) AS TOTAL_VALUE,
				ISNULL((SELECT TRK_NO FROM TB_DELIVERY_INFO WHERE NNO = F2.NNO),'') AS VALUE_MATCH_NO,
				ROUND(F1.WTA,2) AS WTA,
				ROUND(F1.WTC,2) AS WTC
			FROM TB_HAWB F1 
			JOIN TB_ORDER_LIST F2 ON F2.NNO = F1.NNO AND F2.HAWB_NO = F1.HAWB_NO
			LEFT OUTER JOIN TB_MAWB F3 ON F3.MAWB_NO = F1.MAWB_NO AND F3.ORG_STATION = F1.ORG_STATION
			WHERE F1.ORG_STATION = #{orgStation}
			<if test='mawbNo != null and mawbNo != ""'>
				AND F1.MAWB_NO = #{mawbNo}
		   	</if>
		   	<if test='userId != null and userId != ""'>
		   		AND F1.USER_ID LIKE '%'+#{userId}+'%'
		   	</if>
		   	<if test='hawbNo != null and hawbNo != ""'>
		   		AND F1.HAWB_NO = #{hawbNo} OR F1.HAWB_NO = (SELECT HAWB_NO FROM TB_DELIVERY_INFO WHERE MATCH_NO = #{hawbNo})
		   	</if>
		   	<if test='startDate != null and startDate !=""'>
		   		AND F3.DEP_DATE <![CDATA[ >= ]]> #{startDate}
		   	</if>
		   	<if test='endDate != null and endDate !=""'>
		   		AND F3.DEP_DATE <![CDATA[ <= ]]> #{endDate}
		   	</if>
		   	<if test='orderNo != null and orderNo != ""'>
		   		AND F2.ORDER_NO = #{orderNo}
			</if>
			<if test='transCode != null and transCode != ""'>
				AND F1.TRANS_CODE = #{transCode}
			</if>
		) M1
		WHERE M1.ROWNUM BETWEEN #{paging.boardStart} and #{paging.boardEnd}
		ORDER BY ROWNUM
	</select>
	
	<select id="selectSendExcelList" parameterType="hashMap" resultType="com.example.temp.manager.vo.SendVO">
		SELECT A.* FROM (
		SELECT 
				ISNULL(ROW_NUMBER() OVER(ORDER BY F3.DEP_DATE DESC),'') AS ROWNUM,
				ISNULL(UPPER(F1.USER_ID),'') AS USER_ID,
		        ISNULL((SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE =  F1.ORG_STATION),'') AS NATION_CODE,
       			ISNULL(F1.DSTN_NATION,'') AS DSTN_NATION, 
       			ISNULL(F1.TRANS_CODE,'') AS TRANS_CODE,
       		    ISNULL((SELECT TRANS_NAME FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE),'') AS TRANS_NAME ,
		        ISNULL(F1.HAWB_NO,'') AS HAWB_NO ,
		        ISNULL(F1.MAWB_NO,'') AS MAWB_NO,
		        ISNULL(F2.ORDER_NO,'') AS ORDER_NO ,
		        ISNULL(F2.ORDER_DATE,'') AS ORDER_DATE,
		        ISNULL(F2.CNEE_NAME,'') AS CNEE_NAME,
		        ISNULL(F2.NATIVE_CNEE_NAME,'') AS NATIVE_CNEE_NAME,
		        ISNULL(F2.CNEE_TEL,'') AS CNEE_TEL,
		        ISNULL(F2.CNEE_HP,'') AS CNEE_HP,
		        ISNULL(F2.NATIVE_CNEE_ADDR,'') AS NATIVE_CNEE_ADDR,
		        ISNULL(F2.NATIVE_CNEE_ADDR_DETAIL,'') AS NATIVE_CNEE_ADDR_DETAIL,
		        ISNULL(F2.CNEE_ADDR,'') AS CNEE_ADDR,
		        ISNULL(F2.SHIPPER_REFERENCE,'') as SHIPPER_REFERENCE,
		        ISNULL(F2.CNEE_ADDR_DETAIL,'') AS CNEE_ADDR_DETAIL,
				ISNULL((SELECT ARR_DATE FROM TB_MAWB F3 WHERE F3.MAWB_NO = F1.MAWB_NO),'') AS ARR_DATE,
				ISNULL((SELECT DEP_DATE FROM TB_MAWB F3 WHERE F3.MAWB_NO = F1.MAWB_NO),'') AS DEP_DATE,
--				ISNULL((LEFT(REPLACE(F2.W_DATE,'-',''),8)),'') AS ORDER_DATE,
				ISNULL(F2.CNEE_ZIP,'') AS CNEE_ZIP ,
		      	ISNULL((SELECT TOP 1 A2.ITEM_DETAIL
		           FROM TB_HAWB_ITEM A1 ,
		                TB_ORDER_ITEM A2
		          WHERE A1.NNO = A2.NNO
		            AND A1.SUB_NO = A2.SUB_NO
		            AND A1.NNO = F1.NNO
		          ORDER BY A2.UNIT_VALUE * A1.ITEM_CNT  DESC),'') AS  MAIN_ITEM,
		          ISNULL(ROUND((SELECT SUM(A1.ITEM_CNT * A2.UNIT_VALUE)
		           FROM TB_HAWB_ITEM A1 ,
		                TB_ORDER_ITEM A2
		          WHERE A1.NNO = A2.NNO
		            AND A1.SUB_NO = A2.SUB_NO
		            AND A1.NNO = F1.NNO),2),'') AS TOTAL_VALUE,
		           ISNULL(F1.WTA,'') AS WTA ,
		           ISNULL(F1.WTC,'') AS WTC,
		           ISNULL(F1.BOX_CNT,'') AS BOX_CNT,
		           ISNULL((SELECT TRK_NO FROM TB_DELIVERY_INFO WHERE NNO = F1.NNO),F1.HAWB_NO) VALUE_MATCH_NO
		   FROM TB_HAWB F1  LEFT OUTER JOIN TB_ORDER_LIST F2 ON F1.NNO = F2.NNO
		   					LEFT OUTER JOIN TB_MAWB F3 ON F1.MAWB_NO = F3.MAWB_NO
		   WHERE F1.ORG_STATION = #{orgStation}
		   <if test='mawbNo != null and mawbNo != ""'>
		   			AND F1.MAWB_NO = #{mawbNo}
		   </if>
		   <if test='userId != null and userId != ""'>
		   			AND F1.USER_ID LIKE '%'+#{userId}+'%'
		   </if>
		   <if test='hawbNo != null and hawbNo != ""'>
		   			AND (ISNULL(F1.HAWB_NO,'') = #{hawbNo}
		   				 OR F1.HAWB_NO = (SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO = #{hawbNo}))
		   </if>
		   <if test='startDate != null and startDate !=""'>
		   			<![CDATA[AND F3.DEP_DATE >= #{startDate}]]>
		   </if>
		   <if test='endDate != null and endDate !=""'>
		   			<![CDATA[AND F3.DEP_DATE <= #{endDate}]]>
		   </if>
		   <if test='transCode != null and transCode != ""'>
		   	AND F1.TRANS_CODE = #{transCode}
		   </if>
		   <if test='orderNo != null and orderNo != ""'>
		   			AND F1.ORDER_NO = #{orderNo}
			</if>
	     	) A
	</select>
	
	<select id="selectTransCodeList" parameterType="hashMap" resultType="hashMap">
		SELECT TRANS_CODE AS transCode, ISNULL((SELECT TRANS_NAME FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE), TRANS_CODE) AS transName 
		FROM TB_HAWB F1 
		WHERE ORG_STATION = #{orgStation} GROUP BY TRANS_CODE
	</select>
	
	<select id="selectMawbApplyListCnt" parameterType="hashMap" resultType="Integer">
		SELECT COUNT(*) FROM TB_HAWB WHERE ORG_STATION = #{orgStation} AND ISNULL(MAWB_NO,'') != ''
	</select>
	
	<select id="selectMawbApplyList" parameterType="hashMap" resultType="com.example.temp.manager.vo.SendVO">
	
	</select>
	
	<select id ="selectSendListCount" parameterType="com.example.temp.manager.vo.SendVO" resultType="Integer">
		SELECT COUNT(*)
		FROM TB_HAWB F1 
		LEFT OUTER JOIN TB_ORDER_LIST F2 ON F1.NNO = F2.NNO AND F1.HAWB_NO = F2.HAWB_NO
		LEFT OUTER JOIN TB_MAWB F3 ON F3.MAWB_NO = F1.MAWB_NO 
		WHERE F1.ORG_STATION = #{orgStation}
		   <if test='mawbNo != null and mawbNo != ""'>
			AND F1.MAWB_NO = #{mawbNo}
		   </if>
		   <if test='userId != null and userId != ""'>
		   	AND F1.USER_ID LIKE '%'+#{userId}+'%'
		   </if>
		   <if test='hawbNo != null and hawbNo != ""'>
		   	AND F1.HAWB_NO = #{hawbNo} OR F1.HAWB_NO = (SELECT HAWB_NO FROM TB_DELIVERY_INFO WHERE MATCH_NO = #{hawbNo})
		   </if>
		   <if test='startDate != null and startDate !=""'>
		   	AND F3.DEP_DATE <![CDATA[ >= ]]> #{startDate}
		   </if>
		   <if test='endDate != null and endDate !=""'>
		   	AND F3.DEP_DATE <![CDATA[ <= ]]> #{endDate}
		   </if>
		   <if test='orderNo != null and orderNo != ""'>
		   	AND F2.ORDER_NO = #{orderNo}
			</if>
			<if test='transCode != null and transCode != ""'>
			AND F1.TRANS_CODE = #{transCode}
			</if>
	</select>	
		
	<select id ="selectUnSendList" parameterType="com.example.temp.manager.vo.SendVO" resultType="com.example.temp.manager.vo.SendVO">
		SELECT A.* FROM (
		SELECT 
			ROW_NUMBER() OVER(ORDER BY F1.HAWB_NO DESC) AS ROWNUM, 
			ISNULL(UPPER(F1.USER_ID),'') USER_ID ,
	        ISNULL(F1.HAWB_NO,'') HAWB_NO ,
	        ISNULL(F1.MAWB_NO,'') MAWB_NO ,
	        ISNULL(F2.ORDER_NO,'') ORDER_NO ,
	        ISNULL(F2.ORDER_DATE,'') AS ORDER_DATE,
	        ISNULL(F2.CNEE_NAME,'') CNEE_NAME,
	        ISNULL(F2.CNEE_TEL,'') CNEE_TEL,
	        ISNULL(F2.CNEE_ADDR,'') CNEE_ADDR,
	        ISNULL(F2.CNEE_ADDR_DETAIL,'') CNEE_ADDR_DETAIL,
			ISNULL(F2.CNEE_ZIP,'') CNEE_ZIP ,
	      	ISNULL((SELECT TOP 1 A2.ITEM_DETAIL
	           FROM TB_HAWB_ITEM A1 ,
	                TB_ORDER_ITEM A2
	          WHERE A1.NNO = A2.NNO
	            AND A1.SUB_NO = A2.SUB_NO
	            AND A1.NNO = F1.NNO
	          ORDER BY A2.UNIT_VALUE * A1.ITEM_CNT  DESC),'') MAIN_ITEM,
	        ISNULL((SELECT SUM(A1.ITEM_CNT * A2.UNIT_VALUE)
	           FROM TB_HAWB_ITEM A1 ,
	                TB_ORDER_ITEM A2
	          WHERE A1.NNO = A2.NNO
	            AND A1.SUB_NO = A2.SUB_NO
	            AND A1.NNO = F1.NNO),'') TOTAL_VALUE,
	        ISNULL(F1.WTA,'') WTA,
	        ISNULL(F1.WTC,'') WTC,
	        ISNULL(F1.BOX_CNT,'') BOX_CNT
	   FROM TB_HAWB F1 LEFT OUTER JOIN 
	        TB_ORDER_LIST F2 ON F1.NNO = F2.NNO 
	   WHERE 
	   			ISNULL(F1.MAWB_NO,'') = ''
	   <if test='mawbNo != null and mawbNo != ""'>
	   			AND F1.MAWB_NO = #{mawbNo}
	   </if>
	   <if test='userId != null and userId != ""'>
	   			AND F1.USER_ID LIKE '%'+#{userId}+'%'
	   </if>
	   <if test='hawbNo != null and hawbNo != ""'>
	   			AND (ISNULL(F1.HAWB_NO,'') = #{hawbNo}
		   				 OR F1.HAWB_NO = (SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO = #{hawbNo}))
	   </if>
	   <if test='startDate != null and startDate !=""'>
	   			<![CDATA[AND F1.W_DATE > #{startDate}]]>
	   </if>
	   <if test='endDate != null and endDate !=""'>
	   			<![CDATA[AND F1.W_DATE < DATEADD(DAY,+1,#{endDate})]]>
	   </if>
     	AND F1.ORG_STATION = #{orgStation} ) A
     	<where>
     		<if test='paging.boardStart !=null and paging.boardStart !="" and paging.boardEnd != null and paging.boardEnd !=""'>
				A.ROWNUM BETWEEN #{paging.boardStart} and #{paging.boardEnd}
			</if>
     	</where>
	</select>
	
	<select id ="selectUnSendListCount" parameterType="com.example.temp.manager.vo.SendVO" resultType="Integer">
		SELECT COUNT(*)
		   FROM TB_HAWB F1 LEFT OUTER JOIN
		        TB_ORDER_LIST F2 ON F1.NNO = F2.NNO
		   WHERE 
		   			ISNULL(F1.MAWB_NO,'') = ''
		   <if test='mawbNo != null and mawbNo != ""'>
		   			AND F1.MAWB_NO = #{mawbNo}
		   </if>
		   <if test='userId != null and userId != ""'>
		   			AND F1.USER_ID LIKE '%'+#{userId}+'%'
		   </if>
		   <if test='hawbNo != null and hawbNo != ""'>
		   			AND (ISNULL(F1.HAWB_NO,'') = #{hawbNo}
		   				 OR F1.HAWB_NO = (SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO = #{hawbNo}))
		   </if>
		   <if test='startDate != null and startDate !=""'>
		   			<![CDATA[AND F1.W_DATE > #{startDate}]]>
		   </if>
		   <if test='endDate != null and endDate !=""'>
		   			<![CDATA[AND F1.W_DATE < DATEADD(DAY,+1,#{endDate})]]>
		   </if>
	     	AND F1.ORG_STATION = #{orgStation};
	</select>	
	
	<!-- <select id ="selectSendListCount" parameterType="com.example.temp.manager.vo.SendVO" resultType="Integer">
		SELECT COUNT(*)
		   FROM TB_HAWB F1  ,
		        TB_ORDER_LIST F2
		   WHERE F1.NNO = F2.NNO
		   			AND ISNULL(F1.MAWB_NO,'') != ''
		   <if test='mawbNo != null and mawbNo != ""'>
		   			AND F1.MAWB_NO = #{mawbNo}
		   </if>
		   <if test='userId != null and userId != ""'>
		   			AND F1.USER_ID LIKE '%'+#{userId}+'%'
		   </if>
		   <if test='hawbNo != null and hawbNo != ""'>
		   			AND ISNULL(F1.HAWB_NO,'') = #{hawbNo}
		   </if>
		   <if test='startDate != null and startDate !=""'>
		   			<![CDATA[AND F2.ORDER_DATE > #{startDate}]]>
		   </if>
		   <if test='endDate != null and endDate !=""'>
		   			<![CDATA[AND F2.ORDER_DATE < #{endDate}]]>
		   </if>
	     	AND F1.ORG_STATION = #{orgStation};
	</select>	
	
	<select id ="selectUnSendListCount" parameterType="com.example.temp.manager.vo.SendVO" resultType="Integer">
		SELECT COUNT(*)
		   FROM TB_HAWB F1  ,
		        TB_ORDER_LIST F2
		   WHERE F1.NNO = F2.NNO
		   			AND ISNULL(F1.MAWB_NO,'') = ''
		   <if test='mawbNo != null and mawbNo != ""'>
		   			AND F1.MAWB_NO = #{mawbNo}
		   </if>
		   <if test='userId != null and userId != ""'>
		   			AND F1.USER_ID LIKE '%'+#{userId}+'%'
		   </if>
		   <if test='hawbNo != null and hawbNo != ""'>
		   			AND ISNULL(F1.HAWB_NO,'') = #{hawbNo}
		   </if>
		   <if test='startDate != null and startDate !=""'>
		   			<![CDATA[AND F2.ORDER_DATE > #{startDate}]]>
		   </if>
		   <if test='endDate != null and endDate !=""'>
		   			<![CDATA[AND F2.ORDER_DATE < #{endDate}]]>
		   </if>
	     	AND F1.ORG_STATION = #{orgStation};
	</select>	 -->
	
	<select id="selectStockResultVO" parameterType="String" resultType="com.example.temp.manager.vo.StockResultVO">
		select 
			ISNULL(F1.STOCK_NO,'') AS STOCK_NO,
			ISNULL(F1.STOCK_TYEP,'') AS STOCK_TYEP,
			ISNULL(F1.ORG_STATION,'') AS ORG_STATION,
			ISNULL(F1.USER_ID,'') AS USER_ID,
			ISNULL(F1.RACK_CODE,'') AS RACK_CODE,
			ISNULL(F1.NNO,'') AS NNO,
			ISNULL(F1.SUB_NO,'') AS SUB_NO,
			ISNULL(F1.TAKE_IN_CODE,'') AS TAKE_IN_CODE,
			ISNULL(F1.WH_IN_DATE,'') AS WH_IN_DATE,
			ISNULL(F1.WH_STATUS,'') AS WH_STATUS,
			ISNULL(F1.WTA,'') AS WTA,
			ISNULL(F1.WIDTH,'') AS WIDTH,
			ISNULL(F1.HEIGHT,'') AS HEIGHT,
			ISNULL(F1.LENGTH,'') AS LENGTH,
			ISNULL(F1.PER,'') AS PER,
			ISNULL(F1.WTC,'') AS WTC,
			ISNULL(F1.WT_UNIT,'') AS WT_UNIT,
			ISNULL(F1.DIM_UNIT,'') AS DIM_UNIT,
			ISNULL(F1.OUT_NNO,'') AS OUT_NNO,
			ISNULL(F1.TRK_COM,'') AS TRK_COM,
			ISNULL(F1.TRK_NO,'') AS TRK_NO,
			ISNULL(F1.W_USER_ID,'') AS W_USER_ID,
			ISNULL(F1.W_USER_IP,'') AS W_USER_IP,
			ISNULL(F1.W_DATE,'') AS W_DATE,
			ISNULL(F1.GROUP_IDX,'') AS GROUP_IDX,
			ISNULL(F1.CUS_ITEM_CODE,'') AS CUS_ITEM_CODE,
			<choose>
				<when test='nno != null and nno != ""'>
					ISNULL((SELECT ITEM_DETAIL FROM TB_ORDER_ITEM WHERE NNO = #{nno} AND SUB_NO = F1.SUB_NO),'') AS ITEM_DETAIL,
					ISNULL((SELECT BRAND FROM TB_ORDER_ITEM WHERE NNO = #{nno} AND SUB_NO = F1.SUB_NO),'') AS BRAND,
					ISNULL((SELECT CNEE_NAME FROM TB_ORDER_LIST WHERE NNO = #{nno}),'') AS CNEE_NAME
				</when>
				<otherwise>
					'' AS ITEM_DETAIL,
					'' AS BRAND,
					'' AS CNEE_NAME
				</otherwise>			
			</choose>
		FROM TB_STOCK F1 WHERE GROUP_IDX = #{groupIdx}; 
	</select>
	
	<select id="selectStockResultStockVO" parameterType="String" resultType="com.example.temp.manager.vo.StockResultVO">
		select 
			ISNULL(F1.STOCK_NO,'') AS STOCK_NO,
			ISNULL(F1.STOCK_TYEP,'') AS STOCK_TYEP,
			ISNULL(F1.ORG_STATION,'') AS ORG_STATION,
			ISNULL(F1.USER_ID,'') AS USER_ID,
			ISNULL(F1.RACK_CODE,'') AS RACK_CODE,
			ISNULL(F1.NNO,'') AS NNO,
			ISNULL(F1.SUB_NO,'') AS SUB_NO,
			ISNULL(F1.TAKE_IN_CODE,'') AS TAKE_IN_CODE,
			ISNULL(F1.WH_IN_DATE,'') AS WH_IN_DATE,
			ISNULL(F1.WH_STATUS,'') AS WH_STATUS,
			ISNULL(F1.WTA,'') AS WTA,
			ISNULL(F1.WIDTH,'') AS WIDTH,
			ISNULL(F1.HEIGHT,'') AS HEIGHT,
			ISNULL(F1.LENGTH,'') AS LENGTH,
			ISNULL(F1.PER,'') AS PER,
			ISNULL(F1.WTC,'') AS WTC,
			ISNULL(F1.WT_UNIT,'') AS WT_UNIT,
			ISNULL(F1.DIM_UNIT,'') AS DIM_UNIT,
			ISNULL(F1.OUT_NNO,'') AS OUT_NNO,
			ISNULL(F1.TRK_COM,'') AS TRK_COM,
			ISNULL(F1.TRK_NO,'') AS TRK_NO,
			ISNULL(F1.W_USER_ID,'') AS W_USER_ID,
			ISNULL(F1.W_USER_IP,'') AS W_USER_IP,
			ISNULL(F1.W_DATE,'') AS W_DATE,
			ISNULL(F1.GROUP_IDX,'') AS GROUP_IDX,
			ISNULL(F1.CUS_ITEM_CODE,'') AS CUS_ITEM_CODE,
			ISNULL((select item_Detail from tb_order_item where nno=F1.NNO AND SUB_NO = F1.SUB_NO),'') AS ITEM_DETAIL,
			ISNULL((select BRAND from tb_order_item where nno=F1.NNO AND SUB_NO = F1.SUB_NO),'') AS BRAND,
			ISNULL((select CNEE_NAME from tb_order_LIST where nno=F1.NNO),'') AS CNEE_NAME
		FROM TB_STOCK F1 WHERE STOCK_NO = #{stockNo}; 
	</select>
	
	<insert id="insertTmpExcelVolume" parameterType="com.example.temp.manager.vo.OrderWeightVO">
		INSERT INTO 
			TMP_EXCEL_VOLUME 
		( 
			ORG_STATION, 
			HAWB_NO, 
			WTA, 
			WIDTH, 
			HEIGHT, 
			[LENGTH], 
			PER, 
			WTC, 
			DIM_UNIT, 
			WT_UNIT, 
			W_USER_ID, 
			W_USER_IP
		) VALUES (  
		#{orgStation}, 
		#{hawbNo}, 
		#{wta}, 
		#{width}, 
		#{height}, 
		#{length}, 
		#{per}, 
		#{wtc}, 
		#{dimUnit},
		#{wtUnit},
		#{wUserId}, 
		#{wUserIp}
	);
	
	</insert>
	
	<select id="selectPerDimByHawbNo" parameterType="String" resultType="Integer">
		SELECT CONVERT(NUMERIC(18,0), PER_DIM) FROM TB_TRANS_COM 
		WHERE TRANS_CODE = ISNULL((SELECT TRANS_CODE FROM TB_ORDER_LIST WHERE HAWB_NO = #{hawbNo}),'ACI')
	</select>
	
	<select id="selectOrderWeightExcel" parameterType="String" resultType="com.example.temp.manager.vo.OrderWeightVO">
		SELECT 
			ISNULL((SELECT NNO FROM TB_ORDER_LIST WHERE HAWB_NO = F1.HAWB_NO),'') AS NNO,
			ISNULL(ORG_STATION,'') ORG_STATION ,
			ISNULL(HAWB_NO,'') HAWB_NO ,
			ISNULL((SELECT USER_ID FROM TB_ORDER_LIST WHERE HAWB_NO = F1.HAWB_NO),'') AS USER_ID,
			ISNULL(WTA ,0) WTA , 
			ISNULL(WTC ,0) WTC,
			ISNULL(LENGTH, 0) LENGTH,
			ISNULL(WIDTH, 0) WIDTH ,
			ISNULL(HEIGHT, 0) HEIGHT , 
			CASE WHEN (SELECT COUNT(*) FROM TB_ORDER_LIST WHERE HAWB_NO = F1.HAWB_NO) = 0 THEN 'Y' ELSE 'N' END ERROR_YN,
			CASE WHEN (SELECT COUNT(*) FROM TB_ORDER_LIST WHERE HAWB_NO = F1.HAWB_NO) = 0 THEN '등록되지 않은 운송장 번호' ELSE '' END ERROR_MSG
		FROM TMP_EXCEL_VOLUME F1
			WHERE ORG_STATION = #{orgStation}
	</select>
	
	<select id ="execOrderWeightList" parameterType="hashMap" resultType="com.example.temp.manager.vo.ProcedureVO" statementType="CALLABLE">
		DECLARE
			@HAWB_NO NVARCHAR(50),
			@ORG_STATION NVARCHAR(3),
			@W_USER_ID NVARCHAR(50),
			@W_USER_IP NVARCHAR(50),
			@RST_STATUS NVARCHAR(10)  ,
			@RST_CODE NVARCHAR(10)  ,
			@RST_MSG NVARCHAR(100)  ,
			@RST_HAWB_NO NVARCHAR(50)  
		
		
		SET @HAWB_NO = (SELECT HAWB_NO FROM TB_ORDER_LIST WHERE NNO = #{nno})
		SET @ORG_STATION = #{orgStation}
		SET @W_USER_ID  = #{wUserId}
		SET @W_USER_IP = #{wUserIp}
		
		EXEC SP_HAWB_EXCEL_VOLUME_IN 
			@HAWB_NO ,
			@ORG_STATION,
			@W_USER_ID,
			@W_USER_IP,
			@RST_STATUS  OUTPUT ,
			@RST_CODE  OUTPUT ,
			@RST_MSG  OUTPUT ,
			@RST_HAWB_NO OUTPUT 
		
		SELECT 
			@RST_STATUS AS RST_STATUS ,
			@RST_CODE AS RST_CODE,
			@RST_MSG AS RST_MSG,
			@RST_HAWB_NO AS RST_HAWB_NO;
	</select>
	
	<delete id="delOrderWeightList" parameterType="hashMap">
		DELETE FROM TMP_EXCEL_VOLUME WHERE ORG_STATION =#{orgStation}
			AND HAWB_NO = (SELECT HAWB_NO FROM TB_ORDER_LIST WHERE NNO = #{hawbNo})
	</delete>
	
	<select id="selectUserDstnNationInfo" parameterType="String" resultType="com.example.temp.manager.vo.NationVO">
		SELECT NATION_CODE, NATION_NAME FROM TB_NATION_CODE	WHERE NATION_CODE IN (
			SELECT DISTINCT(DSTN_NATION) FROM TB_TRANS_ZONE WHERE ORG_NATION = (
                SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = #{orgStation}
                )
			);
	</select>
	
	<select id="selectStockByNo" parameterType="String" resultType="com.example.temp.manager.vo.StockVO">
		SELECT * FROM TB_STOCK WHERE STOCK_NO = #{stockNo} AND NNO = #{nno} 
		<if test='alreadyInfo != null and alreadyInfo != ""'>
			AND STOCK_NO NOT IN (${alreadyInfo})
		</if>
	</select>
	
	<select id="selectChkCntStock" parameterType="String" resultType="String">
		SELECT CASE WHEN 
		(
			(
                SELECT COUNT(*)
                	FROM TB_STOCK
                	WHERE NNO = #{nno} AND STOCK_TYEP = 'INSP_IN'
            ) = 
            (
            	SELECT
                	SUM(ITEM_CNT)
            	FROM TB_ORDER_ITEM
            	WHERE NNO = #{nno}
			)
		) THEN 'OK'
        ELSE 'FAIL'
	END AS RESULT
	</select>
	<select id="selectTotalCountStock" parameterType="hashMap" resultType="integer">
		SELECT COUNT(DISTINCT(nno)) FROM TB_STOCK WHERE ORG_STATION = (SELECT ORG_STATION FROM TB_ADMIN WHERE ADMIN_ID = #{wUserId})
		<if test='trkNo != null and trkNo !=""'>
			AND NNO IN (SELECT NNO FROM TB_ORDER_LIST WHERE HAWB_NO = #{trkNo})
		</if>
		<if test='itemDetail != null and itemDetail != ""'>
			AND NNO IN (SELECT NNO FROM TB_ORDER_ITEM WHERE ITEM_DETAIL like '%'+#{itemDetail}+'%')
		</if>
		<if test='cneeZip != null and cneeZip != ""'>
			AND NNO IN (SELECT NNO FROM TB_ORDER_LIST WHERE CNEE_ZIP = #{cneeZip})
		</if>		
	</select>
	<select id ="selectStockYnByNNO" parameterType="String" resultType="Integer">
		SELECT COUNT(NNO) FROM TB_STOCK WHERE NNO = #{nno}
	</select>
	<select id="execSpWhoutStock" parameterType="hashMap" resultType="com.example.temp.manager.vo.ProcedureVO" statementType="CALLABLE">
		DECLARE
			@NNO NVARCHAR(50),
			@ORG_STATION NVARCHAR(3),
			@STOCK_NO NVARCHAR(50),
			@W_USER_ID NVARCHAR(50),
			@W_USER_IP NVARCHAR(50),
			@RST_NNO NVARCHAR(50) ,
			@RST_STATUS NVARCHAR(50) ,
			@RST_CODE NVARCHAR(10) ,
			@RST_MSG NVARCHAR(50) 
			
		SET @NNO = 	<choose>
						<when test='nno !=null and nno != ""'>
							#{nno}
						</when>
						<otherwise>
							''
						</otherwise>
					</choose>
		SET @ORG_STATION = #{orgStation}
		SET @STOCK_NO = #{stockNo}
		SET @W_USER_ID = #{wUserId}
		SET @W_USER_IP = #{wUserIp}
			
		EXEC SP_WHOUT_STOCK
			@ORG_STATION,
			@STOCK_NO,
			@W_USER_ID,
			@W_USER_IP,
			@RST_NNO OUTPUT,
			@RST_STATUS OUTPUT,
			@RST_CODE OUTPUT,
			@RST_MSG OUTPUT
			
			
		SELECT 
		ISNULL(@RST_NNO,'') AS RST_NNO,
		ISNULL(@RST_STATUS,'')  AS RST_STATUS,
		ISNULL(@RST_CODE,'') AS RST_CODE,
		ISNULL(@RST_MSG,'') AS RST_MSG;
	</select>
	
	<select id="selectStockOutTarget" parameterType="hashMap" resultType="com.example.temp.manager.vo.insp.InspStockOutVO">
		SELECT NNO , 
		SUB_NO,
		ITEM_DETAIL ,
		ITEM_CNT ,
		(SELECT COUNT(*) FROM TMP_WHOUT_STOCK WHERE  NNO = F1.NNO AND SUB_NO = F1.SUB_NO AND W_USER_ID = #{wUserId} AND ORG_STATION = #{orgStation}) WHOUT_CNT
		FROM TB_ORDER_ITEM F1
		WHERE NNO IN (SELECT OUT_NNO FROM TMP_WHOUT_STOCK WHERE W_USER_ID = #{wUserId} AND ORG_STATION = #{orgStation});
	</select>
	
	<select id="selectTargetSubNo" parameterType="String" resultType="String">
		SELECT SUB_NO FROM TB_STOCK WHERE STOCK_NO = #{stockNo}
	</select>
	<delete id="deleteStockOut" parameterType="hashMap">
		DELETE FROM TMP_WHOUT_STOCK WHERE W_USER_ID = #{wUserId} AND ORG_STATION = #{orgStation}
	</delete>
	<select id="execStockHawbIn" parameterType="hashMap" resultType="com.example.temp.manager.vo.ProcedureVO" statementType="CALLABLE">
		DECLARE
			@ORG_STATION NVARCHAR(3),
			@WTA FLOAT ,
			@W_USER_ID  NVARCHAR(50) ,
			@W_USER_IP  NVARCHAR(50) ,
			@RST_STATUS NVARCHAR(10) ,
			@RST_CODE NVARCHAR(10) ,
			@RST_MSG NVARCHAR(200) ,
			@OUT_NNO NVARCHAR(50)
			    
			    
		SET @ORG_STATION = #{orgStation}
		SET @WTA = #{wta}
		SET @W_USER_ID = #{wUserId}
		SET @W_USER_IP = #{wUserIp}
			
			EXEC SP_STOCK_HAWB_IN
			@ORG_STATION,
			@WTA  ,
			@W_USER_ID  ,
			@W_USER_IP  ,
			@RST_STATUS OUTPUT,
			@RST_CODE OUTPUT,
			@RST_MSG OUTPUT,
			@OUT_NNO OUTPUT
			
			
			SELECT 
			@RST_STATUS  AS RST_STATUS,
			@RST_CODE AS RST_CODE,
			@RST_MSG AS RST_MSG,
			@OUT_NNO AS OUT_NNO
			
	</select>
	
	<select id = "selectUserTransComByNno" parameterType="String" resultType="String">
		SELECT TRANS_CODE FROM TB_ORDER_LIST WHERE NNO = #{nno}
	</select>
	
	<select id="selectOrderListAramex" parameterType="String" resultType="com.example.temp.api.aci.vo.ApiOrderListVO">
		SELECT 
			ISNULL((SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE=ORG_STATION),'') AS SHIPPER_CNTRY,
			ISNULL(DSTN_NATION,'') AS CNEE_CNTRY,
			ISNULL(NNO,'') AS NNO,
			ISNULL(HAWB_NO,'') AS HAWB_NO,
			ISNULL(BOX_CNT,'') AS BOX_CNT,
			ISNULL(SHIPPER_ADDR,'') AS SHIPPER_ADDR,
			ISNULL(SHIPPER_ADDR_DETAIL,'') AS SHIPPER_ADDR_DETAIL,
			ISNULL(SHIPPER_CITY,'') AS SHIPPER_CITY,
			ISNULL(SHIPPER_ZIP,'') AS SHIPPER_ZIP,
			ISNULL(SHIPPER_CNTRY,'') AS SHIPPER_CNTRY,
			ISNULL(SHIPPER_TEL,'') AS SHIPPER_TEL,
			ISNULL(SHIPPER_HP,SHIPPER_TEL) AS SHIPPER_HP,
			ISNULL(USER_EMAIL,'') AS SHIPPER_EMAIL,
			ISNULL(CNEE_ADDR,'') AS CNEE_ADDR,
			ISNULL(CNEE_ADDR_DETAIL,'') AS CNEE_ADDR_DETAIL,
			ISNULL(CNEE_CITY,'') AS CNEE_CITY,
			ISNULL(CNEE_ZIP,'') AS CNEE_ZIP,
			ISNULL(CNEE_NAME,'') AS CNEE_NAME,
			ISNULL(CNEE_HP,'') AS CNEE_HP,
			ISNULL(CNEE_TEL,'') AS CNEE_TEL,
			ISNULL(CNEE_EMAIL,'') AS CNEE_EMAIL,
			ISNULL(ORDER_DATE,'') AS ORDER_DATE,
			ISNULL(W_DATE,'') AS W_DATE,
			ISNULL(USER_LENGTH,'') AS USER_LENGTH,
			ISNULL(USER_WIDTH,'') AS USER_WIDTH,
			ISNULL(USER_HEIGHT,'') AS USER_HEIGHT,
			ISNULL(DIM_UNIT,'') AS DIM_UNIT,
			ISNULL((SELECT WTA FROM TB_HAWB WHERE NNO=#{nno}),'') AS USER_WTA,
			ISNULL(WT_UNIT,'') AS WT_UNIT,
			ISNULL(SHIPPER_REFERENCE,'') AS SHIPPER_REFERENCE,
			ISNULL(CNEE_REFERENCE1,'') AS CNEE_REFERENCE1,
			ISNULL(CNEE_REFERENCE2,'') AS CNEE_REFERENCE2,
			ISNULL(PAYMENT,'') AS PAYMENT
		FROM TB_ORDER_LIST WHERE NNO = #{nno}
	</select>
	
	<select id="selectOrderItemAramex" parameterType="String" resultType="com.example.temp.api.aci.vo.ApiOrderItemListVO">
		SELECT * FROM TB_ORDER_ITEM WHERE NNO IN (SELECT ORG_NNO FROM TB_HAWB_ITEM WHERE NNO = #{nno}) AND SUB_NO IN (SELECT ORG_SUB_NO FROM TB_HAWB_ITEM WHERE NNO = #{nno})
	</select>
	
	<select id="selectOrderListAramexMember" parameterType="String" resultType="com.example.temp.api.aci.vo.ApiOrderListVO">
		SELECT 
			ISNULL((SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE=ORG_STATION),'') AS SHIPPER_CNTRY,
			ISNULL(DSTN_NATION,'') AS CNEE_CNTRY,
			ISNULL(NNO,'') AS NNO,
			ISNULL(USER_ID,'') AS USER_ID,
			ISNULL(SHIPPER_NAME, '') AS SHIPPER_NAME,
			ISNULL(SHIPPER_ADDR,'') AS SHIPPER_ADDR,
			ISNULL(SHIPPER_ADDR_DETAIL,'') AS SHIPPER_ADDR_DETAIL,
			ISNULL(SHIPPER_CITY,'') AS SHIPPER_CITY,
			ISNULL(SHIPPER_ZIP,'') AS SHIPPER_ZIP,
			ISNULL(SHIPPER_TEL,'') AS SHIPPER_TEL,
			ISNULL(SHIPPER_TEL,'') AS SHIPPER_HP,
			ISNULL(USER_EMAIL,'') AS SHIPPER_EMAIL,
			ISNULL(CNEE_ADDR,'') AS CNEE_ADDR,
			ISNULL(CNEE_ADDR_DETAIL,'') AS CNEE_ADDR_DETAIL,
			ISNULL(CNEE_CITY,'') AS CNEE_CITY,
			ISNULL(CNEE_ZIP,'') AS CNEE_ZIP,
			ISNULL(CNEE_NAME,'') AS CNEE_NAME,
			ISNULL(CNEE_HP,'') AS CNEE_HP,
			ISNULL(CNEE_TEL,'') AS CNEE_TEL,
			ISNULL(CNEE_EMAIL,'') AS CNEE_EMAIL,
			ISNULL(ORDER_DATE,'') AS ORDER_DATE,
			ISNULL(ORDER_NO,'') AS ORDER_NO,
			ISNULL(W_DATE,'') AS W_DATE,
			ISNULL(USER_LENGTH,'0') AS USER_LENGTH,
			ISNULL(USER_WIDTH,'0') AS USER_WIDTH,
			ISNULL(USER_HEIGHT,'0') AS USER_HEIGHT,
			ISNULL(DIM_UNIT,'CM') AS DIM_UNIT,
			ISNULL(USER_WTA, '') AS USER_WTA,
			ISNULL(WT_UNIT,'') AS WT_UNIT,
			ISNULL(BOX_CNT,'1') AS BOX_CNT,
			ISNULL(SHIPPER_REFERENCE,'') AS SHIPPER_REFERENCE,
			ISNULL(CNEE_REFERENCE1,'') AS CNEE_REFERENCE1,
			ISNULL(CNEE_REFERENCE2,'') AS CNEE_REFERENCE2,
			ISNULL(PAYMENT,'') AS PAYMENT
		FROM TB_ORDER_LIST WHERE NNO = #{nno}
	</select>
	
	<select id="selectOrderItemAramexMember" parameterType="String" resultType="com.example.temp.api.aci.vo.ApiOrderItemListVO">
		SELECT * FROM TB_ORDER_ITEM WHERE NNO = #{nno}
	</select>
	
	<select id="selectHawbNnoCheck" parameterType="String" resultType="String">
		SELECT HAWB_NO FROM TB_HAWB WHERE NNO = #{nno}
	</select>
	
	<!-- <update id ="updateHawbNoInTbOrderList" parameterType="String">
		UPDATE TB_ORDER_LIST SET HAWB_NO = #{hawbNo} WHERE NNO = #{nno}
	</update> -->
	
	<delete id="deleteInspcStockOutCzFail" parameterType="String">
		UPDATE TB_STOCK WHERE OUT_NNO = '' WHERE OUT_NNO = #{nno}
		
		DELETE FROM TB_HAWB WHERE NNO = #{nno}
		DELETE FROM TB_HAWB_ITEM WHERE NNO = #{nno}
		
		DELETE FROM TB_ORDER_LIST WHERE NNO = #{nno}
		DELETE FROM TB_ORDER_ITEM WHERE NNO = #{nno}
	</delete>
	
	<select id ="selectStockByNo2" parameterType="String" resultType="com.example.temp.manager.vo.StockVO">
		SELECT * FROM TB_STOCK WHERE STOCK_NO = #{stockNo}
	</select>
	
	<select id="execAddBlApply" parameterType="String" resultType="com.example.temp.manager.vo.ProcedureVO" statementType="CALLABLE">
		DECLARE 
			@NNO NVARCHAR(50),
			@W_USER_ID NVARCHAR(50),
			@W_USER_IP NVARCHAR(50),
			@RST_STATUS NVARCHAR(50),
			@RST_CODE NVARCHAR(50),
			@RST_MSG NVARCHAR(100),
			@RST_NNO NVARCHAR(100),
			@RST_HAWB_NO NVARCHAR(100)
			
			
		SET @NNO = #{nno}
		SET @W_USER_ID = #{userId}
		SET @W_USER_IP = #{userIp}
			
		EXEC SP_TRANS_ADD_BL_APPLY
			@NNO ,
			@W_USER_ID,
			@W_USER_IP ,
			@RST_STATUS ,
			@RST_CODE OUTPUT,
			@RST_MSG OUTPUT,
			@RST_NNO OUTPUT,
			@RST_HAWB_NO OUTPUT
		
		SELECT 
			ISNULL(@RST_STATUS,'')  AS RST_STATUS,
			ISNULL(@RST_CODE,'') AS RST_CODE,
			ISNULL(@RST_MSG,'') AS RST_MSG,
			ISNULL(@NNO,'') RST_NNO,
			@RST_HAWB_NO AS RST_HAWB_NO
	</select>
	
	<select id="selectStockMaxNo" resultType="String">
		SELECT CONCAT('INSP_IN','_',NEXT VALUE FOR SEQ_STOCK_NO) AS STOCK_NO
	</select>
	
	<select id="selectGroupIdx" resultType="String">
		SELECT CONCAT(CONVERT(VARCHAR(10), GETDATE(),112),'_',RIGHT(NEXT VALUE FOR SEQ_GROUP_IDX,5)) AS GROUP_IDX
	</select>
	
	<insert id="insertStockUnRgt" parameterType="hashMap">
		insert into
		    TB_STOCK (
		        STOCK_NO,
		        STOCK_TYEP,
		        ORG_STATION,
		        <if test='userId != null and userId !=""'>
		        	[USER_ID],
		        </if>
		        RACK_CODE,
		        NNO,
		        SUB_NO,
		        TAKE_IN_CODE,
		        WH_IN_DATE,
		        WH_STATUS,
		        WTA,
		        WIDTH,
		        HEIGHT,
		        [LENGTH],
		        PER,
		        WTC,
		        WT_UNIT,
		        DIM_UNIT,
		        OUT_NNO,
		        TRK_COM,
		        TRK_NO,
		        W_USER_ID,
		        W_USER_IP,
		        W_DATE,
		        GROUP_IDX,
		        CUS_ITEM_CODE
		    )
		values
		    (
		        #{stockNo},
		        'INSP_IN',
		        #{orgStation},
		        <if test='userId != null and userId !=""'>
		        	#{userId},
		        </if>
		        #{rackNo},
		        '',
		        #{subNo},
		        '',
		        #{whInDate},
		        'UG',
		        '',
		        '',
		        '',
		        '',
		        '',
		        '',
		        '',
		        '',
		        '',
		        '',
		        #{trkNo},
		        #{wUserId},
		        #{wUserIp},
		        GETDATE(),
		        #{groupIdx},
		        ''
		    );
	</insert>
	
	<select id = "selectTransCodeForAdmin" parameterType="String" resultType="String">
		SELECT DISTINCT(TRANS_CODE) 
			FROM TB_TRANS_ZONE 
			WHERE ORG_NATION =	(SELECT NATION_CODE 
									FROM TB_STATION 
									WHERE STATION_CODE = (SELECT ORG_STATION 
															FROM TB_ADMIN 
															WHERE ADMIN_ID = #{adminId}));
	</select>
	<select id="selectInnerProductList" parameterType="hashMap" resultType="com.example.temp.manager.vo.insp.InnerProductVO">
		DECLARE 
			@MAWB_NO NVARCHAR(50),
			@W_USER_ID  NVARCHAR(50),
			@W_USER_IP NVARCHAR(50)
			
			SET @W_USER_ID = #{userId}
			SET @W_USER_IP = #{userIp}
			SET @MAWB_NO = #{mawbNo}
			
		INSERT INTO TB_CARRY_IN(CARRY_IN_NUM,HAWB_NO,NNO,ORG_STATION,USER_ID,W_USER_ID,W_USER_IP,W_DATE)
		SELECT NEXT VALUE FOR SEQ_CARRY_IN NUM, 
		       HAWB_NO , 
		       NNO , 
		       ORG_STATION , 
		       USER_ID , 
		       @W_USER_ID ,
		       @W_USER_IP , 
		       GETDATE()
		  FROM TB_HAWB F1 
		  WHERE HAWB_NO NOT IN (SELECT HAWB_NO FROM TB_CARRY_IN WHERE HAWB_NO = F1.HAWB_NO AND USER_ID = F1.USER_ID AND ORG_STATION = F1.ORG_STATION)
		    AND MAWB_NO = @MAWB_NO;
			  
		  SELECT (SELECT CARRY_IN_NUM FROM TB_CARRY_IN WHERE HAWB_NO = F1.HAWB_NO AND USER_ID = F1.USER_ID AND ORG_STATION = F1.ORG_STATION) CARRY_IN_NUM, 
		         SUBSTRING(STUFF((SELECT  CAST(',' AS VARCHAR(MAX))+ A2.ITEM_DETAIL 
		                           FROM TB_HAWB_ITEM A1 , 
		                                 TB_ORDER_ITEM A2
		                           WHERE ISNULL(A1.ORG_NNO,A1.NNO)=A2.NNO 
		                             AND ISNULL(A1.ORG_SUB_NO,A1.SUB_NO)=A2.SUB_NO AND A1.NNO = F1.NNO FOR XML PATH('')), 1, 1, ''),1,200) AS ITEM_DETAIL ,
		            CASE WHEN ISNULL((SELECT MAX(QTY_UNIT) FROM TB_ORDER_ITEM WHERE NNO IN (SELECT ISNULL(ORG_NNO,NNO) FROM TB_HAWB_ITEM WHERE NNO = F1.NNO)),'') = '' THEN 'EA'
		            ELSE (SELECT MAX(QTY_UNIT) FROM TB_ORDER_ITEM WHERE NNO IN (SELECT ISNULL(ORG_NNO,NNO) FROM TB_HAWB_ITEM WHERE NNO = F1.NNO)) END QTY_UNIT ,
					(SELECT SUM(ITEM_CNT) FROM TB_HAWB_ITEM WHERE NNO = F1.NNO) AS ITEM_CNT,
					WTA,
					WTC,
					format(ISNULL((SELECT top 1 W_DATE FROM TB_STOCK WHERE NNO = F1.NNO), W_DATE),'yyyyMMdd') AS IN_DATE,
					(SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = @MAWB_NO) AS END_DATE
		  FROM TB_HAWB F1
		  WHERE MAWB_NO = @MAWB_NO AND HAWB_NO IN (SELECT HAWB_NO FROM TB_CARRY_IN WHERE USER_ID = F1.USER_ID AND ORG_STATION = F1.ORG_STATION AND SEND_YN = 'N');
	</select>
	<update id="updateInvUserInfo" parameterType="com.example.temp.common.vo.InvUserInfoVO">
		UPDATE TB_CUSTOMER_INV_INFO SET
		        INV_USER_NAME = #{invUserName},
		        INV_USER_TEL = #{invUserTel},
		        INV_USER_EMAIL = #{invUserEmail},
		        INV_COM_NAME = #{invComName},
		        INV_COM_TEL = #{invComTel},
		        INV_COM_ADDR = #{invComAddr},
		        INV_COM_ADDR_DETAIL = #{invComAddrDetail}
	        WHERE INV_USER_ID = #{invUserId}
	</update>
	
	<update id='updateInnerProductList' parameterType='hashMap'>
		UPDATE TB_CARRY_IN SET SEND_YN = 'Y' WHERE HAWB_NO IN (
		    SELECT
		    	HAWB_NO
			FROM
		    	TB_HAWB F1
			WHERE	
		    	MAWB_NO = #{mawbNo} AND 
		    	HAWB_NO IN (
		        	SELECT
		            	HAWB_NO
		        	FROM
		            	TB_CARRY_IN
		        	WHERE
			            USER_ID = F1.USER_ID
			            and ORG_STATION = F1.ORG_STATION
			            and SEND_YN = 'N'
		    ));
	</update>
	
	<select id = "selectFtpCount" parameterType="String" resultType="com.example.temp.manager.vo.HawbVO">
		SELECT 
			(SELECT COUNT(*) FROM TB_CARRY_IN WHERE SEND_YN = 'Y' AND HAWB_NO IN (SELECT HAWB_NO FROM TB_HAWB WHERE MAWB_NO != '' AND ORG_STATION = #{orgStation})) AS REGIST_COUNT,
			(select COUNT(*) FROM TB_HAWB WHERE MAWB_NO != '' AND ORG_STATION = #{orgStation}) AS TOTAL_COUNT;
	</select>
	
	<select id = "selectExpLicenceCount" parameterType="String" resultType="com.example.temp.manager.vo.HawbVO">
		<!-- SELECT
			(SELECT COUNT(*) FROM TB_EXPLICENCE WHERE SEND_YN = 'N' AND NNO IN (SELECT NNO FROM TB_ORDER_LIST WHERE ORG_STATION = '082') and API_STATUS != '') AS FAIL_COUNT, 
			(SELECT COUNT(*) FROM TB_EXPLICENCE WHERE SEND_YN != 'N' AND NNO IN (SELECT NNO FROM TB_ORDER_LIST WHERE ORG_STATION = #{orgStation})) AS REGIST_COUNT,
			(SELECT COUNT(*) FROM TB_EXPLICENCE WHERE (API_STATUS = '' OR API_STATUS IS NULL) AND SEND_YN = 'N' and NNO IN (SELECT NNO FROM TB_ORDER_LIST WHERE ORG_STATION = #{orgStation})) AS READY_COUNT,
			(select COUNT(*) FROM TB_EXPLICENCE WHERE NNO IN (SELECT NNO FROM TB_ORDER_LIST WHERE ORG_STATION = #{orgStation})) AS TOTAL_COUNT; -->
		SELECT
			(SELECT COUNT(*) FROM TB_EXP_DCL WHERE SEND_YN = 'F' AND NNO IN (SELECT NNO FROM TB_ORDER_LIST WHERE ORG_STATION = #{orgStation})) AS FAIL_COUNT,
			(SELECT COUNT(*) FROM TB_EXP_DCL WHERE SEND_YN = 'S' AND NNO IN (SELECT NNO FROM TB_ORDER_LIST WHERE ORG_STATION = #{orgStation})) AS REGIST_COUNT,
			(SELECT COUNT(*) FROM TB_EXP_DCL WHERE SEND_YN = 'N' AND NNO IN (SELECT NNO FROM TB_ORDER_LIST WHERE ORG_STATION = #{orgStation})) AS READY_COUNT,
			(SELECT COUNT(*) FROM TB_EXP_DCL WHERE NNO IN (SELECT NNO FROM TB_ORDER_LIST WHERE ORG_STATION = #{orgStation})) AS TOTAL_COUNT;
	</select>
	
	<select id="selectInnerProductListAll" parameterType="hashMap" resultType="com.example.temp.manager.vo.insp.InnerProductVO">
		DECLARE 
			@MAWB_NO NVARCHAR(50),
			@W_USER_ID  NVARCHAR(50),
			@W_USER_IP NVARCHAR(50)
			
			SET @W_USER_ID = #{userId}
			SET @W_USER_IP = #{userIp}
			SET @MAWB_NO = #{mawbNo}
			
		INSERT INTO TB_CARRY_IN(CARRY_IN_NUM,HAWB_NO,NNO,ORG_STATION,USER_ID,W_USER_ID,W_USER_IP,W_DATE)
		SELECT NEXT VALUE FOR SEQ_CARRY_IN NUM, 
		       HAWB_NO , 
		       NNO , 
		       ORG_STATION , 
		       USER_ID , 
		       @W_USER_ID ,
		       @W_USER_IP , 
		       GETDATE()
		  FROM TB_HAWB F1 
		  WHERE HAWB_NO NOT IN (SELECT HAWB_NO FROM TB_CARRY_IN WHERE HAWB_NO = F1.HAWB_NO AND USER_ID = F1.USER_ID AND ORG_STATION = F1.ORG_STATION)
		    AND MAWB_NO = @MAWB_NO;
			  
		  SELECT (SELECT CARRY_IN_NUM FROM TB_CARRY_IN WHERE HAWB_NO = F1.HAWB_NO AND USER_ID = F1.USER_ID AND ORG_STATION = F1.ORG_STATION) CARRY_IN_NUM, 
		         SUBSTRING(STUFF((SELECT  CAST(',' AS VARCHAR(MAX))+ REPLACE(A2.ITEM_DETAIL,'*','x') 
		                           FROM TB_HAWB_ITEM A1 , 
		                                 TB_ORDER_ITEM A2
		                           WHERE ISNULL(A1.ORG_NNO,A1.NNO)=A2.NNO 
		                             AND ISNULL(A1.ORG_SUB_NO,A1.SUB_NO)=A2.SUB_NO AND A1.NNO = F1.NNO FOR XML PATH('')), 1, 1, ''),1,200) AS ITEM_DETAIL ,
		            CASE WHEN ISNULL((SELECT MAX(QTY_UNIT) FROM TB_ORDER_ITEM WHERE NNO IN (SELECT ISNULL(ORG_NNO,NNO) FROM TB_HAWB_ITEM WHERE NNO = F1.NNO)),'') = '' THEN 'EA'
		            ELSE (SELECT MAX(QTY_UNIT) FROM TB_ORDER_ITEM WHERE NNO IN (SELECT ISNULL(ORG_NNO,NNO) FROM TB_HAWB_ITEM WHERE NNO = F1.NNO)) END QTY_UNIT ,
					(SELECT SUM(ITEM_CNT) FROM TB_HAWB_ITEM WHERE NNO = F1.NNO) AS ITEM_CNT,
					WTA,
					WTC,
					format(ISNULL((SELECT top 1 W_DATE FROM TB_STOCK WHERE NNO = F1.NNO), W_DATE),'yyyyMMdd') AS IN_DATE,
					(SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = @MAWB_NO) AS END_DATE
		  FROM TB_HAWB F1
		  WHERE HAWB_NO IN (SELECT HAWB_NO FROM TB_CARRY_IN WHERE USER_ID = F1.USER_ID AND ORG_STATION = F1.ORG_STATION AND SEND_YN = 'N');
	</select>
	<update id="updateItemTrkNo" parameterType="String">
		UPDATE TB_ORDER_ITEM SET TRK_NO = #{trkNo} WHERE NNO = #{nno} AND SUB_NO = #{subNo}	
	</update>
	
	<select id="selectStockRackInfo" parameterType="hashMap" resultType="com.example.temp.manager.vo.insp.InspStockOutVO">
		SELECT  ISNULL(
			(SELECT ITEM_DETAIL FROM TB_ORDER_ITEM WHERE NNO = F1.NNO AND SUB_NO =F1.SUB_NO),
			(SELECT ITEM_DETAIL FROM TB_RETURN_REQUEST_ITEM WHERE NNO = F1.NNO AND SUB_NO =F1.SUB_NO)
		) ITEM_DETAIL ,
	        RACK_CODE ,
	        STOCK_NO 
	    FROM TB_STOCK F1 
		 WHERE NNO IN (select NNO from TMP_WHOUT_STOCK where w_user_id = #{wUserId})
		AND STOCK_NO NOT IN (SELECT STOCK_NO FROM TMP_WHOUT_STOCK WHERE w_user_id = #{wUserId})
		AND ISNULL(OUT_NNO ,'') = ''
		AND ORG_STATION = #{orgStation}
	
	</select>
	
	<select id="selectTransCodeInStock" parameterType="String" resultType="String">
		SELECT TRANS_CODE FROM TB_ORDER_LIST WHERE NNO = #{nno}
	</select>
	
	<select id="selectOrderListOption" parameterType="String" resultType="com.example.temp.manager.vo.OrderListOptionVO">
		SELECT * FROM TB_ORDER_LIST_FILTER WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = ISNULL((SELECT DSTN_NATION FROM TB_ORDER_LIST_FILTER WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = #{dstnNation}),'DEFAULT');
	</select>
	
	<select id="selectOrderItemOption" parameterType="String" resultType="com.example.temp.manager.vo.OrderItemOptionVO">
		SELECT * FROM TB_ORDER_ITEM_FILTER WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = ISNULL((SELECT DSTN_NATION FROM TB_ORDER_ITEM_FILTER WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = #{dstnNation}),'DEFAULT');
	</select>
	
	<select id="selectExpressListOption" parameterType="String" resultType="com.example.temp.manager.vo.OrderListExpOptionVO">
		SELECT * FROM TB_ORDER_LIST_EXPRESS WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = ISNULL((SELECT DSTN_NATION FROM TB_ORDER_LIST_EXPRESS WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = #{dstnNation}),'DEFAULT');
	</select>
	
	<select id="selectExpressItemOption" parameterType="String" resultType="com.example.temp.manager.vo.OrderItemExpOptionVO">
		SELECT * FROM TB_ORDER_ITEM_EXPRESS WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = ISNULL((SELECT DSTN_NATION FROM TB_ORDER_ITEM_EXPRESS WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = #{dstnNation}),'DEFAULT');
	</select>
	
	<delete id="deleteOrderListOption" parameterType="String">
		DELETE FROM TB_ORDER_LIST_FILTER WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = #{dstnNation};
	</delete>
	
	<delete id="deleteOrderpItemOtion" parameterType="String">
		DELETE  FROM TB_ORDER_ITEM_FILTER WHERE TRANS_CODE = #{targetCode}  AND DSTN_NATION = #{dstnNation};
	</delete>
	
	<delete id="deleteOrderListExpOption" parameterType="String">
		DELETE  FROM TB_ORDER_LIST_EXPRESS WHERE TRANS_CODE = #{targetCode}  AND DSTN_NATION = #{dstnNation};
	</delete>
	
	<delete id="deleteOrderItemExpOption" parameterType="String">
		DELETE  FROM TB_ORDER_ITEM_EXPRESS WHERE TRANS_CODE = #{targetCode}  AND DSTN_NATION = #{dstnNation};
	</delete>
	
	<insert id="insertOrderListOption" parameterType="com.example.temp.manager.vo.OrderListOptionVO">
		INSERT INTO
		    TB_ORDER_LIST_FILTER (
		        TRANS_CODE,
		        ORG_STATION_YN,
		        DSTN_NATION_YN,
		        ORDER_NO_YN,
		        ORDER_DATE_YN,
		        HAWB_NO_YN,
		        BOX_CNT_YN,
		        USER_WTA_YN,
		        USER_WTC_YN,
		        SHIPPER_NAME_YN,
		        SHIPPER_ZIP_YN,
		        SHIPPER_TEL_YN,
		        SHIPPER_HP_YN,
		        SHIPPER_CNTRY_YN,
		        SHIPPER_CITY_YN,
		        SHIPPER_STATE_YN,
		        SHIPPER_ADDR_YN,
		        SHIPPER_ADDR_DETAIL_YN,
		        CNEE_NAME_YN,
		        CNEE_ADDR_YN,
		        CNEE_ZIP_YN,
		        CNEE_TEL_YN,
		        CNEE_HP_YN,
		        CNEE_CNTRY_YN,
		        CNEE_CITY_YN,
		        CNEE_STATE_YN,
		        CNEE_ADDR_DETAIL_YN,
		        USER_LENGTH_YN,
		        USER_WIDTH_YN,
		        USER_HEIGHT_YN,
		        USER_EMAIL_YN,
		        TRANS_CODE_YN,
		        CNEE_EMAIL_YN,
		        CUSTOMS_NO_YN,
		        NATIVE_CNEE_NAME_YN,
		        NATIVE_CNEE_ADDR_YN,
		        NATIVE_CNEE_ADDR_DETAIL_YN,
		        DIM_UNIT_YN,
		        WT_UNIT_YN,
		        BUY_SITE_YN,
		        GET_BUY_YN,
		        MALL_TYPE_YN,
		        WH_REQ_MSG_YN,
		        DLV_REQ_MSG_YN,
		        DSTN_NATION,
		        CNEE_DISTRICT_YN,
		        SHIPPER_REFERENCE_YN,
		        CNEE_REFERENCE1_YN,
		        CNEE_REFERENCE2_YN,
		        FOOD_YN,
		        NATIONAL_ID_DATE_YN,
				NATIONAL_ID_AUTHORITY_YN,
				CNEE_BIRTH_YN,
				TAX_NO_YN,
				TAX_ID_YN,
				EORI_NO_YN,
				DECL_TYPE_YN,
				CNEE_WARD_YN,
				IOSS_NO_YN,
				COSMETIC_YN,
				SIGN_YN,
				SHIPPER_TAX_NO_YN,
				SHIPPER_TAX_TYPE_YN,
				CNEE_TAX_NO_YN,
				CNEE_TAX_TYPE_YN
		    )
		VALUES
		    (
		    	#{targetCode},
			    'on',
				'on',
				#{orderNoYn},
				#{orderDateYn},
				#{hawbNoYn},
				#{boxCntYn},
				#{userWtaYn},
				#{userWtcYn},
				#{shipperNameYn},
				#{shipperZipYn},
				#{shipperTelYn},
				#{shipperHpYn},
				#{shipperCntryYn},
				#{shipperCityYn},
				#{shipperStateYn},
				#{shipperAddrYn},
				#{shipperAddrDetailYn},
				#{cneeNameYn},
				#{cneeAddrYn},
				#{cneeZipYn},
				#{cneeTelYn},
				#{cneeHpYn},
				#{cneeCntryYn},
				#{cneeCityYn},
				#{cneeStateYn},
				#{cneeAddrDetailYn},
				#{userLengthYn},
				#{userWidthYn},
				#{userHeightYn},
				#{userEmailYn},
				#{transCodeYn},
				#{cneeEmailYn},
				#{customsNoYn},
				#{nativeCneeNameYn},
				#{nativeCneeAddrYn},
				#{nativeCneeAddrDetailYn},
				#{dimUnitYn},
				#{wtUnitYn},
				#{buySiteYn},
				#{getBuyYn},
				#{mallTypeYn},
				#{whReqMsgYn},
				#{dlvReqMsgYn},
				#{dstnNation},
				#{cneeDistrictYn},
				#{shipperReferenceYn},
				#{cneeReference1Yn},
				#{cneeReference2Yn},
				#{foodYn},
				#{nationalIdDateYn},
				#{nationalIdAuthorityYn},
				#{cneeBirthYn},
				#{taxNoYn},
				#{taxIdYn},
				#{eoriNoYn},
				#{declTypeYn},
				#{cneeWardYn},
				#{iossNoYn},
				#{cosmeticYn},
				#{signYn},
				#{shipperTaxNoYn},
				#{shipperTaxTypeYn},
				#{cneeTaxNoYn},
				#{cneeTaxTypeYn}
		    );
	
	</insert>
	
	<insert id="insertOrderItemOption" parameterType="com.example.temp.manager.vo.OrderItemOptionVO">
		INSERT INTO
		    TB_ORDER_ITEM_FILTER (
		        TRANS_CODE,
		        ORG_STATION_YN,
		        USER_ID_YN,
		        HS_CODE_YN,
		        ITEM_DETAIL_YN,
		        NATIVE_ITEM_DETAIL_YN,
		        UNIT_CURRENCY_YN,
		        ITEM_CNT_YN,
		        UNIT_VALUE_YN,
		        BRAND_YN,
		        MAKE_CNTRY_YN,
		        MAKE_COM_YN,
		        ITEM_DIV_YN,
		        ITEM_WT_UNIT_YN,
		        QTY_UNIT_YN,
		        PACKAGE_UNIT_YN,
		        EXCHANGE_RATE_YN,
		        CHG_CURRENCY_YN,
		        CHG_AMT_YN,
		        ITEM_METERIAL_YN,
		        TAKE_IN_CODE_YN,
		        CUS_ITEM_CODE_YN,
		        ITEM_URL_YN,
		        ITEM_IMG_URL_YN,
		        TRK_COM_YN,
		        TRK_NO_YN,
		        TRK_DATE_YN,
		        ITEM_USER_WTA_YN,
		        ITEM_USER_WTC_YN,
		        DSTN_NATION,
		        ITEM_EXPLAN_YN,
				ITEM_BARCODE_YN
		    )
		VALUES
		    (
			#{targetCode},
			'on',
			#{userIdYn},
			#{hsCodeYn},
			#{ItemDetailYn},
			#{nativeItemDetailYn},
			#{unitCurrencyYn},
			#{itemCntYn},
			#{unitValueYn},
			#{brandYn},
			#{makeCntryYn},
			#{makeComYn},
			#{itemDivYn},
			#{itemWtUnitYn},
			#{qtyUnitYn},
			#{packageUnitYn},
			#{exchangeRateYn},
			#{chgCurrencyYn},
			#{chgAmtYn},
			#{itemMeterialYn},
			#{takeInCodeYn},
			#{cusItemCodeYn},
			#{itemUrlYn},
			#{itemImgUrlYn},
			#{trkComYn},
			#{trkNoYn},
			#{trkDateYn},
			#{itemUserWtaYn},
			#{itemUserWtcYn},
			#{dstnNation},
			#{itemExplanYn},
			#{itemBarcodeYn}
	    );
	</insert>
	
	<insert id="insertOrderListExpOption" parameterType="com.example.temp.manager.vo.OrderListExpOptionVO">
		INSERT INTO
		    TB_ORDER_LIST_EXPRESS (
		        TRANS_CODE,
		        ORG_STATION_YN_EXPRESS,
		        DSTN_NATION_YN_EXPRESS,
		        ORDER_NO_YN_EXPRESS,
		        ORDER_DATE_YN_EXPRESS,
		        HAWB_NO_YN_EXPRESS,
		        BOX_CNT_YN_EXPRESS,
		        USER_WTA_YN_EXPRESS,
		        USER_WTC_YN_EXPRESS,
		        SHIPPER_NAME_YN_EXPRESS,
		        SHIPPER_ZIP_YN_EXPRESS,
		        SHIPPER_TEL_YN_EXPRESS,
		        SHIPPER_HP_YN_EXPRESS,
		        SHIPPER_CNTRY_YN_EXPRESS,
		        SHIPPER_CITY_YN_EXPRESS,
		        SHIPPER_STATE_YN_EXPRESS,
		        SHIPPER_ADDR_YN_EXPRESS,
		        SHIPPER_ADDR_DETAIL_YN_EXPRESS,
		        CNEE_NAME_YN_EXPRESS,
		        CNEE_ADDR_YN_EXPRESS,
		        CNEE_ZIP_YN_EXPRESS,
		        CNEE_TEL_YN_EXPRESS,
		        CNEE_HP_YN_EXPRESS,
		        CNEE_CNTRY_YN_EXPRESS,
		        CNEE_CITY_YN_EXPRESS,
		        CNEE_STATE_YN_EXPRESS,
		        CNEE_ADDR_DETAIL_YN_EXPRESS,
		        USER_LENGTH_YN_EXPRESS,
		        USER_WIDTH_YN_EXPRESS,
		        USER_HEIGHT_YN_EXPRESS,
		        USER_EMAIL_YN_EXPRESS,
		        TRANS_CODE_YN_EXPRESS,
		        CNEE_EMAIL_YN_EXPRESS,
		        CUSTOMS_NO_YN_EXPRESS,
		        NATIVE_CNEE_NAME_YN_EXPRESS,
		        NATIVE_CNEE_ADDR_YN_EXPRESS,
		        NATIVE_CNEE_ADDR_DETAIL_YN_EXPRESS,
		        DIM_UNIT_YN_EXPRESS,
		        WT_UNIT_YN_EXPRESS,
		        BUY_SITE_YN_EXPRESS,
		        GET_BUY_YN_EXPRESS,
		        MALL_TYPE_YN_EXPRESS,
		        WH_REQ_MSG_YN_EXPRESS,
		        DLV_REQ_MSG_YN_EXPRESS,
		        DSTN_NATION,
		        CNEE_DISTRICT_YN_EXPRESS,
		        SHIPPER_REFERENCE_YN_EXPRESS,
		        CNEE_REFERENCE1_YN_EXPRESS,
		        CNEE_REFERENCE2_YN_EXPRESS,
		        FOOD_YN_EXPRESS,
		        NATIONAL_ID_DATE_YN_EXPRESS,
				NATIONAL_ID_AUTHORITY_YN_EXPRESS,
				CNEE_BIRTH_YN_EXPRESS,
				TAX_NO_YN_EXPRESS,
				TAX_ID_YN_EXPRESS,
				EORI_NO_YN_EXPRESS,
				DECL_TYPE_YN_EXPRESS,
				CNEE_WARD_YN_EXPRESS,
				IOSS_NO_YN_EXPRESS,
				COSMETIC_YN_EXPRESS,
				SIGN_YN_EXPRESS,
				SHIPPER_TAX_NO_YN_EXPRESS,
				SHIPPER_TAX_TYPE_YN_EXPRESS,
				CNEE_TAX_NO_YN_EXPRESS,
				CNEE_TAX_TYPE_YN_EXPRESS
		    )
		VALUES
		    (
		    	#{targetCode},
			    'on',
				'on',
				#{orderNoYnExpress},
				#{orderDateYnExpress},
				#{hawbNoYnExpress},
				#{boxCntYnExpress},
				#{userWtaYnExpress},
				#{userWtcYnExpress},
				#{shipperNameYnExpress},
				#{shipperZipYnExpress},
				#{shipperTelYnExpress},
				#{shipperHpYnExpress},
				#{shipperCntryYnExpress},
				#{shipperCityYnExpress},
				#{shipperStateYnExpress},
				#{shipperAddrYnExpress},
				#{shipperAddrDetailYnExpress},
				#{cneeNameYnExpress},
				#{cneeAddrYnExpress},
				#{cneeZipYnExpress},
				#{cneeTelYnExpress},
				#{cneeHpYnExpress},
				#{cneeCntryYnExpress},
				#{cneeCityYnExpress},
				#{cneeStateYnExpress},
				#{cneeAddrDetailYnExpress},
				#{userLengthYnExpress},
				#{userWidthYnExpress},
				#{userHeightYnExpress},
				#{userEmailYnExpress},
				#{transCodeYnExpress},
				#{cneeEmailYnExpress},
				#{customsNoYnExpress},
				#{nativeCneeNameYnExpress},
				#{nativeCneeAddrYnExpress},
				#{nativeCneeAddrDetailYnExpress},
				#{dimUnitYnExpress},
				#{wtUnitYnExpress},
				#{buySiteYnExpress},
				#{getBuyYnExpress},
				#{mallTypeYnExpress},
				#{whReqMsgYnExpress},
				#{dlvReqMsgYnExpress},
				#{dstnNation},
				#{cneeDistrictYnExpress},
				#{shipperReferenceYnExpress},
				#{cneeReference1YnExpress},
				#{cneeReference2YnExpress},
				#{foodYnExpress},
				#{nationalIdDateYnExpress},
				#{nationalIdAuthorityYnExpress},
				#{cneeBirthYnExpress},
				#{taxNoYnExpress},
				#{taxIdYnExpress},
				#{eoriNoYnExpress},
				#{declTypeYnExpress},
				#{cneeWardYnExpress},
				#{iossNoYnExpress},
				#{cosmeticYnExpress},
				#{signYnExpress},
				#{shipperTaxNoYnExpress},
				#{shipperTaxTypeYnExpress},
				#{cneeTaxNoYnExpress},
				#{cneeTaxTypeYnExpress}
		    );
	
	</insert>
	
	<insert id="insertOrderItemExpOption" parameterType="com.example.temp.manager.vo.OrderItemExpOptionVO">
		INSERT INTO
		    TB_ORDER_ITEM_EXPRESS (
		        TRANS_CODE,
		        ORG_STATION_YN_EXPRESS,
		        USER_ID_YN_EXPRESS,
		        HS_CODE_YN_EXPRESS,
		        ITEM_DETAIL_YN_EXPRESS,
		        NATIVE_ITEM_DETAIL_YN_EXPRESS,
		        UNIT_CURRENCY_YN_EXPRESS,
		        ITEM_CNT_YN_EXPRESS,
		        UNIT_VALUE_YN_EXPRESS,
		        BRAND_YN_EXPRESS,
		        MAKE_CNTRY_YN_EXPRESS,
		        MAKE_COM_YN_EXPRESS,
		        ITEM_DIV_YN_EXPRESS,
		        ITEM_WT_UNIT_YN_EXPRESS,
		        QTY_UNIT_YN_EXPRESS,
		        PACKAGE_UNIT_YN_EXPRESS,
		        EXCHANGE_RATE_YN_EXPRESS,
		        CHG_CURRENCY_YN_EXPRESS,
		        CHG_AMT_YN_EXPRESS,
		        ITEM_METERIAL_YN_EXPRESS,
		        TAKE_IN_CODE_YN_EXPRESS,
		        CUS_ITEM_CODE_YN_EXPRESS,
		        ITEM_URL_YN_EXPRESS,
		        ITEM_IMG_URL_YN_EXPRESS,
		        TRK_COM_YN_EXPRESS,
		        TRK_NO_YN_EXPRESS,
		        TRK_DATE_YN_EXPRESS,
		        ITEM_USER_WTA_YN_EXPRESS,
		        ITEM_USER_WTC_YN_EXPRESS,
		        DSTN_NATION,
		        ITEM_EXPLAN_YN_EXPRESS,
				ITEM_BARCODE_YN_EXPRESS
		    )
		VALUES
		    (
			#{targetCode},
			'on',
			#{userIdYnExpress},
			#{hsCodeYnExpress},
			#{ItemDetailYnExpress},
			#{nativeItemDetailYnExpress},
			#{unitCurrencyYnExpress},
			#{itemCntYnExpress},
			#{unitValueYnExpress},
			#{brandYnExpress},
			#{makeCntryYnExpress},
			#{makeComYnExpress},
			#{itemDivYnExpress},
			#{itemWtUnitYnExpress},
			#{qtyUnitYnExpress},
			#{packageUnitYnExpress},
			#{exchangeRateYnExpress},
			#{chgCurrencyYnExpress},
			#{chgAmtYnExpress},
			#{itemMeterialYnExpress},
			#{takeInCodeYnExpress},
			#{cusItemCodeYnExpress},
			#{itemUrlYnExpress},
			#{itemImgUrlYnExpress},
			#{trkComYnExpress},
			#{trkNoYnExpress},
			#{trkDateYnExpress},
			#{itemUserWtaYnExpress},
			#{itemUserWtcYnExpress},
			#{dstnNation},
			#{itemExplanYnExpress},
			#{itemBarcodeYnExpress}
	    );
	</insert>
		
	<select id = "selectOrderListOptionNation" parameterType="String" resultType="String">
		select DISTINCT(DSTN_NATION)from TB_TRANS_ZONE 
			WHERE 
				TRANS_CODE = #{targetCode}
	</select>
	
	
	<select id ="selectCountOrderListOption" parameterType="String" resultType="Integer">
		SELECT COUNT(*) FROM TB_ORDER_LIST_FILTER WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = ISNULL((SELECT DSTN_NATION FROM TB_ORDER_LIST_FILTER WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = #{dstnNation}),'DEFAULT');
	</select>
	
	<select id ="selectCountOrderItemOption" parameterType="String" resultType="Integer">
		SELECT COUNT(*) FROM TB_ORDER_ITEM_FILTER WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = ISNULL((SELECT DSTN_NATION FROM TB_ORDER_ITEM_FILTER WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = #{dstnNation}),'DEFAULT');
	</select>
	
	<select id ="selectCountExpressListOption" parameterType="String" resultType="Integer">
		SELECT COUNT(*) FROM TB_ORDER_LIST_EXPRESS WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = ISNULL((SELECT DSTN_NATION FROM TB_ORDER_LIST_EXPRESS WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = #{dstnNation}),'DEFAULT'); 
	</select>
	
	<select id ="selectCountExpressItemOption" parameterType="String" resultType="Integer">
		SELECT COUNT(*) FROM TB_ORDER_ITEM_EXPRESS WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = ISNULL((SELECT DSTN_NATION FROM TB_ORDER_ITEM_EXPRESS WHERE TRANS_CODE = #{targetCode} AND DSTN_NATION = #{dstnNation}),'DEFAULT'); 	
	</select>
	<select id="selectExcelLicence" parameterType="String" resultType="com.example.temp.manager.vo.ExpLicenceExcelVO">
	SELECT
		ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = F1.HAWB_NO),F1.HAWB_NO) AS HAWB,
		F1.SHIPPER_NAME,
		F1.DSTN_NATION,
		F2.ITEM_DETAIL,
		F1.CNEE_NAME,
		F2.brand,
		F2.ITEM_CNT,
		F2.UNIT_VALUE,
		LEFT((F2.ITEM_CNT*F2.UNIT_VALUE),8) AS [VALUE],
		F2.HS_CODE,
		F3.WTA,
		F1.BOX_CNT,
		ISNULL(F2.CHG_CURRENCY,F2.UNIT_CURRENCY) AS CURRENCY,
		LEFT((SELECT SUM(ITEM_CNT*UNIT_VALUE) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO AND USER_ID = F1.USER_ID AND ORG_STATION = F1.ORG_STATION),8) AS TOTAL_VALUE,
		ISNULL(F1.PAYMENT,'DDU') AS PAYMENT
	FROM
		TB_ORDER_LIST F1 
		LEFT OUTER JOIN TB_ORDER_ITEM F2 ON F1.NNO = F2.NNO 
		LEFT OUTER JOIN TB_HAWB F3 ON F1.NNO = F3.NNO
		WHERE F1.NNO = #{nno};
	</select>
	
	<select id="selectExcelLicenceEFS" parameterType="String" resultType="com.example.temp.manager.vo.ExpLicenceExcelVO">
		SELECT
			CASE
				WHEN F1.TRANS_CODE = 'ACI-T86' THEN F1.HAWB_NO
				WHEN F1.TRANS_CODE = 'FB' OR F1.TRANS_CODE = 'FB-EMS' THEN F1.HAWB_NO
				WHEN F1.TRANS_CODE = 'YSL' THEN ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = F1.HAWB_NO),F1.HAWB_NO)
				ELSE F1.HAWB_NO
			END HAWB,
			<!-- ISNULL((select VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = F1.HAWB_NO),F1.HAWB_NO) AS HAWB, -->
			ISNULL(
				(SELECT CHG_CURRENCY FROM TB_ORDER_ITEM F2 WHERE F2.NNO = F1.NNO AND SUB_NO = '1'),
				(SELECT UNIT_CURRENCY FROM TB_ORDER_ITEM F2 WHERE F2.NNO = F1.NNO AND SUB_NO = '1')
			) AS CURRENCY,
			'1' AS BOX_CNT,
			/*CASE WHEN
				(SELECT WTA FROM TB_HAWB WHERE NNO = F1.NNO) > (SELECT WTC FROM TB_HAWB WHERE NNO = F1.NNO) 
				THEN 
					(SELECT WTA FROM TB_HAWB WHERE NNO = F1.NNO)
				ELSE 
					(SELECT WTC FROM TB_HAWB WHERE NNO = F1.NNO) 
				END AS WTA,*/
			USER_WTA AS WTA,
			DSTN_NATION,
			(select SUM(ITEM_CNT*UNIT_VALUE) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO) AS
			TOTAL_VALUE,
			(SELECT ITEM_DETAIL FROM TB_ORDER_ITEM WHERE NNO = F1.NNO and SUB_NO = '1') AS
			ITEM_DETAIL,
			SHIPPER_NAME,
			SHIPPER_ADDR,
			SHIPPER_ADDR_DETAIL,
			CNEE_NAME,
			CNEE_ADDR,
			CNEE_ADDR_DETAIL,
			(SELECT ISNULL(EXP_NO,'') FROM TB_EXPLICENCE WHERE NNO = F1.NNO) AS EXP_NO,
			(SELECT ISNULL(EXP_BUSINESS_NUM,'') FROM TB_EXPLICENCE WHERE NNO = F1.NNO) AS
			EXP_BUSINESS_NUM,
			ISNULL(PAYMENT,'') AS PAYMENT
		FROM TB_ORDER_LIST F1 WHERE F1.NNO = #{nno};
	</select>
	
	<update id="updateLicenceInfo" parameterType="hashMap">
		UPDATE TB_EXPLICENCE SET EXP_NO = #{expNo}, EXP_REG_NO = #{expRegNo}, SEND_YN = 'M' WHERE EXP_REG_NO = #{expRegNo} OR
			EXP_REG_NO = (SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO = #{expRegNo});
	</update>
	
	<select id="selectAgencyBlByHawbNo" parameterType="String" resultType="String">
		SELECT ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = #{expRegNo}), HAWB_NO)
		FROM TB_ORDER_LIST
		WHERE HAWB_NO = #{expRegNo}
	</select>
	
	<update id="updateLicenceInfoFail" parameterType="hashMap">
		UPDATE TB_EXPLICENCE SET SEND_YN = 'F' WHERE EXP_REG_NO = #{expRegNo} OR
			EXP_REG_NO = (SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = #{expRegNo});
	</update>
	
	<delete id="deleteExpLicenceInfo" parameterType="String">
		DELETE FROM TB_EXPLICENCE WHERE NNO = #{nno}
	</delete>
	
	<update id="updateExpLicenceInfo" parameterType="String">
		UPDATE TB_EXPLICENCE SET EXP_REG_NO = (SELECT ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = #{hawbNo}),#{hawbNo})) WHERE EXP_REG_NO = #{hawbNo}
	</update>
	
	<select id="selectOrderNoFromNNO" parameterType="String" resultType="String"> 
		SELECT ORDER_NO FROM TB_ORDER_LIST WHERE NNO = #{nno}
	</select>
	
	<select id ="selectExpFieldList" resultType="com.example.temp.manager.vo.HawbVO" parameterType="String">
		select 
			ISNULL(F1.nno,'') AS NNO,
			ISNULL(F1.ORG_STATION,'') AS ORG_STATION,
			ISNULL(F1.DSTN_NATION,'') AS DSTN_NATION,
			ISNULL(F1.DSTN_STATION,'') AS DSTN_STATION,
			ISNULL(F1.USER_ID,'') AS USER_ID,
			ISNULL(F1.ORDER_NO,'') AS ORDER_NO,
			ISNULL(F1.TRANS_CODE,'') AS TRANS_CODE,
			ISNULL(F1.HAWB_NO,'') AS HAWB_NO,
			ISNULL(F1.MAWB_NO,'') AS MAWB_NO,
			ISNULL(F1.BOX_CNT,'') AS BOX_CNT,
			ISNULL(F1.W_USER_ID,'') AS W_USER_ID,
			ISNULL(F1.W_USER_IP,'') AS W_USER_IP,
			ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = F1.HAWB_NO),F1.HAWB_NO) AS EXP_REG_NO,
			ISNULL((SELECT EXP_NO FROM TB_EXP_DCL WHERE NNO = F1.NNO AND USER_ID = F1.USER_ID),'') AS EXP_NO,
			ISNULL((SELECT W_DATE FROM TB_EXP_DCL WHERE NNO = F1.NNO AND USER_ID = F1.USER_ID),'') AS EXP_W_DATE,
			ISNULL((SELECT SEND_YN FROM TB_EXP_DCL WHERE NNO = F1.NNO AND USER_ID = F1.USER_ID),'') AS SEND_YN,
			ISNULL((SELECT EXP_TYPE FROM TB_EXP_DCL WHERE NNO = F1.NNO AND USER_ID = F1.USER_ID),'') AS EXP_VALUE,
			ISNULL((SELECT CNEE_NAME FROM TB_ORDER_LIST WHERE NNO = F1.NNO),'') AS CNEE_NAME,
			ISNULL((SELECT COM_NAME FROM TB_CUSTOMER WHERE USER_ID = F1.[USER_ID]),'') AS COM_NAME,
			ISNULL((SELECT USER_NAME FROM TB_CUSTOMER WHERE USER_ID = F1.[USER_ID]),'') AS USER_NAME,
			ISNULL((SELECT TRANS_NAME FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE),'') AS TRANS_NAME
		FROM TB_HAWB F1 WHERE 1=1 AND MAWB_NO = #{mawbNo}
		AND NNO IN (SELECT NNO FROM TB_EXP_DCL);
		<!-- 
		select 
			ISNULL(F1.nno,'') AS NNO,
			ISNULL(F1.ORG_STATION,'') AS ORG_STATION,
			ISNULL(F1.DSTN_NATION,'') AS DSTN_NATION,
			ISNULL(F1.DSTN_STATION,'') AS DSTN_STATION,
			ISNULL(F1.USER_ID,'') AS USER_ID,
			ISNULL(F1.ORDER_NO,'') AS ORDER_NO,
			ISNULL(F1.TRANS_CODE,'') AS TRANS_CODE,
			ISNULL(F1.HAWB_NO,'') AS HAWB_NO,
			ISNULL(F1.MAWB_NO,'') AS MAWB_NO,
			ISNULL(F1.BOX_CNT,'') AS BOX_CNT,
			ISNULL(F1.W_USER_ID,'') AS W_USER_ID,
			ISNULL(F1.W_USER_IP,'') AS W_USER_IP,
			ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = F1.HAWB_NO),F1.HAWB_NO) AS EXP_REG_NO,
			ISNULL((SELECT EXP_NO FROM TB_EXPLICENCE WHERE NNO = F1.NNO),'')AS EXP_NO,
			ISNULL((SELECT W_DATE FROM TB_EXPLICENCE WHERE NNO = F1.NNO),'')AS EXP_W_DATE,
			ISNULL((SELECT SEND_YN FROM TB_EXPLICENCE WHERE NNO = F1.NNO),'') AS SEND_YN,
			ISNULL((SELECT API_STATUS FROM TB_EXPLICENCE WHERE NNO = F1.NNO),'') AS API_STATUS,
			ISNULL((SELECT CNEE_NAME FROM TB_ORDER_LIST WHERE NNO = F1.NNO),'') AS CNEE_NAME,
			ISNULL((SELECT COM_NAME FROM TB_CUSTOMER WHERE USER_ID = F1.[USER_ID]),'') AS COM_NAME,
			ISNULL((SELECT USER_NAME FROM TB_CUSTOMER WHERE USER_ID = F1.[USER_ID]),'') AS USER_NAME,
			ISNULL((SELECT EXP_VALUE FROM TB_EXPLICENCE WHERE NNO = F1.NNO),'') AS EXP_VALUE,
			ISNULL((SELECT TRANS_NAME FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE),'') AS TRANS_NAME
		FROM TB_HAWB F1 WHERE 1=1 AND MAWB_NO = #{mawbNo} AND NNO IN (SELECT NNO FROM TB_EXPLICENCE)
		 -->
	</select>
	<select id ="selectorderListByMawb" parameterType="String" resultType="com.example.temp.manager.vo.OrderInspListVO">
		SELECT 
			*,
			(select VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = HAWB_NO) AS BL_NO2 
		FROM TB_ORDER_LIST F1 LEFT OUTER JOIN TB_ORDER_ITEM F2 ON F1.NNO = F2.NNO 
		WHERE HAWB_NO IN (SELECT HAWB_NO FROM TB_HAWB WHERE MAWB_NO = #{mawbNo}) ORDER BY F1.NNO, F2.SUB_NO ASC
	
	</select>
	
	<select id="execStockAddInsert" parameterType="com.example.temp.manager.vo.StockAllVO" resultType="com.example.temp.manager.vo.StockResultVO" statementType="CALLABLE">
		DECLARE
			@GROUP_IDX NVARCHAR(50),
			@ORG_STATION NVARCHAR(50),
			@USER_ID NVARCHAR(50),
			@NNO NVARCHAR(50),
			@SUB_NO INT,
			@RACK_CODE NVARCHAR(50),
			@TRK_COM NVARCHAR(50),
			@TRK_NO NVARCHAR(50),
			@WH_IN_DATE NVARCHAR(10),
			@WH_IN_WO_CTN INT,
			@WH_IN_WF_CTN INT,
			@REMARK NVARCHAR(500),
			@WTA FLOAT, 
			@WIDTH  FLOAT ,
			@HEIGHT FLOAT,
			@LENGTH FLOAT,
			@PER INT,
			@WT_UNIT NVARCHAR(2),
			@DIM_UNIT NVARCHAR(2), 
			@W_USER_ID NVARCHAR(50),
			@W_USER_IP NVARCHAR(50),
			@RST_STATUS NVARCHAR(50) ,
			@RST_CODE NVARCHAR(50) ,
			@RST_MSG NVARCHAR(100) ,
			@RST_NNO NVARCHAR(50) ,
			@RST_SUB_NO INT ,
			@RST_IDX NVARCHAR(50) 
			
			
		SET @GROUP_IDX = ''
		SET @ORG_STATION = #{orgStation}
		SET @USER_ID = #{userId}
		SET @NNO = #{nno}
		SET @SUB_NO = #{subNo}
		SET @RACK_CODE = #{rackCode}
		SET @TRK_COM = #{trkCom}
		SET @TRK_NO = #{trkNo}
		SET @WH_IN_DATE = #{whInDate} /*입고일*/
		SET @WH_IN_WO_CTN = #{addPassCnt} /*정상 입고*/
		SET @WH_IN_WF_CTN = #{addFailCnt} /*검수불합격 수량*/
		SET @REMARK = #{whMemo} /*비고*/
		SET @WTA = #{wta}
		SET @WIDTH  = #{width}
		SET @HEIGHT = #{height}
		SET @LENGTH = #{length}
		SET @PER = #{per}
		SET @WT_UNIT = #{wtUnit}
		SET @DIM_UNIT = #{dimUnit}
		SET @W_USER_ID = #{wUserId}
		SET @W_USER_IP = #{wUserIp}
			
		EXEC SP_INSP_STOCK_ADD_IN
			@GROUP_IDX ,
			@ORG_STATION ,
			@USER_ID ,
			@NNO ,
			@SUB_NO ,
			@RACK_CODE ,
			@TRK_COM ,
			@TRK_NO ,
			@WH_IN_DATE ,
			@WH_IN_WO_CTN ,
			@WH_IN_WF_CTN ,
			@REMARK ,
			@WTA , 
			@WIDTH ,
			@HEIGHT ,
			@LENGTH,
			@PER ,
			@WT_UNIT,
			@DIM_UNIT, 
			@W_USER_ID,
			@W_USER_IP,
			@RST_STATUS OUTPUT,
			@RST_CODE OUTPUT,
			@RST_MSG OUTPUT,
			@RST_NNO OUTPUT,
			@RST_SUB_NO OUTPUT,
			@RST_IDX OUTPUT
			
			
		SELECT 
			@RST_STATUS AS rstStatus,
			@RST_CODE AS rstCode,
			@RST_MSG AS rstMsg,
			@RST_NNO AS rstNno,
			@RST_SUB_NO AS rstSubSo,
			@RST_IDX as rstIdx;
	
	</select>
	
	<select id="selectNNOByHawbNo" parameterType="String" resultType="String">
		SELECT nno FROM TB_ORDER_LIST WHERE HAWB_NO = (SELECT ISNULL((SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO = #{hawbNo}),#{hawbNo}));
	</select>
	
	<select id="selectExpCom" parameterType="String" resultType="String">
		select EXP_BUSINESS_NAME FROM TB_EXPLICENCE WHERE EXP_REG_NO = #{hawbNo}
		UNION ALL
		select EXP_BUSINESS_NAME FROM TB_EXPLICENCE WHERE EXP_REG_NO = (SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO = #{hawbNo}) 
	</select>
	
	<select id="selectExpBusinessInfo" parameterType="String" resultType="hashMap">
		select EXP_BUSINESS_NAME as expBusinessName, AGENCY_BUSINESS_NAME as agencyBusinessName FROM TB_EXPLICENCE WHERE EXP_REG_NO = #{hawbNo}
		UNION ALL
		select EXP_BUSINESS_NAME as expBusinessName, AGENCY_BUSINESS_NAME as agencyBusinessName FROM TB_EXPLICENCE WHERE EXP_REG_NO = (SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO = #{hawbNo}) 
	</select>
	
	<select id="expLicenceChk" parameterType="com.example.temp.manager.vo.HawbVO" resultType="Integer">
		SELECT COUNT(*) FROM TB_EXPLICENCE WHERE NNO = (
			SELECT ISNULL((SELECT NNO FROM TB_ORDER_LIST WHERE HAWB_NO = #{hawbNo}),(SELECT NNO FROM TB_ORDER_LIST WHERE HAWB_NO = (SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO = #{hawbNo})))
		) AND SIMPLE_YN='N' AND SEND_YN IN ('N', 'F')
		and ISNULL(EXP_VALUE,'') != 'simpleExplicence';
	</select>
	
	<select id="expLicenceChk2" parameterType="String" resultType="Integer">
		SELECT COUNT(*) FROM TB_EXPLICENCE WHERE NNO = (
			SELECT ISNULL((SELECT NNO FROM TB_ORDER_LIST WHERE HAWB_NO = #{hawbNo}),(SELECT NNO FROM TB_ORDER_LIST WHERE HAWB_NO = (SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO = #{hawbNo})))
		);
	</select>
	<select id="selectNotSendEfsInfo" parameterType="String" resultType="String">
		select NNO FROM TB_EXPLICENCE WHERE (EXP_NO != '' AND EXP_NO IS NOT NULL) AND SEND_YN = 'N' AND NNO IN (SELECT NNO FROM TB_ORDER_LIST WHERE TRANS_CODE = 'EFS');
	</select>
	
	<!-- zone start -->
	<select id="selectDstnList" parameterType="String" resultType="String">
		SELECT DSTN_NATION FROM TB_USER_TRANS_COM WHERE USER_ID = #{userId} and ORG_NATION = #{orgNation}
	</select>
	<!-- zone end -->
	<insert id="insertDlvPrice" parameterType="com.example.temp.manager.vo.DlvPriceVO">
		INSERT INTO
		    TB_STATION_DLV_PRICE (
		        ORG_STATION,
		        ORG_NATION,
		        DSTN_NATION,
		        ZONE_CODE,
		        WT,
		        WT_UNIT,
		        PRICE,
		        W_USER_ID,
		        W_USER_IP,
		        DLV_PRICE_NAME,
		        DLV_CODE,
		        CURRENCY
		    )
		VALUES
		    (
		        #{orgStation},
		        (SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = #{orgStation}),
		        #{dstnNation},
		        #{zoneCode},
		        #{wt},
		        #{wtUnit},
		        #{price},
		        #{wUserId},
		        #{wUserIp},
		        #{dlvPriceName},
		        #{dlvCode},
		        #{currency}
		    );
	</insert>
	<update id="updateCustoerInvoice" parameterType="hashMap">
		UPDATE TB_CUSTOMER SET INVOICE_NATION = #{invoiceStation}, CURRENCY = #{currency} WHERE USER_ID = #{userId}
	</update>
	
	<update id="updateCustomerEtcFee" parameterType="hashMap">
		UPDATE TB_CUSTOMER_CHG_INFO SET 
			SURCHARGE_TYPE = #{surchargeType}, 
			FUEL_SURCHARGE = #{fuelSurcharge},
			CLEARANCE_FEE = #{clearanceFee}, 
			CASE_FEE = #{caseFee},
			EXPORT_DECL_FEE = #{exportDeclFee},
			W_DATE = getDate(),
			SURCHARGE_TYPE2 = #{surchargeType2},
			SURCHARGE = #{surcharge},
			FUEL_WT_UNIT = #{fuelWtUnit},
			SUR_WT_UNIT = #{surWtUnit}
		WHERE USER_ID = #{userId} AND DSTN_NATION = #{etcArea}
	</update>
	
	<select id="selectInvoiceName" resultType="com.example.temp.manager.vo.DlvPriceVO">
		SELECT DISTINCT(DLV_PRICE_NAME), DLV_CODE from TB_STATION_DLV_PRICE WHERE DLV_CODE IS NOT NULL AND DLV_CODE NOT LIKE '%INDIVIDUAL' AND DLV_PRICE_NAME IS NOT NULL
	</select>
	<select id="selectStationInfo" resultType="com.example.temp.manager.vo.NationVO">
		SELECT STATION_CODE, STATION_NAME FROM TB_STATION;
	</select>
	<select id="selectMenualDstnList" parameterType="String" resultType="String">
		SELECT DSTN_NATION from TB_USER_TRANS_COM WHERE USER_ID = #{userId} AND DSTN_NATION NOT IN (
		SELECT DSTN_NATION FROM TB_CUSTOMER_CHG_INFO WHERE USER_ID = #{userId} and DVL_CHG_TYPE != 'MENUAL') 
		AND ORG_NATION = (SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = #{orgStation});
	</select>
	
	<delete id="deleteCustomerChgInfo" parameterType="hashMap">
		DELETE FROM TB_CUSTOMER_CHG_INFO WHERE DVL_CHG_TYPE = 'Menual' and USER_ID=#{userId} AND ORG_STATION = #{orgStation};
	</delete>
	
	<insert id="insertCustomerChgInfo" parameterType="hashMap">
		INSERT INTO TB_CUSTOMER_CHG_INFO (
			ORG_STATION, [USER_ID], VOLUME_DISCOUNT, W_USER_ID, W_USER_IP, W_DATE, DVL_CHG_TYPE, DSTN_NATION, DLV_CODE, ACTUAL_DISCOUNT,
			STOCK_PICK_UP_TYPE, STOCK_PICK_UP_BASIC, STOCK_PICK_UP_CHARGE, STOCK_PICK_UP_PER_CHARGE)
			VALUES ( #{orgStation}, #{userId}, #{volumeDiscount}, #{wUserId}, #{wUserIp}, getDate(), #{dvlChgType}, #{dstnNation}, #{dlvCode}, #{actualDiscount}, 
			'', '', '', '');
	</insert>
	
	<insert id="insertCustomerChgInfoIndividual" parameterType="hashMap">
		DELETE FROM TB_CUSTOMER_CHG_INFO WHERE USER_ID = #{userId} AND ORG_STATION = #{orgStation} AND DSTN_NATION = #{dstnNation};
	
		INSERT INTO TB_CUSTOMER_CHG_INFO (
			ORG_STATION, [USER_ID], VOLUME_DISCOUNT, W_USER_ID, W_USER_IP, W_DATE, DVL_CHG_TYPE, DSTN_NATION, DLV_CODE, ACTUAL_DISCOUNT,
			STOCK_PICK_UP_TYPE, STOCK_PICK_UP_BASIC, STOCK_PICK_UP_CHARGE, STOCK_PICK_UP_PER_CHARGE)
			VALUES ( #{orgStation}, #{userId}, #{volumeDiscount}, #{wUserId}, #{wUserIp}, getDate(), #{dvlChgType}, #{dstnNation}, #{dlvCode}, #{actualDiscount}, 
			'', '', '', '');
	</insert>
	
	<update id="updateCustomerChgInfo" parameterType="hashMap">
		UPDATE TB_CUSTOMER_CHG_INFO SET 
			DVL_CHG_TYPE = #{dvlChgType}, 
			VOLUME_DISCOUNT = #{volumeDiscount}, 
			ACTUAL_DISCOUNT = #{actualDiscount},
			W_DATE = getDate()
		WHERE USER_ID = #{userId} AND DSTN_NATION = #{dstnNation}
	</update>
	
	<update id="resetCustomerChgInfo" parameterType="hashMap">
		UPDATE TB_CUSTOMER_CHG_INFO SET 
			DVL_CHG_TYPE = 'Menual', 
			VOLUME_DISCOUNT = (SELECT TOP 1 VOLUME_DISCOUNT FROM TB_CUSTOMER_CHG_INFO WHERE USER_ID = #{userId} AND ORG_STATION = #{orgStation} AND DVL_CHG_TYPE = 'Menual'), 
			ACTUAL_DISCOUNT = (SELECT TOP 1 ACTUAL_DISCOUNT FROM TB_CUSTOMER_CHG_INFO WHERE USER_ID = #{userId} AND ORG_STATION = #{orgStation} AND DVL_CHG_TYPE = 'Menual'),
			DLV_CODE = (SELECT TOP 1 DLV_CODE FROM TB_CUSTOMER_CHG_INFO WHERE USER_ID = #{userId} AND ORG_STATION = #{orgStation} AND DVL_CHG_TYPE = 'Menual'),
			W_DATE = getDate()
		WHERE USER_ID = #{userId} AND ORG_STATION = #{orgStation} and DVL_CHG_TYPE = 'Individual'
		<if test='dstnNation != null and dstnNation != ""'>
			AND DSTN_NATION = #{dstnNation}
		</if>
	</update>
	
	<select id="selectDlvChgInfo" parameterType="String" resultType="com.example.temp.manager.vo.DlvChgInfoVO">
		select
		    DSTN_NATION,
		    ACTUAL_DISCOUNT,
		    VOLUME_DISCOUNT,
		    (SELECT CURRENCY FROM TB_CUSTOMER WHERE USER_ID = F1.USER_ID) AS CURRENCY,
		    (
		        select
		            TOP 1 DLV_PRICE_NAME
		        from
		            TB_STATION_DLV_PRICE F2
		        where
		            F2.DLV_CODE = F1.DLV_CODE
		    ) as DLV_PRICE_NAME,
		    F1.DLV_CODE,
		    DVL_CHG_TYPE,
		    ISNULL(SURCHARGE_TYPE,'') AS SURCHARGE_TYPE,
		    ISNULL(CLEARANCE_FEE,'') AS CLEARANCE_FEE,
		    ISNULL(CASE_FEE,'') AS CASE_FEE,
		    ISNULL(FUEL_SURCHARGE,'') AS FUEL_SURCHARGE,
		    ISNULL(EXPORT_DECL_FEE,'') as EXPORT_DECL_FEE ,
		    ISNULL(SURCHARGE_TYPE2,'0') AS SURCHARGE_TYPE2,
		    ISNULL(SURCHARGE,'0') AS SURCHARGE,
		    ISNULL(FUEL_WT_UNIT,'0') AS FUEL_WT_UNIT,
		    ISNULL(SUR_WT_UNIT,'0') AS SUR_WT_UNIT
		from
		    TB_CUSTOMER_CHG_INFO F1 WHERE USER_ID = #{userId} and ORG_STATION=#{orgStation};
	</select>
	<select id="selectHawbTrans" parameterType="String" resultType="hashMap">
		SELECT 
			DISTINCT(TRANS_CODE) AS transCode,
			(SELECT TRANS_NAME FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE) AS transName
		 FROM TB_HAWB F1 WHERE ISNULL(MAWB_NO,'') = '' AND ORG_STATION=#{orgStation};
	</select>
	<select id="selectSekoHawb" parameterType="String" resultType="String">
		select ISNULL(TRANS_CODE,'') FROM TB_ORDER_LIST WHERE HAWB_NO =#{hawbNo}
	</select>
	
	<insert id="insertMawbArr" parameterType="com.example.temp.manager.vo.MawbVO">
		INSERT INTO TB_MAWB_ARR (
			MAWB_NO, 
			NNO, 
			HAWB_NO, 
			INSPECTOR, 
			REMARKS, 
			W_USER_ID, 
			W_USER_IP, 
			W_DATE,
			U_DATE,
			USER_DATE,
			ORG_STATION
		)VALUES ( 
			(SELECT MAWB_NO FROM TB_HAWB WHERE HAWB_NO = #{hawbNo}), 
			(SELECT NNO FROM TB_HAWB WHERE HAWB_NO = #{hawbNo}), 
			#{hawbNo}, 
			'',
			'', 
			#{wUserId}, 
			#{wUserIp}, 
			GETDATE(),
			'',
			'',
			#{orgStation}
		);
	</insert>
	
	<select id="checkMawbArr" parameterType="String" resultType="hashMap">
		SELECT
			ISNULL((select NNO FROM TB_MAWB_ARR WHERE HAWB_NO = #{hawbNo}),'N') AS alreadyInsert,
			ISNULL((select NNO FROM TB_HAWB WHERE HAWB_NO = #{hawbNo}),'N') AS hawbNoYn;
	</select>
	
	<select id="selectMawbArrInfo" parameterType="String" resultType="hashMap">
		SELECT 
			MAWB_NO as mawbNo,
			NNO as nno,
			HAWB_NO as hawbNo,
			INSPECTOR as inspector,
			REMARKS as remarks,
			W_DATE as wDate,
			U_DATE as uDate,
			USER_DATE as userDate,
			(SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE = ORG_STATION) AS orgStation,
			(SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = ORG_STATION) AS nationCode
		FROM TB_MAWB_ARR WHERE HAWB_NO = #{hawbNo}
	</select>
	
	<select id="selectUdate" parameterType="hashMap" resultType="String">
		SELECT U_DATE FROM TB_MAWB_ARR WHERE NNO = #{nno}
	</select>
	
	<update id="updateMawbArr" parameterType="hashMap">
		UPDATE TB_MAWB_ARR SET
			INSPECTOR = #{inspector},
			REMARKS = #{remarks},
			<if test='uDate == ""'>
				U_DATE = GETDATE(),
			</if>
			CH_TRK_COM = #{chTrkCom},
			CH_TRK_NO = #{chTrkNo},
			USER_DATE = #{userDate}			
		WHERE NNO = #{nno}
	</update>
	
	<select id="selectDistinctBlList" resultType="String">
		select DISTINCT(BL_TYPE) FROM TB_BL_LIST
	</select>
	<select id="selectPerDimByHawb" parameterType= "String" resultType="hashMap">
		SELECT 
			PER_DIM AS perDim, 
			DIM_UNIT AS dimUnit
		FROM TB_TRANS_COM WHERE TRANS_CODE = (SELECT TRANS_CODE FROM TB_ORDER_LIST WHERE HAWB_NO = #{hawbNo})
	</select>
	
	<insert id="insertWebHookList" parameterType="hashMap">
		INSERT INTO TB_WEBHOOK_LIST (
			[USER_ID], DIV, DIV_KR, URL, W_USER_ID, W_USER_IP
		) VALUES (
			#{userId},#{webHookDiv},#{divKr},#{webHookUrl},#{wUserId},#{wUserIp}
		)
	</insert>
	
	<delete id="deleteWebHookList" parameterType="hashMap">
		DELETE FROM TB_WEBHOOK_LIST WHERE USER_ID = #{userId}
	</delete>
	
	<select id="selectExpNoYsl" resultType="String">
		SELECT NNO FROM TB_EXP_DCL 
		WHERE NNO IN (SELECT NNO FROM TB_ORDER_LIST WHERE TRANS_CODE = 'YSL')
			AND EXP_TYPE IN ('S', 'F') AND ISNULL(EXP_NO,'') != '' AND SEND_YN IN ('N', 'F');
	</select>
	
	
	<select id ="selectExpLicenceYsl" resultType="String">
			SELECT 
				NNO 
			FROM 
				TB_EXPLICENCE 
			WHERE 
				NNO IN 
			(
				SELECT 
						NNO 
					FROM 
						TB_HAWB 
					WHERE 
						ISNULL(MAWB_NO,'')!='' AND TRANS_CODE = 'YSL'
			) 
			AND EXP_VALUE IN ('registExplicence1', 'registExplicence2')
			AND ISNULL(EXP_NO,'') != ''
			AND SEND_YN = 'M'
	</select>
	
	<select id="selectExpNoFB" resultType="String">
		SELECT NNO FROM TB_EXP_DCL 
		WHERE NNO IN (SELECT NNO FROM TB_ORDER_LIST WHERE TRANS_CODE IN ('FB', 'FB-EMS'))
			AND EXP_TYPE IN ('S', 'F') AND ISNULL(EXP_NO,'') != '' AND SEND_YN IN ('N', 'F');
	</select>
	
	<select id="selectExpLicenceFB" resultType="String">
		SELECT
			NNO
		FROM TB_EXPLICENCE
		WHERE NNO IN (
				SELECT NNO
				FROM TB_HAWB
				WHERE ISNULL(MAWB_NO,'') != '' AND TRANS_CODE = 'FB'
				)
			AND EXP_VALUE IN ('registExplicence1', 'registExplicence2')
			AND ISNULL(EXP_NO,'') != ''
			AND SEND_YN = 'M'
	</select>
	
	<select id ="selectExpLicenceYslChk" parameterType="String" resultType="String">
		SELECT 
				NNO 
			FROM 
				TB_EXPLICENCE 
			WHERE 
				NNO IN 
			(
				SELECT 
						NNO 
					FROM 
						TB_HAWB 
					WHERE 
						ISNULL(MAWB_NO,'')!='' AND TRANS_CODE = 'YSL'
			) 
			AND EXP_VALUE IN ('registExplicence1', 'registExplicence2') 
			AND ISNULL(EXP_NO,'') != '' 
			AND SEND_YN = 'M'
			AND NNO = #{nno}
	</select>
	
	<select id="selectStockOutListCnt" resultType="Integer" parameterType="hashMap">
		DECLARE
			@DEP_MONTH NVARCHAR(10),
			@USER_ID NVARCHAR(50),
			@ORG_STATION NVARCHAR(50),
			@FROM_DATE NVARCHAR(10),
			@TO_DATE NVARCHAR(10)
		SET @DEP_MONTH = #{depMonth}
		SET @USER_ID = #{searchUserId}
		SET @ORG_STATION = #{orgStation}
		SET @FROM_DATE = #{fromDate}
		SET @TO_DATE = #{toDate}
		
		SELECT COUNT(*) FROM (
			SELECT
				ORG_STATION,
				(SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE = M1.ORG_STATION) STATION_NAME,
				DEP_MONTH,
				(CASE WHEN ISNULL(@USER_ID,'') = '' THEN '' ELSE @USER_ID END) USER_ID,
				SUM(CNT) CNT
			FROM (
				SELECT
					ORG_STATION,
					(SELECT SUBSTRING(DEP_DATE,1,6) FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DEP_MONTH,
					COUNT(*) CNT
				FROM TB_HAWB F1
				WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB A1 WHERE SUBSTRING(DEP_DATE,1,6) = (CASE WHEN ISNULL(@DEP_MONTH,'') = '' THEN SUBSTRING(DEP_DATE,1,6) ELSE @DEP_MONTH END)
					AND DEP_DATE BETWEEN (CASE WHEN ISNULL(@FROM_DATE,'') = '' THEN DEP_DATE ELSE @FROM_DATE END) AND (CASE WHEN ISNULL(@TO_DATE,'') = '' THEN DEP_DATE ELSE @TO_DATE END))
					AND ISNULL(MAWB_NO,'') != ''
					AND ISNULL((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),'') != ''
					AND USER_ID = (CASE WHEN ISNULL(@USER_ID,'') = '' THEN USER_ID ELSE @USER_ID END)
					AND ORG_STATION = (CASE WHEN ISNULL(@ORG_STATION,'') = '' THEN ORG_STATION ELSE @ORG_STATION END)
					<if test='dlvType != "" and dlvType == "In"'>
						AND DSTN_NATION = 'KR'
					</if>
					<if test='dlvType != "" and dlvType == "Out"'>
						AND DSTN_NATION != 'KR'
					</if>
				GROUP BY ORG_STATION, MAWB_NO
			) M1
			GROUP BY ORG_STATION, DEP_MONTH
		) f
	
	</select>
	
	<select id="selectStockOutList" resultType="com.example.temp.manager.vo.StockOutVO" parameterType="hashMap">
		DECLARE
			@DEP_MONTH NVARCHAR(10),
			@USER_ID NVARCHAR(50),
			@ORG_STATION NVARCHAR(50),
			@FROM_DATE NVARCHAR(10),
			@TO_DATE NVARCHAR(10)
		SET @DEP_MONTH = #{depMonth}
		SET @USER_ID = #{searchUserId}
		SET @ORG_STATION = #{orgStation}
		SET @FROM_DATE = #{fromDate}
		SET @TO_DATE = #{toDate}
		SELECT * FROM (
			SELECT
				ROW_NUMBER() OVER(ORDER BY DEP_MONTH DESC) ROWNUM,
				ORG_STATION,
				(SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE = M1.ORG_STATION) STATION_NAME,
				DEP_MONTH,
				(CASE WHEN ISNULL(@USER_ID,'') = '' THEN '' ELSE @USER_ID END) USER_ID,
				SUM(CNT) CNT
			FROM (
				SELECT
					ORG_STATION,
					(SELECT SUBSTRING(DEP_DATE,1,6) FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DEP_MONTH,
					COUNT(*) CNT
				FROM TB_HAWB F1
				WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB A1 WHERE SUBSTRING(DEP_DATE,1,6) = (CASE WHEN ISNULL(@DEP_MONTH,'') = '' THEN SUBSTRING(DEP_DATE,1,6) ELSE @DEP_MONTH END)
					AND DEP_DATE BETWEEN (CASE WHEN ISNULL(@FROM_DATE,'') = '' THEN DEP_DATE ELSE @FROM_DATE END) AND (CASE WHEN ISNULL(@TO_DATE,'') = '' THEN DEP_DATE ELSE @TO_DATE END))
					AND ISNULL(MAWB_NO,'') != ''
					AND ISNULL((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),'') != ''
					AND USER_ID = (CASE WHEN ISNULL(@USER_ID,'') = '' THEN USER_ID ELSE @USER_ID END)
					AND ORG_STATION = (CASE WHEN ISNULL(@ORG_STATION,'') = '' THEN ORG_STATION ELSE @ORG_STATION END)
					<if test='dlvType != "" and dlvType == "In"'>
						AND DSTN_NATION = 'KR'
					</if>
					<if test='dlvType != "" and dlvType == "Out"'>
						AND DSTN_NATION != 'KR'
					</if>
				GROUP BY ORG_STATION, MAWB_NO
			) M1
			GROUP BY ORG_STATION, DEP_MONTH
		) F WHERE F.ROWNUM BETWEEN #{paging.boardStart} and #{paging.boardEnd}
	</select>
	
	<select id="stockOutListByMonth" parameterType="hashMap" resultType="com.example.temp.manager.vo.StockOutVO">
		DECLARE
			@DEP_MONTH NVARCHAR(10),
			@USER_ID NVARCHAR(50),
			@ORG_STATION NVARCHAR(50)
		SET @DEP_MONTH = #{depMonth}
		SET @USER_ID = #{userId}
		SET @ORG_STATION = #{orgStation}
		
		SELECT UPPER(USER_ID) AS USER_ID,DEP_MONTH , ORG_STATION, SUM(CNT) CNT
		 FROM (
			 SELECT USER_ID ,
			        SUBSTRING((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),1,6) DEP_MONTH,
			        ORG_STATION,
			        COUNT(*) CNT
			  FROM TB_HAWB F1
			  WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB WHERE SUBSTRING(DEP_DATE ,1,6) = #{depMonth})
			    AND USER_ID =  (CASE WHEN ISNULL(@USER_ID,'') = '' THEN USER_ID ELSE @USER_ID END)
			    AND ORG_STATION = #{orgStation}
			    <if test='dlvType != "" and dlvType == "In"'>
					AND DSTN_NATION = 'KR'
				</if>
				<if test='dlvType != "" and dlvType == "Out"'>
					AND DSTN_NATION != 'KR'
				</if>
			  GROUP BY ORG_STATION , USER_ID , MAWB_NO
			  ) M1 
		 GROUP BY USER_ID,DEP_MONTH, ORG_STATION
	</select>
	
	<select id="stockOutListByMonthExcel" parameterType="hashMap" resultType="com.example.temp.manager.vo.StockOutVO">
		DECLARE
			@DEP_MONTH NVARCHAR(10),
			@USER_ID NVARCHAR(50),
			@ORG_STATION NVARCHAR(50)
		SET @DEP_MONTH = #{depMonth}
		SET @USER_ID = ''
		SET @ORG_STATION = #{orgStation}
		
		SELECT UPPER(USER_ID) AS USER_ID,DEP_MONTH , ORG_STATION, SUM(CNT) CNT
		 FROM (
			 SELECT USER_ID ,
			        SUBSTRING((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),1,6) DEP_MONTH,
			        ORG_STATION,
			        COUNT(*) CNT
			  FROM TB_HAWB F1
			  WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB WHERE SUBSTRING(DEP_DATE ,1,6) = #{depMonth})
			    AND USER_ID =  (CASE WHEN ISNULL(@USER_ID,'') = '' THEN USER_ID ELSE @USER_ID END)
			    AND ORG_STATION = #{orgStation}
			  GROUP BY ORG_STATION , USER_ID , MAWB_NO
			  ) M1 
		 GROUP BY USER_ID,DEP_MONTH, ORG_STATION
	</select>
	
	<select id="selectStockOutByUserId" parameterType="com.example.temp.manager.vo.StockOutVO" resultType="com.example.temp.manager.vo.StockOutVO">
		DECLARE
			@DEP_MONTH NVARCHAR(10),
			@ORG_STATION NVARCHAR(50)
		SET @DEP_MONTH = #{depMonth}
		SET @ORG_STATION = #{orgStation}
		
		SELECT UPPER(USER_ID) as USER_ID,
				@DEP_MONTH as DepMonth, 
				@ORG_STATION as orgStation,
		       (SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DEP_DATE,
		       COUNT(*) CNT
		  FROM TB_HAWB F1
		 WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB WHERE ORG_STATION = #{orgStation} AND SUBSTRING(DEP_DATE,1,6) = #{depMonth})
		   AND USER_ID = #{userId}
		   AND ORG_STATION = #{orgStation}
		   <if test='dlvType != "" and dlvType == "In"'>
				AND DSTN_NATION = 'KR'
			</if>
			<if test='dlvType != "" and dlvType == "Out"'>
				AND DSTN_NATION != 'KR'
			</if>
		GROUP BY USER_ID , 
		         MAWB_NO
		ORDER BY USER_ID , (SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DESC
	</select>
	
	<select id="selectStationCodeList" parameterType="hashMap" resultType="hashMap">
		SELECT STATION_CODE as orgStation
		FROM TB_STATION
	</select>
	
	<select id="selectStockOutListChart" resultType="com.example.temp.manager.vo.StockOutVO" parameterType="com.example.temp.manager.vo.StockOutVO">
		DECLARE
			@DEP_MONTH NVARCHAR(10),
			@USER_ID NVARCHAR(50),
			@ORG_STATION NVARCHAR(50),
			@FROM_DATE NVARCHAR(10),
			@TO_DATE NVARCHAR(10)
		SET @DEP_MONTH = #{depMonth}
		SET @USER_ID = #{searchUserId}
		SET @ORG_STATION = #{orgStation}
		SET @FROM_DATE = #{fromDate}
		SET @TO_DATE = #{toDate}
		SELECT * FROM (
			SELECT
				ROW_NUMBER() OVER(ORDER BY DEP_MONTH ASC) ROWNUM,
				ORG_STATION,
				(SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE = M1.ORG_STATION) STATION_NAME,
				DEP_MONTH,
				(CASE WHEN ISNULL(@USER_ID,'') = '' THEN '' ELSE @USER_ID END) USER_ID,
				SUM(CNT) CNT
			FROM (
				SELECT
					ORG_STATION,
					(SELECT SUBSTRING(DEP_DATE,1,6) FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DEP_MONTH,
					COUNT(*) CNT
				FROM TB_HAWB F1
				WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB A1 WHERE SUBSTRING(DEP_DATE,1,6) = (CASE WHEN ISNULL(@DEP_MONTH,'') = '' THEN SUBSTRING(DEP_DATE,1,6) ELSE @DEP_MONTH END)
					AND DEP_DATE BETWEEN (CASE WHEN ISNULL(@FROM_DATE,'') = '' THEN DEP_DATE ELSE @FROM_DATE END) AND (CASE WHEN ISNULL(@TO_DATE,'') = '' THEN DEP_DATE ELSE @TO_DATE END))
					AND ISNULL(MAWB_NO,'') != ''
					AND ISNULL((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),'') != ''
					AND USER_ID = (CASE WHEN ISNULL(@USER_ID,'') = '' THEN USER_ID ELSE @USER_ID END)
					AND ORG_STATION = (CASE WHEN ISNULL(@ORG_STATION,'') = '' THEN ORG_STATION ELSE @ORG_STATION END)
				GROUP BY ORG_STATION, MAWB_NO
			) M1
			GROUP BY ORG_STATION, DEP_MONTH
		) F
	</select>
	
	<select id="selectStockOutListExcel" resultType="com.example.temp.manager.vo.StockOutVO" parameterType="hashMap">
		DECLARE
			@DEP_MONTH NVARCHAR(10),
			@USER_ID NVARCHAR(50),
			@ORG_STATION NVARCHAR(50)
		SET @DEP_MONTH = #{depMonth}
		SET @USER_ID = #{userId}
		SET @ORG_STATION = #{orgStation}
		SELECT * FROM (
			SELECT
				ROW_NUMBER() OVER(ORDER BY DEP_MONTH DESC) ROWNUM,
				ORG_STATION,
				(SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE = M1.ORG_STATION) STATION_NAME,
				DEP_MONTH,
				(CASE WHEN ISNULL(@USER_ID,'') = '' THEN '' ELSE @USER_ID END) USER_ID,
				SUM(CNT) CNT
			FROM (
				SELECT
					ORG_STATION,
					(SELECT SUBSTRING(DEP_DATE,1,6) FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DEP_MONTH,
					COUNT(*) CNT
				FROM TB_HAWB F1
				WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB A1 WHERE SUBSTRING(DEP_DATE,1,6) = (CASE WHEN ISNULL(@DEP_MONTH,'') = '' THEN SUBSTRING(DEP_DATE,1,6) ELSE @DEP_MONTH END))
					AND ISNULL(MAWB_NO,'') != ''
					AND ISNULL((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),'') != ''
					AND USER_ID = (CASE WHEN ISNULL(@USER_ID,'') = '' THEN USER_ID ELSE @USER_ID END)
					AND ORG_STATION = (CASE WHEN ISNULL(@ORG_STATION,'') = '' THEN ORG_STATION ELSE @ORG_STATION END)
				GROUP BY ORG_STATION, MAWB_NO
			) M1
			GROUP BY ORG_STATION, DEP_MONTH
		) F
	</select>
	
	<select id="stockOutListByMonthExcel2" parameterType="com.example.temp.manager.vo.StockOutVO" resultType="com.example.temp.manager.vo.StockOutVO">
		DECLARE
			@USER_ID NVARCHAR(50),
			@ORG_STATION NVARCHAR(50),
			@FROM_DATE NVARCHAR(10),
			@TO_DATE NVARCHAR(10)
		SET @USER_ID = #{userId}
		SET @ORG_STATION = #{orgStation}
		SET @FROM_DATE = #{fromDate}
		SET @TO_DATE = #{toDate}
		
		SELECT USER_ID, DEP_MONTH , ORG_STATION, SUM(CNT) CNT
		FROM (
			 SELECT USER_ID ,
			        SUBSTRING((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),1,6) DEP_MONTH,
			        ORG_STATION,
			        COUNT(*) CNT
			  FROM TB_HAWB F1
			  WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB WHERE DEP_DATE BETWEEN (CASE WHEN ISNULL(@FROM_DATE,'') = '' THEN DEP_DATE ELSE @FROM_DATE END) AND (CASE WHEN ISNULL(@TO_DATE,'') = '' THEN DEP_DATE ELSE @TO_DATE END))
			    AND USER_ID =  (CASE WHEN ISNULL(@USER_ID,'') = '' THEN USER_ID ELSE @USER_ID END)
			    AND ORG_STATION = (CASE WHEN ISNULL(@ORG_STATION,'') = '' THEN ORG_STATION ELSE @ORG_STATION END)
			  GROUP BY ORG_STATION , USER_ID , MAWB_NO
			  ) M1 
		GROUP BY USER_ID,DEP_MONTH, ORG_STATION
		ORDER BY DEP_MONTH DESC
	</select>
	
	<select id="selectStockOutByUserId2" parameterType="com.example.temp.manager.vo.StockOutVO" resultType="com.example.temp.manager.vo.StockOutVO">
		DECLARE
			@USER_ID NVARCHAR(50),
			@ORG_STATION NVARCHAR(50),
			@FROM_DATE NVARCHAR(10),
			@TO_DATE NVARCHAR(10)
		SET @USER_ID = #{userId}
		SET @ORG_STATION = #{orgStation}
		SET @FROM_DATE = #{fromDate}
		SET @TO_DATE = #{toDate}
		
		SELECT USER_ID,
				ORG_STATION,
		       (SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DEP_DATE,
		       COUNT(*) CNT
		  FROM TB_HAWB F1
		 WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB WHERE DEP_DATE BETWEEN (CASE WHEN ISNULL(@FROM_DATE,'') = '' THEN DEP_DATE ELSE @FROM_DATE END) AND (CASE WHEN ISNULL(@TO_DATE,'') = '' THEN DEP_DATE ELSE @TO_DATE END))
		   AND USER_ID =  (CASE WHEN ISNULL(@USER_ID,'') = '' THEN USER_ID ELSE @USER_ID END)
		   AND ORG_STATION = (CASE WHEN ISNULL(@ORG_STATION,'') = '' THEN ORG_STATION ELSE @ORG_STATION END)
		GROUP BY USER_ID , 
		         MAWB_NO,
		         ORG_STATION
		ORDER BY USER_ID , (SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DESC
	</select>
	
	<select id="selectClickedChart" parameterType="hashMap" resultType="hashMap">
		SELECT
			ORG_STATION,
			(SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE = M1.ORG_STATION) STATION_NAME,
			DEP_DATE,
			SUM(CNT) CNT
		FROM
			(SELECT
				ORG_STATION,
				(SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO AND DEP_DATE LIKE #{depMonth}+'%') DEP_DATE,
				COUNT(*) CNT
			FROM
				TB_HAWB F1
			WHERE
				ORG_STATION = (SELECT STATION_CODE FROM TB_STATION WHERE STATION_NAME = #{stationName})
				AND ISNULL(MAWB_NO,'') != ''
				AND ISNULL((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),'') != ''
			GROUP BY 
				ORG_STATION, MAWB_NO
			) M1
		WHERE
			DEP_DATE != ''
		GROUP BY 
			ORG_STATION, DEP_DATE
		ORDER BY
			DEP_DATE ASC
	</select>
	
	<select id="selectInvoiceInfo" resultType="hashMap" parameterType="hashMap">
		SELECT
			CONVERT(NVARCHAR(10), GETDATE(), 112) AS DUE_DATE,
			ISNULL(MAX(STATION_ADDR),'') AS STATION_ADDR,
			ISNULL(MAX(STATION_TEL),'') AS STATION_TEL,
			MAX(INVOICE_NO) AS INVOICE_NO,
			MIN(INV_FROM_DATE) AS INV_FROM_DATE,
			MIN(INV_TO_DATE) AS INV_TO_DATE,
			CONVERT(DECIMAL(38,2),SUM(INV_AMT)) AS TOTAL_VALUE,
			MAX(COM_NAME) AS COM_NAME,
			MAX(USER_ADDR) AS USER_ADDR,
			MAX(USER_ADDR_DETAIL) AS USER_ADDR_DETAIL,
			MAX(USER_TEL) AS USER_TEL
		FROM
			TB_INVOICE F1,
			TB_STATION F2,
			TB_CUSTOMER F3
		WHERE
			F1.ORG_STATION = F2.STATION_CODE
			AND F1.USER_ID = F3.USER_ID
			AND F1.INVOICE_NO = #{invoiceNo}
			AND F1.USER_ID = #{userId}
			AND F1.ORG_STATION = #{orgStation}
	</select>
	
	<select id="selectUserStockOutList" resultType="com.example.temp.manager.vo.StockOutVO" parameterType="hashMap">
		DECLARE
			@DEP_MONTH NVARCHAR(10),
			@USER_ID NVARCHAR(50),
			@ORG_STATION NVARCHAR(50)
		SET @DEP_MONTH = #{depMonth}
		SET @USER_ID = #{userId}
		SET @ORG_STATION = #{orgStation}
		
		SELECT UPPER(USER_ID) AS USER_ID , ORG_STATION, SUM(CNT) CNT
		 FROM (
			 SELECT USER_ID ,
			        ORG_STATION,
			        COUNT(*) CNT
			  FROM TB_HAWB F1
			  WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB WHERE SUBSTRING(DEP_DATE ,1,6) = #{depMonth})
			    AND USER_ID =  (CASE WHEN ISNULL(@USER_ID,'') = '' THEN USER_ID ELSE @USER_ID END)
			    AND ORG_STATION = #{orgStation}
			  GROUP BY ORG_STATION , USER_ID , MAWB_NO
			  ) M1 
		 GROUP BY USER_ID, ORG_STATION
	</select>
	
	<select id="selectTransCodeFilter" resultType="hashMap" parameterType="hashMap">
		DECLARE
			@DEP_MONTH NVARCHAR(10),
			@USER_ID NVARCHAR(50),
			@ORG_STATION NVARCHAR(50),
			@FROM_DATE NVARCHAR(10),
			@TO_DATE NVARCHAR(10)
			
		SET @DEP_MONTH = #{depMonth}
		SET @USER_ID = #{searchUserId}
		SET @ORG_STATION = #{orgStation}
		SET @FROM_DATE = #{fromDate}
		SET @TO_DATE = #{toDate}
		
		SELECT * FROM (
			SELECT
				ROW_NUMBER() OVER(ORDER BY DEP_MONTH DESC) ROWNUM,
				ORG_STATION,
				(SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE = M1.ORG_STATION) STATION_NAME,
				TRANS_CODE,
				TRANS_NAME,
				DEP_MONTH,
				SUM(CNT) CNT
			FROM (
				SELECT
					ORG_STATION,
					(SELECT SUBSTRING(DEP_DATE,1,6) FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DEP_MONTH,
					TRANS_CODE,
					(SELECT TRANS_NAME FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE) TRANS_NAME,
					COUNT(*) CNT
				FROM TB_HAWB F1
				WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB A1 WHERE SUBSTRING(DEP_DATE,1,6) = (CASE WHEN ISNULL(@DEP_MONTH,'') = '' THEN SUBSTRING(DEP_DATE,1,6) ELSE @DEP_MONTH END)
					AND DEP_DATE BETWEEN (CASE WHEN ISNULL(@FROM_DATE,'') = '' THEN DEP_DATE ELSE @FROM_DATE END) AND (CASE WHEN ISNULL(@TO_DATE,'') = '' THEN DEP_DATE ELSE @TO_DATE END))
					AND ISNULL(MAWB_NO,'') != ''
					AND ISNULL((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),'') != ''
					AND USER_ID = (CASE WHEN ISNULL(@USER_ID,'') = '' THEN USER_ID ELSE @USER_ID END)
					AND ORG_STATION = (CASE WHEN ISNULL(@ORG_STATION,'') = '' THEN ORG_STATION ELSE @ORG_STATION END)
				GROUP BY ORG_STATION, MAWB_NO, TRANS_CODE
			) M1
			GROUP BY ORG_STATION, DEP_MONTH, TRANS_CODE, TRANS_NAME
		) F
	</select>
	
	<select id="selectTransCodeTotalCnt" parameterType="hashMap" resultType="Integer">
		DECLARE
			@DEP_MONTH NVARCHAR(10),
			@USER_ID NVARCHAR(50),
			@ORG_STATION NVARCHAR(50),
			@FROM_DATE NVARCHAR(10),
			@TO_DATE NVARCHAR(10)
			
		SET @DEP_MONTH = #{depMonth}
		SET @USER_ID = #{searchUserId}
		SET @ORG_STATION = #{orgStation}
		SET @FROM_DATE = #{fromDate}
		SET @TO_DATE = #{toDate}
		
		SELECT SUM(CNT) FROM (
			SELECT
				ROW_NUMBER() OVER(ORDER BY DEP_MONTH DESC) ROWNUM,
				ORG_STATION,
				(SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE = M1.ORG_STATION) STATION_NAME,
				TRANS_CODE,
				TRANS_NAME,
				DEP_MONTH,
				SUM(CNT) CNT
			FROM (
				SELECT
					ORG_STATION,
					(SELECT SUBSTRING(DEP_DATE,1,6) FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DEP_MONTH,
					TRANS_CODE,
					(SELECT TRANS_NAME FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE) TRANS_NAME,
					COUNT(*) CNT
				FROM TB_HAWB F1
				WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB A1 WHERE SUBSTRING(DEP_DATE,1,6) = (CASE WHEN ISNULL(@DEP_MONTH,'') = '' THEN SUBSTRING(DEP_DATE,1,6) ELSE @DEP_MONTH END)
					AND DEP_DATE BETWEEN (CASE WHEN ISNULL(@FROM_DATE,'') = '' THEN DEP_DATE ELSE @FROM_DATE END) AND (CASE WHEN ISNULL(@TO_DATE,'') = '' THEN DEP_DATE ELSE @TO_DATE END))
					AND ISNULL(MAWB_NO,'') != ''
					AND ISNULL((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),'') != ''
					AND USER_ID = (CASE WHEN ISNULL(@USER_ID,'') = '' THEN USER_ID ELSE @USER_ID END)
					AND ORG_STATION = (CASE WHEN ISNULL(@ORG_STATION,'') = '' THEN ORG_STATION ELSE @ORG_STATION END)
				GROUP BY ORG_STATION, MAWB_NO, TRANS_CODE
			) M1
			GROUP BY ORG_STATION, DEP_MONTH, TRANS_CODE, TRANS_NAME
		) F
	</select>
	
	<select id="selectInBoundCnt" parameterType="hashMap" resultType="Integer">
		SELECT ISNULL(SUM(CNT),0) AS CNT
		FROM (
			SELECT
				(SELECT SUBSTRING(DEP_DATE,1,6) FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DEP_MONTH,
				COUNT(*) CNT
			FROM TB_HAWB F1
			WHERE 
				MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB WHERE SUBSTRING(DEP_DATE,1,6) = (CASE WHEN ISNULL(#{depMonth},'') = '' THEN SUBSTRING(DEP_DATE,1,6) ELSE #{depMonth} END))
				AND ISNULL(MAWB_NO,'') != ''
				AND ISNULL((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),'') != ''
				AND DSTN_NATION = (SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = #{orgStation})
				AND ORG_STATION = #{orgStation}
			GROUP BY ORG_STATION, MAWB_NO
			) M1
	</select>
	
	<select id="selectOutBoundCnt" parameterType="hashMap" resultType="Integer">
		SELECT ISNULL(SUM(CNT),0) AS CNT
		FROM (
			SELECT
				(SELECT SUBSTRING(DEP_DATE,1,6) FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DEP_MONTH,
				COUNT(*) CNT
			FROM TB_HAWB F1
			WHERE 
				MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB WHERE SUBSTRING(DEP_DATE,1,6) = (CASE WHEN ISNULL(#{depMonth},'') = '' THEN SUBSTRING(DEP_DATE,1,6) ELSE #{depMonth} END))
				AND ISNULL(MAWB_NO,'') != ''
				AND ISNULL((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),'') != ''
				AND DSTN_NATION != (SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = #{orgStation})
				AND ORG_STATION = #{orgStation}
			GROUP BY ORG_STATION, MAWB_NO
			) M1
	</select>
	
	<select id="selectStockOutMonthlyList" resultType="com.example.temp.manager.vo.StockOutVO" parameterType="hashMap">
		DECLARE
			@DEP_MONTH NVARCHAR(10),
			@USER_ID NVARCHAR(50),
			@ORG_STATION NVARCHAR(50),
			@FROM_DATE NVARCHAR(10),
			@TO_DATE NVARCHAR(10)
		SET @DEP_MONTH = #{depMonth}
		SET @USER_ID = #{searchUserId}
		SET @ORG_STATION = #{orgStation}
		SET @FROM_DATE = #{fromDate}
		SET @TO_DATE = #{toDate}
		SELECT * FROM (
			SELECT
				ROW_NUMBER() OVER(ORDER BY DEP_MONTH ASC) ROWNUM,
				ORG_STATION,
				(SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE = M1.ORG_STATION) STATION_NAME,
				DEP_MONTH,
				(CASE WHEN ISNULL(@USER_ID,'') = '' THEN '' ELSE @USER_ID END) USER_ID,
				SUM(CNT) CNT
			FROM (
				SELECT
					ORG_STATION,
					(SELECT SUBSTRING(DEP_DATE,1,6) FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DEP_MONTH,
					COUNT(*) CNT
				FROM TB_HAWB F1
				WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB A1 WHERE SUBSTRING(DEP_DATE,1,6) = (CASE WHEN ISNULL(@DEP_MONTH,'') = '' THEN SUBSTRING(DEP_DATE,1,6) ELSE @DEP_MONTH END)
					AND DEP_DATE BETWEEN (CASE WHEN ISNULL(@FROM_DATE,'') = '' THEN DEP_DATE ELSE @FROM_DATE END) AND (CASE WHEN ISNULL(@TO_DATE,'') = '' THEN DEP_DATE ELSE @TO_DATE END))
					AND ISNULL(MAWB_NO,'') != ''
					AND ISNULL((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),'') != ''
					AND USER_ID = (CASE WHEN ISNULL(@USER_ID,'') = '' THEN USER_ID ELSE @USER_ID END)
					AND ORG_STATION = (CASE WHEN ISNULL(@ORG_STATION,'') = '' THEN ORG_STATION ELSE @ORG_STATION END)
				GROUP BY ORG_STATION, MAWB_NO
			) M1
			GROUP BY ORG_STATION, DEP_MONTH
		) F
	</select>
	
	<select id="selectDailyChart" parameterType="hashMap" resultType="hashMap">
		DECLARE
			@DEP_MONTH NVARCHAR(10),
			@ORG_STATION NVARCHAR(50)
		SET @DEP_MONTH = #{depMonth}
		SET @ORG_STATION = #{orgStation}
		
		SELECT DEP_DATE, sum(CNT) cnt
		FROM (SELECT UPPER(USER_ID) as USER_ID,
				@DEP_MONTH as DepMonth, 
				@ORG_STATION as orgStation,
		       (SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) DEP_DATE,
		       COUNT(*) CNT
		  FROM TB_HAWB F1
		 WHERE MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB WHERE ORG_STATION = @ORG_STATION AND SUBSTRING(DEP_DATE,1,6) = @DEP_MONTH)
		   AND ORG_STATION = @ORG_STATION
		GROUP BY USER_ID , 
		         MAWB_NO
		) m1
		GROUP BY DEP_DATE
		ORDER BY DEP_DATE
	</select>
	
	<select id="selectHawbNo" parameterType="String" resultType="String">
		SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO = #{value}
	</select>
	
	<select id="selectNNOByStockNo" parameterType="hashMap" resultType="String">
		select NNO from TB_STOCK where STOCK_NO = #{stockNo}
	</select>
	
	<select id="selectNoticeList" parameterType="hashMap" resultType="com.example.temp.common.vo.NoticeVO">
		SELECT TOP 5 *
		FROM (
			SELECT
				ROW_NUMBER() OVER(ORDER BY W_DATE DESC) ROWNUM,
				IDX,
				ISNULL(TITLE,'') AS TITLE,
				ISNULL(CONTENTS,'') AS CONTENTS,
				ISNULL(SUBSTRING(CONVERT(NVARCHAR,W_DATE,120),1,10),'') AS W_DATE,
				ISNULL(W_USER_ID,'') AS W_USER_ID,
				ISNULL(DSTN_STATION,'') AS DSTN_STATION,
				ISNULL(ORG_STATION,'') AS ORG_STATION	
			FROM TB_NOTICE
			WHERE DSTN_STATION IN ('ALL', (SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = #{orgStation}))
		) M1
		ORDER BY ROWNUM
	</select>
	
	<select id="selectMawbManifestListCnt" resultType="Integer" parameterType="hashMap">
		SELECT COUNT(*)
		FROM (
		SELECT
			ROW_NUMBER() OVER(ORDER BY F1.W_DATE DESC) AS ROWNUM,
			MAWB_NO AS mawbNo, 
			DSTN_STATION AS dstnStation, 
			W_DATE AS wDate, 
			(SELECT COUNT(*) FROM TB_HAWB WHERE MAWB_NO = F1.MAWB_NO) AS hawbNo,
			(SELECT SUM(COUNT)
			FROM (SELECT
					CASE
						WHEN NNO IN (SELECT NNO FROM TB_ORDER_LIST_UP) OR NNO IN (SELECT NNO FROM TB_ORDER_ITEM_UP) THEN 1
						ELSE 0
					END COUNT
				FROM (
					SELECT NNO
					FROM TB_HAWB
					WHERE MAWB_NO = F1.MAWB_NO
				) T1
			) A1 ) AS hawbNoNew
		FROM TB_MAWB F1
		WHERE TRANS_CODE = 'ACI-US' AND (SELECT COUNT(HAWB_NO) FROM TB_HAWB WHERE MAWB_NO = F1.MAWB_NO) != '0'
			<if test="mawbNo != null and mawbNo != ''">
				AND MAWB_NO LIKE CONCAT ('%', #{mawbNo}, '%')
			</if>
		) M1
	</select>
	
	<select id="selectMawbManifestList" resultType="hashMap" parameterType="hashMap">
		SELECT *
		FROM (
		SELECT
			ROW_NUMBER() OVER(ORDER BY F1.W_DATE DESC) AS ROWNUM,
			MAWB_NO AS mawbNo, 
			DSTN_STATION AS dstnStation, 
			W_DATE AS wDate, 
			(SELECT COUNT(*) FROM TB_HAWB WHERE MAWB_NO = F1.MAWB_NO) AS hawbNo,
			(SELECT SUM(COUNT)
			FROM (SELECT
					CASE
						WHEN NNO IN (SELECT NNO FROM TB_ORDER_LIST_UP) OR NNO IN (SELECT NNO FROM TB_ORDER_ITEM_UP) THEN 1
						ELSE 0
					END COUNT
				FROM (
					SELECT NNO
					FROM TB_HAWB
					WHERE MAWB_NO = F1.MAWB_NO
				) T1
			) A1 ) AS hawbNoNew
		FROM TB_MAWB F1
		WHERE TRANS_CODE = 'ACI-US' AND (SELECT COUNT(HAWB_NO) FROM TB_HAWB WHERE MAWB_NO = F1.MAWB_NO) != '0'
			<if test="mawbNo != null and mawbNo != ''">
				AND MAWB_NO LIKE CONCAT ('%', #{mawbNo}, '%')
			</if>
		) M1
		WHERE M1.ROWNUM BETWEEN #{paging.boardStart} AND #{paging.boardEnd}
		ORDER BY ROWNUM
	</select>
	
	<select id="selectOrderInfo" parameterType="hashMap" resultType="com.example.temp.member.vo.UserOrderListVO">
		SELECT
			M2.NNO,
			M2.ORG_STATION,
			M2.USER_ID,
			CASE
				WHEN ISNULL((SELECT ORDER_NO FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO),'') = '' THEN (SELECT ORDER_NO FROM TB_ORDER_LIST WHERE NNO = M2.NNO)
				ELSE (SELECT ORDER_NO FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO)
			END ORDER_NO,
			CASE
				WHEN ISNULL((SELECT ORDER_DATE FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO),'') = '' THEN (SELECT ORDER_DATE FROM TB_ORDER_LIST WHERE NNO = M2.NNO)
				ELSE (SELECT ORDER_DATE FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO)
			END ORDER_DATE,
			CASE
				WHEN ISNULL((SELECT SHIPPER_NAME FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO),'') = '' THEN (SELECT SHIPPER_NAME FROM TB_ORDER_LIST WHERE NNO = M2.NNO)
				ELSE (SELECT SHIPPER_NAME FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO)
			END SHIPPER_NAME,
			CASE
				WHEN ISNULL((SELECT SHIPPER_ADDR FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO),'') = '' THEN (SELECT SHIPPER_ADDR FROM TB_ORDER_LIST WHERE NNO = M2.NNO)
				ELSE (SELECT SHIPPER_ADDR FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO)
			END SHIPPER_ADDR,
			CASE
				WHEN ISNULL((SELECT CNEE_NAME FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO),'') = '' THEN (SELECT CNEE_NAME FROM TB_ORDER_LIST WHERE NNO = M2.NNO)
				ELSE (SELECT CNEE_NAME FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO)
			END CNEE_NAME,
			CASE
				WHEN ISNULL((SELECT CNEE_ADDR FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO),'') = '' THEN (SELECT CNEE_ADDR FROM TB_ORDER_LIST WHERE NNO = M2.NNO)
				ELSE (SELECT CNEE_ADDR FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO)
			END CNEE_ADDR,
			CASE
				WHEN ISNULL((SELECT CNEE_ZIP FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO),'') = '' THEN (SELECT CNEE_ZIP FROM TB_ORDER_LIST WHERE NNO = M2.NNO)
				ELSE (SELECT CNEE_ZIP FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO)
			END CNEE_ZIP,
			M2.CNEE_STATE,
			M2.CNEE_CITY,
			CASE
				WHEN ISNULL((SELECT CNEE_TEL FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO),'') = '' THEN (SELECT CNEE_TEL FROM TB_ORDER_LIST WHERE NNO = M2.NNO)
				ELSE (SELECT CNEE_TEL FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO)
			END CNEE_TEL,
			CASE
				WHEN ISNULL((SELECT CNEE_HP FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO),'') = '' THEN (SELECT CNEE_HP FROM TB_ORDER_LIST WHERE NNO = M2.NNO)
				ELSE (SELECT CNEE_HP FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO)
			END CNEE_HP,
			CASE
				WHEN ISNULL((SELECT BOX_CNT FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO),0) = '' THEN (SELECT BOX_CNT FROM TB_ORDER_LIST WHERE NNO = M2.NNO)
				ELSE (SELECT BOX_CNT FROM TB_ORDER_LIST_UP WHERE NNO = M2.NNO)
			END BOX_CNT,
			M1.HAWB_NO,
			M1.WTA,
			M1.WTC
		FROM (
			SELECT
				HAWB_NO, NNO, WTA, WTC
			FROM TB_HAWB F1
			WHERE MAWB_NO = #{mawbNo}
		) M1, TB_ORDER_LIST M2
		WHERE M1.NNO = M2.NNO
	</select>
	
	<select id="selectOrderItem" parameterType="String" resultType="com.example.temp.member.vo.UserOrderItemVO">
		SELECT
			ISNULL((SELECT BRAND FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO AND SUB_NO = F1.SUB_NO),BRAND) AS BRAND,
			ISNULL((SELECT SUB_NO FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO AND SUB_NO = F1.SUB_NO),SUB_NO) AS SUB_NO,
			ISNULL((SELECT ITEM_DETAIL FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO AND SUB_NO = F1.SUB_NO),ITEM_DETAIL) AS ITEM_DETAIL,
			ISNULL((SELECT ITEM_CNT FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO AND SUB_NO = F1.SUB_NO),ITEM_CNT) AS ITEM_CNT,
			ISNULL((SELECT UNIT_VALUE FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO AND SUB_NO = F1.SUB_NO),UNIT_VALUE) AS UNIT_VALUE,
			ISNULL((SELECT CUS_ITEM_CODE FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO AND SUB_NO = F1.SUB_NO),CUS_ITEM_CODE) AS CUS_ITEM_CODE,
			ISNULL((SELECT CHG_CURRENCY FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO AND SUB_NO = F1.SUB_NO),CHG_CURRENCY) AS CHG_CURRENCY,
			ISNULL((SELECT MAKE_CNTRY FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO AND SUB_NO = F1.SUB_NO),MAKE_CNTRY) AS MAKE_CNTRY,
			ISNULL((SELECT MAKE_COM FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO AND SUB_NO = F1.SUB_NO),MAKE_COM) AS MAKE_COM,
			ISNULL((SELECT HS_CODE FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO AND SUB_NO = F1.SUB_NO),HS_CODE) AS HS_CODE
		FROM TB_ORDER_ITEM F1
		WHERE NNO = #{nno}
	</select>
	
	<select id="selectItemTotalAmount" parameterType="String" resultType="Double">
		SELECT SUM(ISNULL(UNIT_VALUE, 0))
		FROM TB_ORDER_ITEM
		WHERE NNO = #{nno}
	</select>
	
	<select id="selectOrderInfoByNNO" parameterType="hashMap" resultType="com.example.temp.member.vo.UserOrderListVO">
		SELECT 
			ISNULL(HAWB_NO,'') AS HAWB_NO,
			ISNULL(ORDER_NO,'') AS ORDER_NO,
			ISNULL(ORDER_DATE,'') AS ORDER_DATE,
			ISNULL(SHIPPER_NAME,'') AS SHIPPER_NAME,
			ISNULL(SHIPPER_ADDR,'') AS SHIPPER_ADDR,
			ISNULL(CNEE_NAME,'') AS CNEE_NAME,
			ISNULL(CNEE_ZIP,'') AS CNEE_ZIP,
			ISNULL(CNEE_ADDR,'') AS CNEE_ADDR,
			ISNULL(CNEE_STATE,'') AS CNEE_STATE,
			ISNULL(CNEE_CITY,'') AS CNEE_CITY,
			ISNULL(CNEE_TEL,'') AS CNEE_TEL,
			ISNULL(CNEE_HP,'') AS CNEE_HP,
			ISNULL((SELECT WTA FROM TB_HAWB WHERE NNO = F1.NNO),'') AS WTA,
			ISNULL((SELECT WTC FROM TB_HAWB WHERE NNO = F1.NNO),'') AS WTC,
			ISNULL(BOX_CNT,'') AS BOX_CNT,
			(SELECT SUM(ISNULL(UNIT_VALUE,0)) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO) AS UNIT_VALUE
		FROM TB_ORDER_LIST F1
		WHERE NNO = #{nno}
	</select>
	
	<select id="selectOrderItemByNNO" parameterType="hashMap" resultType="com.example.temp.member.vo.UserOrderItemVO">
		SELECT
			ISNULL(BRAND,'') AS BRAND,
			ISNULL(ITEM_DETAIL,'') AS ITEM_DETAIL,
			ISNULL(ITEM_CNT,0) AS ITEM_CNT,
			ISNULL(UNIT_VALUE,'') AS UNIT_VALUE,
			ISNULL(CUS_ITEM_CODE,'') AS CUS_ITEM_CODE,
			ISNULL(CHG_CURRENCY,'') AS CHG_CURRENCY,
			ISNULL(MAKE_CNTRY,'') AS MAKE_CNTRY,
			ISNULL(MAKE_COM,'') AS MAKE_COM,
			ISNULL(HS_CODE,'') AS HS_CODE
		FROM TB_ORDER_ITEM
		WHERE NNO = #{nno} AND SUB_NO = #{subNo}
	</select>
	
	<insert id="insertNewOrderInfo" parameterType="com.example.temp.member.vo.UpdateOrderListVO">
		DELETE TB_ORDER_LIST_UP WHERE NNO = #{nno};
		
		INSERT INTO TB_ORDER_LIST_UP
			(NNO, HAWB_NO, ORDER_NO, ORDER_DATE, BOX_CNT, SHIPPER_NAME, SHIPPER_ADDR, CNEE_NAME, 
			CNEE_ADDR, CNEE_ZIP, CNEE_TEL, CNEE_HP, W_USER_ID, W_USER_IP, W_DATE)
		VALUES
		(
			#{nno}, #{hawbNo}, #{orderNo}, #{orderDate}, #{boxCnt}, #{shipperName}, #{shipperAddr}, #{cneeName},
			#{cneeAddr}, #{cneeZip}, #{cneeTel}, #{cneeHp}, #{wUserId}, #{wUserIp}, GETDATE()
		);
	</insert>
	
	<insert id="insertNewOrderItemInfo" parameterType="com.example.temp.member.vo.UpdateOrderItemVO">
		DELETE FROM TB_ORDER_ITEM_UP WHERE NNO = #{nno} AND SUB_NO = #{subNo};
	
		INSERT INTO TB_ORDER_ITEM_UP
			(NNO, SUB_NO, HS_CODE, ITEM_DETAIL, ITEM_CNT, UNIT_VALUE, BRAND, MAKE_CNTRY, MAKE_COM, CHG_CURRENCY, W_USER_ID, W_USER_IP, W_DATE, CUS_ITEM_CODE)
		VALUES
		(
			#{nno}, #{subNo}, #{hsCode}, #{itemDetail}, #{itemCnt}, #{unitValue}, #{brand}, #{makeCntry}, #{makeCom}, #{chgCurrency},
			#{wUserId}, #{wUserIp}, GETDATE(), #{cusItemCode}
		);
	</insert>
	
	<select id="selectOrderInfoMani" parameterType="hashMap" resultType="com.example.temp.manager.vo.ManifestVO">
		SELECT
			ISNULL(F1.ORG_STATION,'') AS ORG_STATION,
			ISNULL(F1.MAWB_NO,'') AS MAWB_NO,
			ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = F1.HAWB_NO), F1.HAWB_NO) AS HAWB_NO,
			ISNULL((SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = F1.ORG_STATION),'') AS ORG_NATION,
			ISNULL(F1.DSTN_NATION,'') AS DSTN_NATION,
			ISNULL(F1.BOX_CNT,1) AS BOX_CNT,
			ROUND(ISNULL(F1.WTA,0),2) AS WTA,
			ISNULL((SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO),'') AS DEP_DATE,
			ISNULL(F2.SHIPPER_NAME,'') AS SHIPPER_NAME,
			ISNULL(F2.SHIPPER_ADDR,'') AS SHIPPER_ADDR,
			ISNULL(F2.SHIPPER_ADDR_DETAIL,'') AS SHIPPER_ADDR_DETAIL,
			ISNULL(F2.SHIPPER_CITY,'') AS SHIPPER_CITY,
			ISNULL(F2.SHIPPER_STATE,'') AS SHIPPER_STATE,
			ISNULL(F2.SHIPPER_ZIP,'') AS SHIPPER_ZIP,
			ISNULL(F2.CNEE_NAME,'') AS CNEE_NAME,
			ISNULL(F2.CNEE_ADDR,'') AS CNEE_ADDR,
			ISNULL(F2.CNEE_ADDR_DETAIL,'') AS CNEE_ADDR_DETAIL,
			ISNULL(F2.CNEE_CITY,'') AS CNEE_CITY,
			ISNULL(F2.CNEE_STATE,'') AS CNEE_STATE,
			ISNULL(F2.CNEE_ZIP,'') AS CNEE_ZIP,
			ISNULL(F3.ITEM_DETAIL,'') AS ITEM_DETAIL,
			ISNULL(F3.ITEM_CNT,1) AS ITEM_CNT,
			ROUND(ISNULL(F3.UNIT_VALUE,0),2) AS UNIT_VALUE,
			ROUND(F3.UNIT_VALUE*F3.ITEM_CNT,2) AS ITEM_VALUE,
			ISNULL(F3.CHG_CURRENCY,F3.UNIT_CURRENCY) AS CHG_CURRENCY,
			ISNULL(F3.HS_CODE,'') AS HS_CODE
		FROM TB_HAWB F1
		JOIN TB_ORDER_LIST F2 ON F1.NNO = F2.NNO AND F1.ORG_STATION = F2.ORG_STATION AND F1.USER_ID = F2.USER_ID
		JOIN TB_ORDER_ITEM F3 ON F2.NNO = F3.NNO AND F2.USER_ID = F3.USER_ID AND F2.ORG_STATION = F3.ORG_STATION
		WHERE 
			F1.MAWB_NO = #{mawbNo}
		<!-- SELECT
			ORG_STATION,
			MAWB_NO,
			ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = F1.HAWB_NO), HAWB_NO) AS HAWB_NO,
			ISNULL((SELECT CODE FROM TB_IATA_CODE WHERE PREFIX_CODE = SUBSTRING(MAWB_NO,1,3)),'') AS CODE,
			BOX_CNT,
			CONVERT(DECIMAL(18, 2), WTA) AS WTA,
			CONVERT(DECIMAL(18, 2), WTC) AS WTC,
			NNO,
			CASE
				WHEN ISNULL((SELECT TOP 1 ITEM_DETAIL FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO),'') = '' THEN (SELECT TOP 1 ITEM_DETAIL FROM TB_ORDER_ITEM WHERE NNO = F1.NNO)
				ELSE (SELECT TOP 1 ITEM_DETAIL FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO)
			END ITEM_DETAIL,
			(SELECT CONCAT(SUBSTRING(DEP_DATE, 5, 2), '/', SUBSTRING(DEP_DATE, 7, 2), '/', SUBSTRING(DEP_DATE, 1, 4)) FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO) AS W_DATE,
			CASE
				WHEN ISNULL((SELECT CNEE_NAME FROM TB_ORDER_LIST_UP WHERE NNO = F1.NNO),'') = '' THEN (SELECT CNEE_NAME FROM TB_ORDER_LIST WHERE NNO = F1.NNO)
				ELSE (SELECT CNEE_NAME FROM TB_ORDER_LIST_UP WHERE NNO = F1.NNO)
			END CNEE_NAME,
			CASE
				WHEN ISNULL((SELECT CNEE_ADDR FROM TB_ORDER_LIST_UP WHERE NNO = F1.NNO),'') = '' THEN (SELECT CNEE_ADDR FROM TB_ORDER_LIST WHERE NNO = F1.NNO)
				ELSE (SELECT CNEE_ADDR FROM TB_ORDER_LIST_UP WHERE NNO = F1.NNO)
			END CNEE_ADDR,
			(SELECT CNEE_CITY FROM TB_ORDER_LIST WHERE NNO = F1.NNO) AS CNEE_CITY,
			(SELECT CNEE_STATE FROM TB_ORDER_LIST WHERE NNO = F1.NNO) AS CNEE_STATE,
			CASE
				WHEN ISNULL((SELECT CNEE_ZIP FROM TB_ORDER_LIST_UP WHERE NNO = F1.NNO),'') = '' THEN (SELECT CNEE_ZIP FROM TB_ORDER_LIST WHERE NNO = F1.NNO)
				ELSE (SELECT CNEE_ZIP FROM TB_ORDER_LIST_UP WHERE NNO = F1.NNO)
			END CNEE_ZIP,
			(SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = F1.ORG_STATION) AS ORIGIN,
			(SELECT COUNT(*) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO) AS ITEM_CNT,
			(SELECT SUM(CONVERT(DECIMAL(18, 2), UNIT_VALUE)) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO) AS UNIT_VALUE,
			(SELECT TOP 1 ISNULL(CHG_CURRENCY,'USD') FROM TB_ORDER_ITEM WHERE NNO = F1.NNO) AS UNIT_CURRENCY,
			CASE
				WHEN (SELECT COUNT(*) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO) <![CDATA[ > ]]> 1 THEN 'MULTI'
				ELSE ISNULL((SELECT HS_CODE FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO), (SELECT HS_CODE FROM TB_ORDER_ITEM WHERE NNO = F1.NNO))
			END HS_CODE,
			TRANS_CODE,
			CASE
				WHEN ISNULL((SELECT SHIPPER_NAME FROM TB_ORDER_LIST_UP WHERE NNO = F1.NNO),'') = '' THEN (SELECT SHIPPER_NAME FROM TB_ORDER_LIST WHERE NNO = F1.NNO)
				ELSE (SELECT SHIPPER_NAME FROM TB_ORDER_LIST_UP WHERE NNO = F1.NNO)
			END SHIPPER_NAME,
			CASE
				WHEN ISNULL((SELECT SHIPPER_ADDR FROM TB_ORDER_LIST_UP WHERE NNO = F1.NNO),'') = '' THEN (SELECT SHIPPER_ADDR FROM TB_ORDER_LIST WHERE NNO = F1.NNO)
				ELSE (SELECT SHIPPER_ADDR FROM TB_ORDER_LIST_UP WHERE NNO = F1.NNO)
			END SHIPPER_ADDR,
			(SELECT SHIPPER_ADDR_DETAIL FROM TB_ORDER_LIST WHERE NNO = F1.NNO) AS SHIPPER_ADDR_DETAIL,
			(SELECT SHIPPER_CITY FROM TB_ORDER_LIST WHERE NNO = F1.NNO) AS SHIPPER_CITY,
			(SELECT SHIPPER_STATE FROM TB_ORDER_LIST WHERE NNO = F1.NNO) AS SHIPPER_STATE,
			(SELECT SHIPPER_ZIP FROM TB_ORDER_LIST WHERE NNO = F1.NNO) AS SHIPPER_ZIP
		FROM TB_HAWB F1
		WHERE MAWB_NO = #{mawbNo} -->
	</select>
	
	<select id="selectManiItem" parameterType="String" resultType="hashMap">
		SELECT
			ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE NNO = F1.NNO), (SELECT HAWB_NO FROM TB_ORDER_LIST WHERE NNO = F1.NNO)) AS HAWB_NO,
		 	ISNULL(SUB_NO,'') AS SUB_NO,
		 	ISNULL((SELECT HS_CODE FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO AND SUB_NO = F1.SUB_NO),HS_CODE) AS HS_CODE,
		 	ISNULL((SELECT UNIT_VALUE FROM TB_ORDER_ITEM_UP WHERE NNO = F1.NNO AND SUB_NO = F1.SUB_NO),CONVERT(DECIMAL(18,2), UNIT_VALUE)) AS UNIT_VALUE
		FROM TB_ORDER_ITEM F1
		WHERE NNO = #{value}
	</select>
	
	<select id="selectOrderListT86" parameterType="hashMap" resultType="com.example.temp.member.vo.UserOrderListVO">
		SELECT
			F1.NNO,
			F1.USER_ID,
			ISNULL(F1.ORDER_NO,'') AS ORDER_NO,
			ISNULL(F1.HAWB_NO,'') AS HAWB_NO,
			ISNULL(F2.BOX_CNT,0) AS BOX_CNT,
			ISNULL(F1.CNEE_NAME,'') AS CNEE_NAME,
			ISNULL(F1.CNEE_ADDR,'') AS CNEE_ADDR,
			ISNULL(F1.CNEE_TEL,'') AS CNEE_TEL,
			ISNULL(F2.WTA,0) AS WTA,
			ISNULL(F2.WTC,0) AS WTC
		FROM TB_ORDER_LIST F1, TB_HAWB F2
		WHERE F1.TRANS_CODE IN ('ACI-T86', 'PARCLL')
			AND F1.NNO = F2.NNO
			AND F1.HAWB_NO NOT IN (SELECT HAWB_NO FROM TB_DELIVERY_INFO)
			<if test='searchType == "0"'>
				AND (
				F1.USER_ID LIKE '%'+#{userId}+'%' OR
				F1.ORDER_NO LIKE '%'+#{orderNo}+'%' OR
				F1.HAWB_NO LIKE '%'+#{hawbNo}+'%'
				)
			</if>
			<if test='searchType == "1"'>
				AND F1.USER_ID LIKE '%'+#{userId}+'%'
			</if>
			<if test='searchType == "2"'>
				AND F1.ORDER_NO LIKE '%'+#{orderNo}+'%'
			</if>
			<if test='searchType == "3"'>
				AND F1.HAWB_NO LIKE '%'+#{hawbNo}+'%'
			</if>
			
		ORDER BY F2.W_DATE
	</select>
	
	<select id="selectType86HawbList" parameterType="String" resultType="com.example.temp.manager.vo.HawbListVO">
		SELECT
		   F1.NNO,
		   F1.USER_ID ,
		   F3.USER_NAME,
		   ISNULL(F1.MAWB_NO,'') AS MAWB_NO,
		   (SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE = F2.ORG_STATION) ORG_STATION,
		   F1.TRANS_CODE,
		   (SELECT TRANS_NAME FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE) AS TRANS_NAME,
		   F1.HAWB_NO,
		   (SELECT TRK_NO FROM TB_DELIVERY_INFO WHERE HAWB_NO = F1.HAWB_NO AND NNO = F1.NNO) AS AGENCY_BL,
		   F1.DSTN_NATION,
		   F1.BOX_CNT,
		   F2.ORDER_NO,
		   F2.SHIPPER_NAME,
		   F2.CNEE_NAME,
		   ISNULL(F2.CUSTOMS_NO,'') AS CUSTOMS_NO,
		   F2.CNEE_TEL,
		   F2.CNEE_HP,
		   ISNULL(F2.CNEE_CNTRY,'') AS CNEE_CNTRY,
		   ISNULL(F2.CNEE_STATE,'') AS CNEE_STATE,
		   ISNULL(F2.CNEE_DISTRICT,'') AS CNEE_DISTRICT,
		   F2.CNEE_ADDR,
		   F2.CNEE_ADDR_DETAIL,
		   ISNULL(F1.WTA,'') AS WTA,
		   ISNULL(F1.WTC,'') AS WTC,
		   F3.COM_E_NAME,
		   F3.COM_NAME
		  FROM TB_HAWB F1
		  JOIN TB_ORDER_LIST F2 ON F1.NNO = F2.NNO AND F1.USER_ID = F2.USER_ID
		  JOIN TB_CUSTOMER F3 ON F1.USER_ID = F3.USER_ID
		  JOIN TB_DELIVERY_INFO F4 ON F1.NNO = F4.NNO AND F1.TRANS_CODE = F4.TRANS_CODE
		WHERE F1.TRANS_CODE IN ('ACI-T86', 'PARCLL')
			AND (MAWB_NO = '' OR MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO AND DEP_DATE >= CONVERT(CHAR(8), DATEADD(DAY, -3, GETDATE()), 112)))
		<!-- SELECT
		   F1.NNO,
		   F1.USER_ID ,
		   F3.USER_NAME,
		   (SELECT STATION_NAME FROM TB_STATION WHERE STATION_CODE = F2.ORG_STATION) ORG_STATION,
		   F1.TRANS_CODE,
		   (SELECT TRANS_NAME FROM TB_TRANS_COM WHERE TRANS_CODE = F1.TRANS_CODE) AS TRANS_NAME,
		   F1.HAWB_NO,
	       (SELECT TRK_NO FROM TB_DELIVERY_INFO WHERE HAWB_NO = F1.HAWB_NO AND NNO = F1.NNO) AS AGENCY_BL,
		   F1.DSTN_NATION,
		   F1.BOX_CNT,
		   F2.ORDER_NO,
		   F2.SHIPPER_NAME,
		   F2.CNEE_NAME,
		   ISNULL(F2.CUSTOMS_NO,'') AS CUSTOMS_NO,
		   F2.CNEE_TEL,
		   F2.CNEE_HP,
		   ISNULL(F2.CNEE_CNTRY,'') AS CNEE_CNTRY,
		   ISNULL(F2.CNEE_STATE,'') AS CNEE_STATE,
		   ISNULL(F2.CNEE_DISTRICT,'') AS CNEE_DISTRICT,
		   F2.CNEE_ADDR,
		   F2.CNEE_ADDR_DETAIL,
		   ISNULL(F1.WTA,'') AS WTA,
		   ISNULL(F1.WTC,'') AS WTC,
		       F3.COM_E_NAME,
		       F3.COM_NAME
		  FROM TB_HAWB F1  ,
		       TB_ORDER_LIST F2 ,
		       TB_CUSTOMER F3
		 WHERE F1.NNO = F2.NNO
		   AND F1.USER_ID =F2.USER_ID
		   AND F1.USER_ID = F3.USER_ID
		   AND F1.TRANS_CODE = 'ACI-T86'
		   AND F1.MAWB_NO = ''
	       AND F1.HAWB_NO IN (SELECT HAWB_NO FROM TB_DELIVERY_INFO) -->
	</select>
	
	<select id="selectOrderListNewInfo" parameterType="String" resultType="Integer">
		SELECT COUNT(*)
		FROM TB_ORDER_LIST_UP
		WHERE NNO = #{nno}
	</select>
	
	<select id="selectNnoListByMawbNo" parameterType="String" resultType="String">
		SELECT NNO
		FROM (
			SELECT NNO
			FROM TB_HAWB
			WHERE MAWB_NO = #{mawbNo}
		) M1
		WHERE NNO IN (SELECT NNO FROM TB_ORDER_LIST_UP) OR NNO IN (SELECT NNO FROM TB_ORDER_ITEM_UP)
	</select>
	
	<select id="selectChangeOrderList" parameterType="String" resultType="hashMap">
		SELECT 	*
		FROM (
			SELECT NNO AS nno, HAWB_NO AS hawbNo, (SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = F1.HAWB_NO) AS agencyBl, USER_ID AS userId
			FROM TB_HAWB F1
			WHERE F1.MAWB_NO = #{mawbNo}
		) M1
		WHERE NNO IN (SELECT NNO FROM TB_ORDER_LIST_UP) OR NNO IN (SELECT NNO FROM TB_ORDER_ITEM_UP)
	</select>

	<select id="selectChangeOrderInfo" parameterType="String" resultType="com.example.temp.member.vo.UserOrderListVO">
		SELECT
			ISNULL(NNO,'') AS NNO,
			ISNULL(ORDER_NO,'') AS ORDER_NO,
			ISNULL(ORDER_DATE,'') AS ORDER_DATE,
			ISNULL(HAWB_NO,'') AS HAWB_NO,
			ISNULL(BOX_CNT,0) AS BOX_CNT,
			ISNULL(SHIPPER_NAME,'') AS SHIPPER_NAME,
			ISNULL(SHIPPER_ADDR,'') AS SHIPPER_ADDR,
			ISNULL(CNEE_NAME,'') AS CNEE_NAME,
			ISNULL(CNEE_ADDR,'') AS CNEE_ADDR,
			ISNULL(CNEE_ZIP,'') AS CNEE_ZIP,
			ISNULL(CNEE_TEL,'') AS CNEE_TEL,
			ISNULL(CNEE_HP,'') AS CNEE_HP,
			ISNULL(W_DATE,'') AS W_DATE
		FROM TB_ORDER_LIST_UP
		WHERE NNO = #{nno}
	</select>
	
	<select id="selectFirstOrderInfo" parameterType="String" resultType="com.example.temp.member.vo.UserOrderListVO">
		SELECT
			ISNULL(NNO,'') AS NNO,
			ISNULL(HAWB_NO,'') AS HAWB_NO,
			ISNULL((SELECT MATCH_TRANS_CODE FROM TB_MATCHING_INFO WHERE NNO = F1.NNO),'') AS TRANS_CODE,
			ISNULL(ORDER_NO,'') AS ORDER_NO,
			ISNULL(ORDER_DATE,'') AS ORDER_DATE,
			ISNULL(HAWB_NO,'') AS HAWB_NO,
			ISNULL(BOX_CNT,0) AS BOX_CNT,
			ISNULL(SHIPPER_NAME,'') AS SHIPPER_NAME,
			ISNULL(SHIPPER_ADDR,'') AS SHIPPER_ADDR,
			ISNULL(CNEE_NAME,'') AS CNEE_NAME,
			ISNULL(CNEE_ADDR,'') AS CNEE_ADDR,
			ISNULL(CNEE_ZIP,'') AS CNEE_ZIP,
			ISNULL(CNEE_TEL,'') AS CNEE_TEL,
			ISNULL(CNEE_HP,'') AS CNEE_HP,
			ISNULL(W_DATE,'') AS W_DATE
		FROM TB_ORDER_LIST F1
		WHERE NNO = #{nno}
	</select>
	
	<select id="selectChangeItemInfo" parameterType="String" resultType="java.util.LinkedHashMap">
		SELECT
			ISNULL(SUB_NO,'') AS subNo,
			ISNULL(HS_CODE,'') AS hsCode,
			ISNULL(ITEM_DETAIL,'') AS itemDetail,
			ISNULL(ITEM_CNT,0) AS itemCnt,
			ISNULL(UNIT_VALUE,0.0) AS unitValue,
			ISNULL(BRAND,'') AS brand,
			ISNULL(MAKE_CNTRY,'') AS makeCntry,
			ISNULL(MAKE_COM,'') AS makeCom,
			ISNULL(CHG_CURRENCY,'') AS chgCurrency,
			ISNULL(CUS_ITEM_CODE,'') AS cusItemCode,
			ISNULL(W_DATE,'') AS wDate
		FROM TB_ORDER_ITEM_UP
		WHERE NNO = #{nno}
		ORDER BY SUB_NO
	</select>
	
	<select id="selectFirstOrderItemInfo" parameterType="hashMap" resultType="java.util.LinkedHashMap">
		SELECT
			ISNULL(SUB_NO,'') AS subNo,
			ISNULL(HS_CODE,'') AS hsCode,
			ISNULL(ITEM_DETAIL,'') AS itemDetail,
			ISNULL(ITEM_CNT,0) AS itemCnt,
			ISNULL(UNIT_VALUE,0.0) AS unitValue,
			ISNULL(BRAND,'') AS brand,
			ISNULL(MAKE_CNTRY,'') AS makeCntry,
			ISNULL(MAKE_COM,'') AS makeCom,
			ISNULL(CHG_CURRENCY,'') AS chgCurrency,
			ISNULL(CUS_ITEM_CODE,'') AS cusItemCode,
			ISNULL(W_DATE,'') AS wDate
		FROM TB_ORDER_ITEM
		WHERE NNO = #{nno}
			AND SUB_NO IN
			<foreach collection="subNo" item="value" open="(" close=")" separator=",">
				#{value}
			</foreach>
		ORDER BY SUB_NO
	</select>
	
	<select id="selectUserMallInfo" parameterType="String" resultType="com.example.temp.manager.vo.FastboxInfoVO">
		SELECT
			ISNULL(USER_ID,'') AS USER_ID,
			ISNULL(MALL_ID,'') AS MALL_ID,
			ISNULL(SELLER_NAME,'') AS SELLER_NAME,
			ISNULL(CONSUMER_KEY,'') AS CONSUMER_KEY,
			ISNULL(TOKEN,'') AS TOKEN,
			ISNULL(COM_REG_NO,'') AS COM_REG_NO
		FROM TB_USER_MALL_INFO
		WHERE USER_ID = #{userId}
	</select>
	
	<select id="selectUserMallCnt" parameterType="com.example.temp.manager.vo.FastboxInfoVO" resultType="Integer">
		SELECT COUNT(*)
		FROM TB_USER_MALL_INFO
		WHERE USER_ID = #{userId}
	</select>
	
	<update id="updateUserMallInfo" parameterType="com.example.temp.manager.vo.FastboxInfoVO">
		UPDATE TB_USER_MALL_INFO
		SET
			W_DATE = GETDATE(),
			W_USER_ID = #{wUserId},
			W_USER_IP = #{wUserIp},
			MALL_ID = #{mallId},
			SELLER_NAME = #{sellerName},
			CONSUMER_KEY = #{consumerKey},
			TOKEN = #{token}
		WHERE USER_ID = #{userId}
	</update>
	
	<insert id="insertUserMallInfo" parameterType="com.example.temp.manager.vo.FastboxInfoVO">
		INSERT INTO TB_USER_MALL_INFO
			(USER_ID, W_DATE, W_USER_ID, W_USER_IP, MALL_ID, SELLER_NAME, CONSUMER_KEY, TOKEN)
		VALUES (
			#{userId}, GETDATE(), #{wUserId}, #{wUserIp}, #{mallId}, #{sellerName}, #{consumerKey}, #{token}
		)
	</insert>
	
	<select id="selectOrderListForErr" parameterType="hashMap" resultType="hashMap">
		SELECT
			NNO AS nno,
			USER_ID AS userId,
			ORDER_DATE AS orderDate,
			ORDER_NO AS orderNo,
			(SELECT COUNT(*) FROM TMP_ORDER_ITEM WHERE NNO = F1.NNO) AS itemCnt,
			ISNULL(STATUS,'') AS errorMsg
		FROM TMP_ORDER_LIST F1
		WHERE ORG_STATION = #{orgStation}
			AND TRANS_CODE = 'YSL'
			AND ISNULL(STATUS,'') != ''
			AND ORDER_TYPE IN ('NOMAL', 'TAKEIN', 'INSP')
			AND W_DATE <![CDATA[ > ]]> '20221117'
			AND (SELECT COUNT(*) FROM TB_ERROR_MATCH WHERE NNO = F1.NNO) <![CDATA[ > ]]> 0
		<if test="orderNo != null and orderNo != ''">
			AND ORDER_NO LIKE '%' + #{orderNo} + '%'
		</if>
		<if test="userId != null and userId != ''">
			AND USER_ID LIKE '%' + #{userId} + '%'
		</if>
	</select>
	
	<select id="selectErrorMsgByNNO" parameterType="String" resultType="String">
		SELECT
			ERROR_MSG
		FROM TB_ERROR_MATCH
		WHERE NNO = #{nno}
	</select>
	
	<update id="updateMawbHawb" parameterType="hashMap">
		UPDATE TB_HAWB
		SET MAWB_NO = #{mawbNo}, BAG_NO = #{bagNo}
		WHERE HAWB_NO = #{hawbNo}
	</update>
	
	<insert id="insertWhoutOrderIn" parameterType="hashMap">
		INSERT INTO TB_BOARD_WH 
		(BOARD_ID, STATUS, CATEGORY, TITLE, CONTENT, W_USER_ID, W_USER_IP)
		VALUES 
		(#{boardId}, 'N', #{category}, #{title}, #{content}, #{wUserId}, #{wUserIp})
	</insert>
	
	<select id="selectWhoutOrder" parameterType="hashMap" resultType="hashMap">
		SELECT
			IDX as idx, STATUS as status, CATEGORY as category, TITLE as title, CONTENT as content,
			USER_ID as userId, W_DATE as wDate, VIEW_CNT as viewCnt, CIDX as cIdx, DEPTH as depth, INDENT as indent
		FROM TB_WH_NOTICE
		WHERE IDX = #{idx}
	</select>
	
	<select id="selectWhoutFiles" parameterType="hashMap" resultType="hashMap">
		SELECT
			IDX as idx, NOTICE_IDX as noticeIdx, FILE_DIR as fileDir, RIGHT(FILE_DIR, CHARINDEX('/', REVERSE(FILE_DIR)) -1) as fileName 
		FROM TB_WH_NOTICE_FILE
		WHERE NOTICE_IDX = #{idx}
		ORDER BY IDX
	</select>
	
	<delete id="deleteWhoutFile" parameterType="hashMap">
		DELETE FROM TB_BOARD_FILE
		WHERE IDX = #{idx} AND CONTENT_ID = #{contentId}
	</delete>
	
	<insert id="insertWhNoticeIn" parameterType="hashMap">
		INSERT INTO TB_WH_NOTICE (STATUS, CATEGORY, TITLE, CONTENT, USER_ID, W_USER_IP, ORG_STATION)
		VALUES ('N', #{category}, #{title}, #{content}, #{wUserId}, #{wUserIp}, #{orgStation});
		
		<selectKey keyProperty="idx" resultType="Integer" order="AFTER">
			SELECT IDENT_CURRENT('TB_WH_NOTICE')
		</selectKey>
	</insert>
	
	<update id="updateWhNoticeIn" parameterType="hashMap">
		UPDATE TB_WH_NOTICE SET CIDX = #{idx} WHERE IDX = #{idx}
	</update>

	<insert id="insertWhoutFile" parameterType="hashMap">
		INSERT INTO TB_WH_NOTICE_FILE (NOTICE_IDX, FILE_DIR) VALUES (#{idx}, #{fileDir})
	</insert>
	
	<select id="selectNoticeListCnt" parameterType="hashMap" resultType="Integer">
		SELECT COUNT(*) FROM TB_WH_NOTICE
		WHERE ORG_STATION = #{orgStation}
	</select>
	
	<insert id="insertReplyNotice" parameterType="hashMap">
		UPDATE TB_WH_NOTICE SET DEPTH = DEPTH <![CDATA[ + ]]> 1 WHERE CIDX = #{cIdx} AND DEPTH <![CDATA[ > ]]> DEPTH;
		
		INSERT INTO TB_WH_NOTICE (STATUS, CATEGORY, TITLE, CONTENT, USER_ID, W_USER_IP, CIDX, DEPTH, INDENT, ORG_STATION) VALUES
		('N', #{category}, #{title}, #{content}, #{wUserId}, #{wUserIp}, #{idx}, #{depth} <![CDATA[ + ]]> 1, #{indent} <![CDATA[ + ]]> 1, #{orgStation}); 
	</insert>
	
	<select id="selectNoticeInfo" parameterType="Integer" resultType="hashMap">
		SELECT
			IDX as idx,
			CIDX as cIdx,
			DEPTH as depth,
			INDENT as indent
		FROM TB_WH_NOTICE
		WHERE idx = #{idx}
	</select>
	
	<!--  -->
	
	<select id="selectWhNoticeListCnt" parameterType="hashMap" resultType="Integer">
		SELECT COUNT(*) FROM TB_WH_NOTICE
		WHERE ORG_STATION = #{orgStation}
		<if test="category != null and category != ''">
			AND CATEGORY = #{category}
		</if>
		<if test="searchType != null and searchType != '' and searchType  == 'all'">
			AND TITLE LIKE '%'+#{searchKeyword}+'%' OR W_USER_ID LIKE '%'+#{searchKeyword}+'%'
		</if>
		<if test="searchType != null and searchType != '' and searchType == 'userId'">
			AND W_USER_ID LIKE '%'+#{searchKeyword}+'%'
		</if>
		<if test="searchType != null and searchType != '' and searchType == 'title'">
			AND TITLE LIKE '%'+#{searchKeyword}+'%'
		</if>
	</select>
	
	<select id="selectWhNoticeList" parameterType="hashMap" resultType="com.example.temp.manager.vo.WhNoticeVO">
		SELECT *
		FROM (
			SELECT
				ROW_NUMBER() OVER(ORDER BY GROUP_IDX DESC, STEP ASC) ROWNUM,
				IDX, STATUS, CATEGORY, ISNULL(TITLE,'') AS TITLE, CONVERT(CHAR(19),W_DATE,120) AS W_DATE, ISNULL(W_USER_ID,'') AS W_USER_ID,
				ISNULL(W_USER_IP,'') AS W_USER_IP, ISNULL(GROUP_IDX,0) AS GROUP_IDX, ISNULL(STEP,0) AS STEP, ISNULL(INDENT,0) AS INDENT
			FROM TB_WH_NOTICE
			WHERE ORG_STATION = #{orgStation}
			<if test="category != null and category != ''">
				AND CATEGORY = #{category}
			</if>
			<if test="searchType != null and searchType != '' and searchType  == 'all'">
				AND TITLE LIKE '%'+#{searchKeyword}+'%' OR W_USER_ID LIKE '%'+#{searchKeyword}+'%'
			</if>
			<if test="searchType != null and searchType != '' and searchType == 'userId'">
				AND W_USER_ID LIKE '%'+#{searchKeyword}+'%'
			</if>
			<if test="searchType != null and searchType != '' and searchType == 'title'">
				AND TITLE LIKE '%'+#{searchKeyword}+'%'
			</if>
		) M1
		WHERE ROWNUM BETWEEN #{paging.boardStart} AND #{paging.boardEnd}
	</select>
	
	<select id="selectWhNoticeFiles" parameterType="Integer" resultType="hashMap">
		SELECT ISNULL(FILE_DIR,'') AS fileDir, RIGHT(FILE_DIR, CHARINDEX('/', REVERSE(FILE_DIR)) -1) as fileName 
		FROM TB_WH_NOTICE_FILE
		WHERE NOTICE_IDX = #{idx}
	</select>
	
	<insert id="insertWhNoticeInfo" parameterType="hashMap">
		INSERT INTO TB_WH_NOTICE (STATUS, CATEGORY, TITLE, CONTENT, W_USER_ID, W_USER_IP, ORG_STATION)
			VALUES (#{status}, #{category}, #{title}, #{content}, #{wUserId}, #{wUserIp}, #{orgStation});
		
		<selectKey keyProperty="idx" resultType="Integer" order="AFTER">
			SELECT IDENT_CURRENT('TB_WH_NOTICE');
		</selectKey>
	</insert>
	
	<update id="updateWhNoticeGIdx" parameterType="hashMap">
		UPDATE TB_WH_NOTICE SET GROUP_IDX = #{idx} WHERE IDX = #{idx}
	</update>
	
	<insert id="insertWhNoticeFile" parameterType="hashMap">
		INSERT INTO TB_WH_NOTICE_FILE (NOTICE_IDX, FILE_DIR) VALUES (#{idx}, #{fileDir})
	</insert>
	
	<select id="selectWhNoticeDetail" parameterType="hashMap" resultType="com.example.temp.manager.vo.WhNoticeVO">
		SELECT
			IDX, ISNULL(STATUS,'') AS STATUS, ISNULL(CATEGORY,'') AS CATEGORY, ISNULL(TITLE,'') AS TITLE, ISNULL(CONTENT,'') AS CONTENT,
			ISNULL(W_USER_ID,'') AS W_USER_ID, ISNULL(GROUP_IDX,0) AS GROUP_IDX, ISNULL(STEP,0) AS STEP, ISNULL(INDENT,0) AS INDENT
		FROM TB_WH_NOTICE
		WHERE IDX = #{idx} AND GROUP_IDX = #{groupIdx}
	</select>
	
	<select id="selectWhNoticeFileYn" parameterType="hashMap" resultType="Integer">
		SELECT COUNT(*) FROM TB_WH_NOTICE_FILE WHERE NOTICE_IDX = #{idx}
	</select>
	
	<select id="selectWhNoticeFileList" parameterType="hashMap" resultType="hashMap">
		SELECT
			IDX as idx, NOTICE_IDX as noticeIdx, FILE_DIR as fileDir, RIGHT(FILE_DIR, CHARINDEX('/', REVERSE(FILE_DIR)) -1) as fileName 
		FROM TB_WH_NOTICE_FILE
		WHERE NOTICE_IDX = #{idx}
		ORDER BY IDX
	</select>
	
	<delete id="noticeFileDel" parameterType="hashMap">
		DELETE FROM TB_WH_NOTICE_FILE WHERE IDX = #{idx} AND NOTICE_IDX = #{noticeIdx}
	</delete>
	
	<update id="updateWhNoticeInfo" parameterType="hashMap">
		UPDATE TB_WH_NOTICE SET STATUS = #{status}, CATEGORY = #{category}, TITLE = #{title}, CONTENT = #{content}
		WHERE IDX = #{idx}
	</update>
	
	<insert id="insertWhNoticeReplyInfo" parameterType="hashMap">
		UPDATE TB_WH_NOTICE SET STEP = STEP <![CDATA[ + ]]> 1 WHERE GROUP_IDX = #{groupIdx} AND STEP <![CDATA[ > ]]> STEP;
		
		INSERT INTO TB_WH_NOTICE (STATUS, CATEGORY, TITLE, CONTENT, W_USER_ID, W_USER_IP, GROUP_IDX, STEP, INDENT, ORG_STATION) VALUES
		(#{status}, #{category}, #{title}, #{content}, #{wUserId}, #{wUserIp}, #{groupIdx}, #{step} <![CDATA[ + ]]> 1, #{indent} <![CDATA[ + ]]> 1, #{orgStation});
		
		<selectKey keyProperty="nowIdx" resultType="Integer" order="AFTER">
			SELECT IDENT_CURRENT('TB_WH_NOTICE');
		</selectKey> 
	</insert>
	
	<select id="execNoticeDel" parameterType="hashMap" resultType="hashMap" statementType="CALLABLE">
		DECLARE
			@IDX INT,
			@GROUP_IDX INT,
			@STEP INT,
			@INDENT INT,
			@RST_STATUS NVARCHAR(50),
			@RST_CODE NVARCHAR(50),
			@RST_MSG NVARCHAR(100)
		
		SET @IDX = #{idx}
		SET @GROUP_IDX = #{groupIdx}
		SET @STEP = #{step}
		SET @INDENT = #{indent}
		
		EXEC SP_WH_NOTICE_DEL
		@IDX,
		@GROUP_IDX,
		@STEP,
		@INDENT,
		@RST_STATUS OUTPUT,
		@RST_CODE OUTPUT,
		@RST_MSG OUTPUT
		
		SELECT
		@RST_STATUS AS rstStatus,
		@RST_CODE AS rstCode,
		@RST_MSG AS rstMsg
	</select>
	
	<select id ="selectCommercialInfo" parameterType="String" resultType="com.example.temp.common.vo.CommercialVO">
		SELECT
			ISNULL((SELECT TRK_NO FROM TB_DELIVERY_INFO WHERE NNO = F1.NNO AND HAWB_NO = F1.HAWB_NO),F1.HAWB_NO) AS MATCH_NO,
			CASE
				WHEN F1.TRANS_CODE = 'YSL' THEN (SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = F1.HAWB_NO)
				ELSE F1.HAWB_NO
			END HAWB_NO,
			F1.ORDER_DATE,
			SUBSTRING(REPLACE(F1.W_DATE,'-',''),0,9) W_DATE,
			F3.COM_E_NAME,
			ISNULL((SELECT NATION_E_NAME FROM TB_NATION_CODE WHERE NATION_CODE = (SELECT NATION_CODE FROM TB_STATION WHERE STATION_CODE = F1.ORG_STATION)),'') AS SHIPPER_CNTRY,
			F3.USER_E_ADDR,
			F3.USER_E_ADDR_DETAIL,
			F3.USER_TEL,
			F1.CNEE_NAME,
			(SELECT NATION_E_NAME FROM TB_NATION_CODE WHERE NATION_CODE = F1.DSTN_NATION) AS DSTN_NATION,
			F1.CNEE_CNTRY,
			F1.CNEE_STATE,
			F1.CNEE_CITY,
			F1.CNEE_ADDR,
			F1.CNEE_ADDR_DETAIL,
			ISNULL(F1.CNEE_TEL,F1.CNEE_HP) AS CNEE_TEL,
			ISNULL(F1.BUY_SITE,'') AS BUY_SITE,
			ISNULL(F1.PAYMENT,'') AS PAYMENT,
			ISNULL(F1.BOX_CNT,1) AS BOX_CNT,
			(SELECT SUM(ITEM_CNT) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO AND USER_ID = F1.USER_ID AND ORG_STATION = F1.ORG_STATION) AS TOTAL_ITEM_CNT,
			(SELECT SUM(ITEM_CNT*UNIT_VALUE) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO AND USER_ID = F1.USER_ID AND ORG_STATION = F1.ORG_STATION) AS TOTAL_ITEM_VALUE,
			F1.USER_WTA,
			F1.USER_WTC
		FROM TB_ORDER_LIST F1 LEFT OUTER JOIN TB_CUSTOMER_INV_INFO F2 ON F1.USER_ID = F2.INV_USER_ID
			 				  LEFT OUTER JOIN TB_CUSTOMER F3 ON F1.USER_ID = F3.USER_ID
		WHERE F1.NNO = #{nno};
	</select>
	
	<select id="selectUploadDate" parameterType="String" resultType="String">
		SELECT SUBSTRING(REPLACE(W_DATE,'-',''),0,9) W_DATE FROM TB_ORDER_LIST 
		WHERE HAWB_NO = ISNULL((SELECT HAWB_NO FROM TB_DELIVERY_INFO WHERE TRK_NO = #{value}), #{value})
	</select>
	
	<select id = "selectCommercialItem" parameterType="String" resultType="com.example.temp.common.vo.CommercialItemVO">
		SELECT 	ITEM_DETAIL,
				ITEM_CNT,
				UNIT_VALUE,
				ISNULL(CHG_CURRENCY,ISNULL(UNIT_CURRENCY,'')) AS CHG_CURRENCY
		FROM TB_ORDER_ITEM WHERE NNO = #{nno}
	</select>
	
	<select id="selectOrderListLabelChangeCnt" parameterType="hashMap" resultType="Integer">
		SELECT COUNT(*)
		FROM TB_ORDER_LIST F1 JOIN TB_HAWB F2 ON F1.NNO = F2.NNO AND F1.USER_ID = F2.USER_ID AND F1.HAWB_NO = F2.HAWB_NO
		WHERE F1.TRANS_CODE = 'ACI-US' OR F1.TRANS_CODE = 'ACI-T86'
			AND F1.ORG_STATION = #{orgStation}
			AND F1.NNO IN (SELECT NNO FROM TB_VOLUME) 
			AND F1.NNO NOT IN (SELECT NNO FROM TB_DELIVERY_INFO)
		<if test='searchType != null and searchType != "" and searchType == "0"'>
			AND  (F1.USER_ID LIKE '%'+#{userId}+'%' OR F1.HAWB_NO LIKE '%'+#{hawbNo}+'%')
		</if>
		<if test='searchType != null and searchType != "" and searchType == "1"'>
			AND F1.USER_ID LIKE '%'+#{userId}+'%'
		</if>
		<if test='searchType != null and searchType != "" and searchType == "2"'>
			AND F1.HAWB_NO LIKE '%'+#{hawbNo}+'%'
		</if>
	</select>
	
	<select id="selectOrderListLabelChange" parameterType="HashMap" resultType="com.example.temp.member.vo.UserOrderListVO">
		SELECT *
		FROM (
			SELECT
				ROW_NUMBER() OVER(ORDER BY F2.W_DATE) ROWNUM,
				F1.NNO,
				F1.USER_ID,
				ISNULL(F1.ORDER_NO,'') AS ORDER_NO,
				ISNULL(F1.HAWB_NO,'') AS HAWB_NO,
				ISNULL(F1.TRANS_CODE,'') AS TRANS_CODE,
				ISNULL(CNEE_NAME,'') AS CNEE_NAME,
				ISNULL(CNEE_ADDR,'') AS CNEE_ADDR,
				ISNULL(CNEE_TEL,'') AS CNEE_TEL,
				F2.WTA
			FROM TB_ORDER_LIST F1 JOIN TB_HAWB F2 ON F1.NNO = F2.NNO AND F1.HAWB_NO = F2.HAWB_NO AND F1.USER_ID = F2.USER_ID
			WHERE F1.TRANS_CODE = 'ACI-US' OR F1.TRANS_CODE = 'ACI-T86'
				AND F1.ORG_STATION = #{orgStation}
				AND F1.NNO IN (SELECT NNO FROM TB_VOLUME) 
				AND F1.NNO NOT IN (SELECT NNO FROM TB_DELIVERY_INFO)
			<if test='searchType != null and searchType != "" and searchType == "0"'>
				AND  (F1.USER_ID LIKE '%'+#{userId}+'%' OR F1.HAWB_NO LIKE '%'+#{hawbNo}+'%')
			</if>
			<if test='searchType != null and searchType != "" and searchType == "1"'>
				AND F1.USER_ID LIKE '%'+#{userId}+'%'
			</if>
			<if test='searchType != null and searchType != "" and searchType == "2"'>
				AND F1.HAWB_NO LIKE '%'+#{hawbNo}+'%'
			</if>
		) M1
		WHERE M1.ROWNUM BETWEEN #{paging.boardStart} AND #{paging.boardEnd}
	</select>
	
	<select id="selectWeightInfo" parameterType="String" resultType="hashMap">
		SELECT
			SUM(USER_WTA*ITEM_CNT) AS userWta,
			(SELECT WT_UNIT FROM TB_ORDER_ITEM WHERE NNO = #{nno} AND SUB_NO = 1) AS wtUnit
		FROM TB_ORDER_ITEM F1
		WHERE NNO = #{nno}
	</select>

	<select id="selectChangeLabelList" parameterType="hashMap" resultType="com.example.temp.manager.vo.HawbListVO">
		SELECT
			F1.NNO,
			F1.HAWB_NO,
			F1.TRANS_CODE,
			F2.TRK_NO AS AGENCY_BL,
			F1.USER_ID,
			ISNULL((SELECT CNEE_NAME FROM TB_ORDER_LIST WHERE NNO = F1.NNO AND HAWB_NO = F1.HAWB_NO AND USER_ID = F1.USER_ID),'') AS CNEE_NAME
		FROM TB_HAWB F1 JOIN TB_DELIVERY_INFO F2 ON F1.NNO = F2.NNO AND F1.HAWB_NO = F2.HAWB_NO
		WHERE
			F1.ORG_STATION = #{orgStation}
			AND F1.TRANS_CODE = 'ACI-US' OR F1.TRANS_CODE = 'ACI-T86'
			AND (
				ISNULL(MAWB_NO,'') = '' 
				OR 
				(MAWB_NO IN (SELECT MAWB_NO FROM TB_MAWB WHERE MAWB_NO = F1.MAWB_NO AND DEP_DATE >= CONVERT(CHAR(8), DATEADD(DAY, -3, GETDATE()), 112)))
			)
	</select>
	
	<select id="selectMonthReportHawbList" parameterType="hashMap" resultType="hashMap">
		select * from 
			(select 
				(SELECT INV_COM_NAME FROM TB_CUSTOMER_INV_INFO WHERE INV_USER_ID =  F1.USER_ID) as comName,
				DSTN_NATION as dstnNation,
				WTA as wta,
				WTC as wtc,
				AGENCY_WTA as agencyWta,
				AGENCY_WTC as agencyWtc,
				APPLY_WT_TYPE as wtType,
				APPLY_WT as wt,
				(SELECT CONVERT(NVARCHAR, W_DATE, 120) FROM TB_HAWB WHERE NNO = F1.NNO) AS wDate,
				(SELECT MAWB_NO FROM TB_HAWB WHERE NNO = F1.NNO) AS mawbNo,
				(SELECT TRANS_CODE FROM TB_HAWB WHERE NNO = F1.NNO) AS transCode
			FROM VI_APPLY_WT_INFO F1 WHERE NNO IN (
			SELECT NNO FROM TB_HAWB WHERE MAWB_NO IN (
			SELECT MAWB_NO FROM TB_MAWB WHERE DEP_DATE BETWEEN #{sekFrom} AND #{sekTo}))
			AND ORG_STATION = #{orgStation}
			) m1
			ORDER BY transCode DESC, dstnNation ASC, wDate ASC;
	</select>
	
	<select id="selectDeleteOrderListCnt" parameterType="hashMap" resultType="Integer">
		SELECT COUNT(*) FROM DEL_ORDER_LIST
		WHERE ORG_STATION = #{orgStation}
		<if test="userId != null and userId != ''">
			AND USER_ID LIKE '%'+#{userId}+'%'
		</if>
		<if test="orderNo != null and orderNo != ''">
			AND ORDER_NO LIKE '%'+#{orderNo}+'%'
		</if>
	</select>
	
	<select id="selectDeleteOrderList" parameterType="hashMap" resultType="com.example.temp.member.vo.ShpngListVO">
		SELECT *
		FROM (
			SELECT
				ROW_NUMBER() OVER(ORDER BY D_DATE DESC) ROWNUM,
				DNO,
				NNO,
				ISNULL(USER_ID,'') AS USER_ID,
				ISNULL(ORDER_NO,'') AS ORDER_NO,
				ISNULL(CNEE_NAME,'') AS CNEE_NAME,
				ISNULL(ORDER_DATE,'') AS ORDER_DATE,
				ISNULL((SELECT USER_NAME FROM TB_CUSTOMER WHERE USER_ID = F1.USER_ID),'') AS COMPANY_NAME,
				CONVERT(NVARCHAR, D_DATE, 120) AS DEL_DATE,
				ISNULL(CNEE_TEL,'') AS CNEE_TEL,
				ISNULL(CNEE_ZIP,'') AS CNEE_ZIP,
				ISNULL(CNEE_ADDR,'') AS CNEE_ADDR,
				ISNULL(CNEE_ADDR_DETAIL,'') AS CNEE_ADDR_DETAIL,
				STUFF((SELECT ', ' + ITEM_DETAIL FROM DEL_ORDER_ITEM WHERE NNO = F1.NNO FOR XML PATH('')), 1, 1, '') AS ITEM_DETAIL,
				(SELECT COUNT(*) FROM DEL_ORDER_ITEM WHERE NNO = F1.NNO) AS ITEM_CNT,
				(SELECT SUM(ITEM_CNT*UNIT_VALUE) FROM DEL_ORDER_ITEM WHERE NNO = F1.NNO) AS ITEM_VALUE,
				CONVERT(NVARCHAR, R_DATE, 120) AS REC_DATE,
				CASE WHEN R_DATE IS NOT NULL THEN 'A' ELSE '' END AS RESULT_CODE
			FROM DEL_ORDER_LIST F1
			WHERE ORG_STATION = #{orgStation}
			<if test="userId != null and userId != ''">
				AND USER_ID LIKE '%'+#{userId}+'%'
			</if>
			<if test="orderNo != null and orderNo != ''">
				AND ORDER_NO LIKE '%'+#{orderNo}+'%'
			</if>
		) M1
		WHERE ROWNUM BETWEEN #{paging.boardStart} AND #{paging.boardEnd}
		ORDER BY ROWNUM 
	</select>
	
	<select id="selectYunExpressOrderInfo" parameterType="hashMap" resultType="com.example.temp.member.vo.UserOrderListVO">
		SELECT
			NNO,
			ISNULL(ORDER_NO,'') AS ORDER_NO,
			ISNULL(USER_ID,'') AS USER_ID,
			ISNULL(DSTN_NATION,'') AS DSTN_NATION,
			ISNULL(CNEE_NAME,'') AS CNEE_NAME,
			ISNULL(CNEE_ADDR,'') AS CNEE_ADDR,
			ISNULL(CNEE_CITY,'') AS CNEE_CITY,
			ISNULL(CNEE_STATE,'') AS CNEE_STATE,
			ISNULL(CNEE_ZIP,'') AS CNEE_ZIP,
			ISNULL(CNEE_TEL,'') AS CNEE_TEL,
			ISNULL(CNEE_HP,'') AS CNEE_HP,
			ISNULL(BOX_CNT,1) AS BOX_CNT,
			ISNULL(USER_WTA, 0) AS USER_WTA
		FROM TB_ORDER_LIST
		WHERE TRANS_CODE = #{transCode} AND SUBSTRING(NNO,1,8) = #{date}
	</select>
	
	<select id="selectYunExpressItemInfo" parameterType="hashMap" resultType="com.example.temp.member.vo.UserOrderItemVO">
		SELECT
			NNO,
			SUB_NO,
			ISNULL(ITEM_DETAIL,'') AS ITEM_DETAIL,
			ISNULL(NATIVE_ITEM_DETAIL,'') AS NATIVE_ITEM_DETAIL,
			ISNULL(HS_CODE,'') AS HS_CODE,
			ISNULL(UNIT_CURRENCY,'') AS UNIT_CURRENCY,
			ISNULL(CHG_CURRENCY,'') AS CHG_CURRENCY,
			ISNULL(ITEM_CNT,1) AS ITEM_CNT,
			ISNULL(UNIT_VALUE,0) AS UNIT_VALUE,
			ISNULL(USER_WTA,0) AS USER_WTA
		FROM TB_ORDER_ITEM
		WHERE USER_ID = #{userId} AND NNO = #{nno}
	</select>
	
	<select id="selectYunExpOrderList" parameterType="hashMap" resultType="com.example.temp.member.vo.ShpngListVO">
		SELECT NNO,
			ISNULL(USER_ID,'') USER_ID,
			ISNULL((SELECT COM_NAME FROM TB_CUSTOMER WHERE USER_ID = F1.USER_ID),'') COMPANY_NAME,
			ISNULL(ORDER_NO,'') ORDER_NO,
			ISNULL(HAWB_NO,'') HAWB_NO,
			ISNULL((SELECT NATION_NAME FROM TB_NATION_CODE WHERE NATION_CODE = F1.DSTN_NATION),'') DSTN_NATION,
			ISNULL(CNEE_NAME,'') CNEE_NAME,
			ISNULL(CNEE_ADDR,'') CNEE_ADDR,
			(SELECT COUNT(*) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO) ITEM_CNT
		FROM TB_ORDER_LIST F1
		WHERE ORG_STATION = #{orgStation}
			AND TRANS_CODE = #{transCode}
			AND NNO NOT IN (SELECT NNO FROM TB_DELIVERY_INFO WHERE TRANS_CODE = #{transCode})
			<if test="hawbNo != null and hawbNo != ''">
			AND HAWB_NO LIKE '%'+#{hawbNo}+'%'
			</if>
			<if test="orderNo != null and orderNo != ''">
			AND ORDER_NO LIKE '%'+#{orderNo}+'%'
			</if>			
			<if test="userId != null and userId != ''">
			AND USER_ID LIKE '%'+#{userId}+'%'
			</if>
		ORDER BY SUBSTRING(NNO,1,8) DESC, USER_ID
	</select>
	
	<select id="selectYunExpOrderInfo" parameterType="hashMap" resultType="com.example.temp.member.vo.UserOrderListVO">
		SELECT
			NNO,
			ISNULL(ORDER_NO,'') AS ORDER_NO,
			ISNULL(USER_ID,'') AS USER_ID,
			ISNULL((SELECT COM_NAME FROM TB_CUSTOMER WHERE USER_ID = F1.USER_ID),'') COMPANY_NAME,
			ISNULL(HAWB_NO,'') AS HAWB_NO,
			ISNULL(DSTN_NATION,'') AS DSTN_NATION,
			ISNULL(CNEE_NAME,'') AS CNEE_NAME,
			ISNULL(CNEE_ADDR,'') AS CNEE_ADDR,
			ISNULL(CNEE_CITY,'') AS CNEE_CITY,
			ISNULL(CNEE_STATE,'') AS CNEE_STATE,
			ISNULL(CNEE_ZIP,'') AS CNEE_ZIP,
			ISNULL(CNEE_TEL,'') AS CNEE_TEL,
			ISNULL(CNEE_HP,'') AS CNEE_HP,
			ISNULL(BOX_CNT,1) AS BOX_CNT,
			ROUND(ISNULL(USER_WTA, 0),2) AS USER_WTA,
			ISNULL((SELECT UNIT_CURRENCY FROM TB_ORDER_ITEM WHERE NNO = F1.NNO AND USER_ID = F1.USER_ID AND ORG_STATION = F1.ORG_STATION AND SUB_NO = 1),'USD') AS UNIT_CURRENCY
		FROM TB_ORDER_LIST F1
		WHERE NNO = #{nno}
	</select>
	
	<insert id="insertYunExpDeliveryInfo" parameterType="hashMap">
		INSERT INTO TB_DELIVERY_INFO (NNO, TRANS_CODE, HAWB_NO, MATCH_NO, TRK_NO, W_DATE) VALUES
			(#{nno}, #{transCode}, #{hawbNo}, #{matchNo}, #{matchNo}, GETDATE());
	</insert>
	
	<select id="selectUserIdByNno" parameterType="String" resultType="hashMap">
		SELECT ISNULL(USER_ID,'') as userId, ISNULL(W_USER_IP,'') as userIp FROM TB_ORDER_LIST WHERE NNO = #{nno}
	</select>
	
	<select id="selectOrgStationByUserId" parameterType="String" resultType="String">
		SELECT NATION_NAME FROM TB_NATION_CODE WHERE NATION_CODE = (SELECT ORG_NATION FROM TB_USER_TRANS_COM WHERE USER_ID = #{userId});
	</select>
	
	<select id="selectCheckMawbNo" parameterType="String" resultType="hashMap">
		SELECT
			CASE WHEN M1.MAWB_CNT = 0 THEN ''
			ELSE (SELECT TRANS_CODE FROM TB_MAWB WHERE MAWB_NO = #{mawbNo})
		END transCode
		FROM (
			SELECT COUNT(*) MAWB_CNT FROM TB_MAWB WHERE MAWB_NO = #{mawbNo}
		) M1
	</select>
	
	<update id="updateMawbNo" parameterType="com.example.temp.manager.vo.HawbVO">
		UPDATE TB_HAWB
		SET MAWB_NO = #{mawbNo}, BAG_NO = #{bagNo}
		WHERE HAWB_NO = #{hawbNo} AND NNO = #{nno} AND TRANS_CODE = #{transCode}
	</update>
	
	<insert id="insertHisMawbApply" parameterType="com.example.temp.manager.vo.HawbVO">
		INSERT INTO HIS_MAWB_APPLY(MAWB_NO,HAWB_NO,ACT_WORK,W_USER_ID,W_USER_IP,W_DATE)
		VALUES (#{mawbNo}, #{hawbNo}, 'INSERT', #{wUserId}, #{wUserIp}, GETDATE());
	</insert>
	
	<update id="updateBagNo" parameterType="hashMap">
		UPDATE TB_HAWB SET BAG_NO = #{bagNo}
		WHERE ORG_STATION = #{orgStation} AND HAWB_NO = #{hawbNo}
	</update>
	
	<select id="selectSendEmailreturnSeller" resultType="com.example.temp.manager.vo.ManagerVO">
		SELECT USER_ID, COUNT(*) CNT, (SELECT USER_EMAIL FROM TB_CUSTOMER WHERE USER_ID = F1.USER_ID) EMAIL
		FROM VI_RETURN_SEND_EMAIL F1
		GROUP BY USER_ID
	</select>
	
	<insert id="insertHisSendEmail" parameterType="com.example.temp.manager.vo.ManagerVO">
		INSERT INTO HIS_SEND_EMAIL (NNO, SELLER_ID)
		SELECT NNO, USER_ID FROM VI_RETURN_SEND_EMAIL WHERE USER_ID = #{userId}
	</insert>
	
	<select id="selectBizInfoList" resultType="com.example.temp.api.aci.vo.BizInfo" parameterType="hashMap">
		select *
		from (
			select
				row_number() over(order by w_date desc) as rownum,
				user_id,
				isnull(reg_name,'') as reg_name,
				isnull(reg_rprsn,'') as reg_rprsn,
				isnull(reg_addr,'') as reg_addr,
				isnull(reg_zip,'') as reg_zip,
				isnull(reg_no,'') as reg_no,
				isnull(biz_customs_no,'') as biz_customs_no
			from tb_biz_info
			where 1=1 
				<if test="userId != null and userId != ''">
				and user_id = #{userId}
				</if>
				<if test="comName != null and comName != ''">
				and reg_name like concat('%',#{comName},'%')
				</if>
		) m1
		where rownum between #{paging.boardStart} and #{paging.boardEnd}
	</select>
	
	<select id="selectBizInfoListCnt" resultType="Integer" parameterType="hashMap">
		select count(*) from tb_biz_info
		where 1=1 
			<if test="userId != null and userId != ''">
			and user_id = #{userId}
			</if>
			<if test="comName != null and comName != ''">
			and reg_name like concat('%',#{comName},'%')
			</if>
	</select>
	
	<select id="selectBizInfoOne" parameterType="hashMap" resultType="com.example.temp.api.aci.vo.BizInfo">
		select user_id, isnull(reg_name,'') as reg_name, isnull(reg_rprsn,'') as reg_rprsn, isnull(reg_addr,'') as reg_addr, isnull(reg_zip,'') as reg_zip,
			isnull(reg_no,'') as reg_no, isnull(biz_customs_no,'') as biz_customs_no
		from tb_biz_info
		where user_id = #{userId}
	</select>
	
	<select id="selectUserInfoList" resultType="hashMap" parameterType="hashMap">
		select m1.user_id as userId, isnull(f2.com_name,'') as comName
		from (
		select USER_ID from TB_USER_TRANS_COM WHERE ORG_NATION = #{orgNation} GROUP BY USER_ID
		) m1, tb_customer f2
		where m1.user_id = f2.user_id;
	</select>
	
	<insert id="insertBizInfo" parameterType="com.example.temp.api.aci.vo.BizInfo">
		INSERT INTO TB_BIZ_INFO (USER_ID, REG_NAME, REG_RPRSN, REG_ADDR, REG_ZIP, REG_NO, BIZ_CUSTOMS_NO, W_USER_ID, W_USER_IP) VALUES 
		(#{userId}, #{regName}, #{regRprsn}, #{regAddr}, #{regZip}, #{regNo}, #{bizCustomsNo}, #{wUserId}, #{wUserIp})
	</insert>
	
	<update id="updateBizInfo" parameterType="com.example.temp.api.aci.vo.BizInfo">
		UPDATE TB_BIZ_INFO
		SET REG_NAME = #{regName}, REG_RPRSN = #{regRprsn}, REG_ADDR = #{regAddr}, REG_ZIP = #{regZip}, REG_NO = #{regNo}, BIZ_CUSTOMS_NO = #{bizCustomsNo}
		WHERE USER_ID = #{userId}
	</update>
	
	<select id="expLicenceChkV2" parameterType="com.example.temp.manager.vo.HawbVO" resultType="Integer">
		SELECT COUNT(*)
		FROM TB_EXP_DCL 
		WHERE NNO = ISNULL((SELECT NNO FROM TB_ORDER_LIST WHERE HAWB_NO = #{hawbNo}),
							(SELECT NNO FROM TB_ORDER_LIST WHERE HAWB_NO = (SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO = #{hawbNo})))
			AND ISNULL(EXP_NO,'') = '';
	</select>
	
	<select id="selectExportOrderInfo" parameterType="com.example.temp.manager.vo.HawbVO" resultType="com.example.temp.member.vo.UserOrderListVO">
		SELECT NNO, USER_ID, ISNULL((SELECT EXP_TYPE FROM TB_EXP_DCL WHERE NNO = F1.NNO AND USER_ID = F1.USER_ID AND ISNULL(EXP_NO,'') = ''),'N') EXP_TYPE
		FROM TB_ORDER_LIST F1
		WHERE HAWB_NO = ISNULL((SELECT KEY_HAWB_NO FROM TB_MATCHING_INFO WHERE VALUE_MATCH_NO = #{hawbNo}),#{hawbNo});
	</select>
	
	<select id="selectExportInfo" resultType="hashMap" parameterType="String">
		SELECT ISNULL(EXP_COR,'') AS expCor, ISNULL(AGT_COR,'') AS agtCor
		FROM TB_EXP_DCL WHERE NNO = #{nno}
	</select>

	<select id="selectExcelLicenceEFSV2" parameterType="String" resultType="com.example.temp.manager.vo.ExpLicenceExcelVO">
		SELECT
			ISNULL((SELECT VALUE_MATCH_NO FROM TB_MATCHING_INFO WHERE KEY_HAWB_NO = F1.HAWB_NO),F1.HAWB_NO) AS HAWB,
			ISNULL(
				(SELECT CHG_CURRENCY FROM TB_ORDER_ITEM F2 WHERE F2.NNO = F1.NNO AND SUB_NO = '1'),
				(SELECT UNIT_CURRENCY FROM TB_ORDER_ITEM F2 WHERE F2.NNO = F1.NNO AND SUB_NO = '1')
			) AS CURRENCY,
			'1' AS BOX_CNT,
			USER_WTA AS WTA,
			DSTN_NATION,
			(select SUM(ITEM_CNT*UNIT_VALUE) FROM TB_ORDER_ITEM WHERE NNO = F1.NNO) AS TOTAL_VALUE, 
			(SELECT ITEM_DETAIL FROM TB_ORDER_ITEM WHERE NNO = F1.NNO and SUB_NO = '1') AS ITEM_DETAIL,
			SHIPPER_NAME,
			SHIPPER_ADDR,
			SHIPPER_ADDR_DETAIL,
			CNEE_NAME,
			CNEE_ADDR,
			CNEE_ADDR_DETAIL,
			ISNULL(PAYMENT,'') AS PAYMENT
		FROM TB_ORDER_LIST F1 WHERE F1.NNO = #{nno};
	</select>
	
	<update id="updateLicenceInfoV2" parameterType="hashMap">
		UPDATE TB_EXP_DCL SET EXP_NO = #{expNo}, W_DATE = GETDATE() WHERE NNO = #{nno}
	</update>
	
	<select id="selectMawbInfo" parameterType="hashMap" resultType="hashMap">
		select mawb_no as mawbNo, 
			isnull(dep_date,'') as etd, 
			isnull(arr_date,'') as eta, 
			isnull(org_station,'') as orgStation,
			isnull(dstn_station,'') as dstnStation
		from tb_mawb where mawb_no = #{mawbNo}
	</select>
	
	
	<select id="selectFastboxData" resultType="hashMap">
		select
			nno, 
			trans_code, 
			isnull((select key_hawb_no from tb_matching_info where nno = f1.nno),(select hawb_no from tb_order_list where nno = f1.nno)) as hawb_no,
			isnull((select value_match_no from tb_matching_info where nno = f1.nno),(select hawb_no from tb_order_list where nno = f1.nno)) as match_no
		from vi_delivery_info f1 
		where trans_code in ('FB', 'FB-EMS') 
			and convert(date, substring(nno,1,8), 112) >= dateadd(month, -5, getdate())	
		order by nno asc;
	</select>
	
	<select id="selectTaxTypeList" resultType="hashMap">
		SELECT CODE AS code, NAME AS name FROM TB_CODE WHERE CODE_DIV = 'TAX_TYPE' ORDER BY CONVERT(INT, CODE);
	</select>
	
</mapper>
<!-- SELECT 
	LEFT(STUFF((SELECT ','+ITEM_DETAIL FROM TB_ORDER_ITEM WHERE NNO = F1.NNO FOR XML PATH('')), 1, 1, ''),200) AS ITEM_DETAIL,
	(SELECT SUM(ITEM_CNT) FROM TB_HAWB_ITEM WHERE NNO = F1.NNO) AS ITEM_CNT,
	ISNULL((SELECT TOP 1 QTY_UNIT FROM TB_ORDER_ITEM WHERE NNO = F1.NNO),'EA') AS QTY_UNIT,
	WTA,
	WTC,
	format(W_DATE,'yyyymmdd') AS IN_DATE,
	(SELECT DEP_DATE FROM TB_MAWB WHERE MAWB_NO = #{mawbNo}) AS END_DATE
FROM TB_HAWB F1 -->